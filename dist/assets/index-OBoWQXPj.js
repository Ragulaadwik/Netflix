function eP(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var NM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $l(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var tP={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uh=Symbol.for("react.element"),xM=Symbol.for("react.portal"),DM=Symbol.for("react.fragment"),OM=Symbol.for("react.strict_mode"),LM=Symbol.for("react.profiler"),MM=Symbol.for("react.provider"),VM=Symbol.for("react.context"),FM=Symbol.for("react.forward_ref"),UM=Symbol.for("react.suspense"),BM=Symbol.for("react.memo"),$M=Symbol.for("react.lazy"),E0=Symbol.iterator;function zM(t){return t===null||typeof t!="object"?null:(t=E0&&t[E0]||t["@@iterator"],typeof t=="function"?t:null)}var nP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rP=Object.assign,iP={};function zl(t,e,n){this.props=t,this.context=e,this.refs=iP,this.updater=n||nP}zl.prototype.isReactComponent={};zl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};zl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function sP(){}sP.prototype=zl.prototype;function kw(t,e,n){this.props=t,this.context=e,this.refs=iP,this.updater=n||nP}var Nw=kw.prototype=new sP;Nw.constructor=kw;rP(Nw,zl.prototype);Nw.isPureReactComponent=!0;var I0=Array.isArray,oP=Object.prototype.hasOwnProperty,xw={current:null},aP={key:!0,ref:!0,__self:!0,__source:!0};function lP(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)oP.call(e,r)&&!aP.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Uh,type:t,key:s,ref:o,props:i,_owner:xw.current}}function jM(t,e){return{$$typeof:Uh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Dw(t){return typeof t=="object"&&t!==null&&t.$$typeof===Uh}function qM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var T0=/\/+/g;function Wg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qM(""+t.key):e.toString(36)}function df(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Uh:case xM:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Wg(o,0):r,I0(i)?(n="",t!=null&&(n=t.replace(T0,"$&/")+"/"),df(i,e,n,"",function(u){return u})):i!=null&&(Dw(i)&&(i=jM(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(T0,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",I0(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Wg(s,a);o+=df(s,e,n,l,i)}else if(l=zM(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Wg(s,a++),o+=df(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Od(t,e,n){if(t==null)return t;var r=[],i=0;return df(t,r,"","",function(s){return e.call(n,s,i++)}),r}function WM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var En={current:null},ff={transition:null},HM={ReactCurrentDispatcher:En,ReactCurrentBatchConfig:ff,ReactCurrentOwner:xw};ge.Children={map:Od,forEach:function(t,e,n){Od(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Od(t,function(){e++}),e},toArray:function(t){return Od(t,function(e){return e})||[]},only:function(t){if(!Dw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ge.Component=zl;ge.Fragment=DM;ge.Profiler=LM;ge.PureComponent=kw;ge.StrictMode=OM;ge.Suspense=UM;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HM;ge.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=rP({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=xw.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)oP.call(e,l)&&!aP.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Uh,type:t.type,key:i,ref:s,props:r,_owner:o}};ge.createContext=function(t){return t={$$typeof:VM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:MM,_context:t},t.Consumer=t};ge.createElement=lP;ge.createFactory=function(t){var e=lP.bind(null,t);return e.type=t,e};ge.createRef=function(){return{current:null}};ge.forwardRef=function(t){return{$$typeof:FM,render:t}};ge.isValidElement=Dw;ge.lazy=function(t){return{$$typeof:$M,_payload:{_status:-1,_result:t},_init:WM}};ge.memo=function(t,e){return{$$typeof:BM,type:t,compare:e===void 0?null:e}};ge.startTransition=function(t){var e=ff.transition;ff.transition={};try{t()}finally{ff.transition=e}};ge.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ge.useCallback=function(t,e){return En.current.useCallback(t,e)};ge.useContext=function(t){return En.current.useContext(t)};ge.useDebugValue=function(){};ge.useDeferredValue=function(t){return En.current.useDeferredValue(t)};ge.useEffect=function(t,e){return En.current.useEffect(t,e)};ge.useId=function(){return En.current.useId()};ge.useImperativeHandle=function(t,e,n){return En.current.useImperativeHandle(t,e,n)};ge.useInsertionEffect=function(t,e){return En.current.useInsertionEffect(t,e)};ge.useLayoutEffect=function(t,e){return En.current.useLayoutEffect(t,e)};ge.useMemo=function(t,e){return En.current.useMemo(t,e)};ge.useReducer=function(t,e,n){return En.current.useReducer(t,e,n)};ge.useRef=function(t){return En.current.useRef(t)};ge.useState=function(t){return En.current.useState(t)};ge.useSyncExternalStore=function(t,e,n){return En.current.useSyncExternalStore(t,e,n)};ge.useTransition=function(){return En.current.useTransition()};ge.version="18.2.0";tP.exports=ge;var M=tP.exports;const j=$l(M),GM=eP({__proto__:null,default:j},[M]);var ny={},uP={exports:{}},Jn={},cP={exports:{}},hP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,Z){var te=z.length;z.push(Z);e:for(;0<te;){var Se=te-1>>>1,Ue=z[Se];if(0<i(Ue,Z))z[Se]=Z,z[te]=Ue,te=Se;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var Z=z[0],te=z.pop();if(te!==Z){z[0]=te;e:for(var Se=0,Ue=z.length,Or=Ue>>>1;Se<Or;){var $t=2*(Se+1)-1,_r=z[$t],cn=$t+1,$i=z[cn];if(0>i(_r,te))cn<Ue&&0>i($i,_r)?(z[Se]=$i,z[cn]=te,Se=cn):(z[Se]=_r,z[$t]=te,Se=$t);else if(cn<Ue&&0>i($i,te))z[Se]=$i,z[cn]=te,Se=cn;else break e}}return Z}function i(z,Z){var te=z.sortIndex-Z.sortIndex;return te!==0?te:z.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,f=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(z){for(var Z=n(u);Z!==null;){if(Z.callback===null)r(u);else if(Z.startTime<=z)r(u),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=n(u)}}function T(z){if(m=!1,y(z),!p)if(n(l)!==null)p=!0,gr(b);else{var Z=n(u);Z!==null&&Oe(T,Z.startTime-z)}}function b(z,Z){p=!1,m&&(m=!1,g(x),x=-1),f=!0;var te=d;try{for(y(Z),h=n(l);h!==null&&(!(h.expirationTime>Z)||z&&!oe());){var Se=h.callback;if(typeof Se=="function"){h.callback=null,d=h.priorityLevel;var Ue=Se(h.expirationTime<=Z);Z=t.unstable_now(),typeof Ue=="function"?h.callback=Ue:h===n(l)&&r(l),y(Z)}else r(l);h=n(l)}if(h!==null)var Or=!0;else{var $t=n(u);$t!==null&&Oe(T,$t.startTime-Z),Or=!1}return Or}finally{h=null,d=te,f=!1}}var w=!1,A=null,x=-1,$=5,G=-1;function oe(){return!(t.unstable_now()-G<$)}function Re(){if(A!==null){var z=t.unstable_now();G=z;var Z=!0;try{Z=A(!0,z)}finally{Z?ke():(w=!1,A=null)}}else w=!1}var ke;if(typeof _=="function")ke=function(){_(Re)};else if(typeof MessageChannel<"u"){var Tn=new MessageChannel,li=Tn.port2;Tn.port1.onmessage=Re,ke=function(){li.postMessage(null)}}else ke=function(){v(Re,0)};function gr(z){A=z,w||(w=!0,ke())}function Oe(z,Z){x=v(function(){z(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,gr(b))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(d){case 1:case 2:case 3:var Z=3;break;default:Z=d}var te=d;d=Z;try{return z()}finally{d=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,Z){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var te=d;d=z;try{return Z()}finally{d=te}},t.unstable_scheduleCallback=function(z,Z,te){var Se=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?Se+te:Se):te=Se,z){case 1:var Ue=-1;break;case 2:Ue=250;break;case 5:Ue=1073741823;break;case 4:Ue=1e4;break;default:Ue=5e3}return Ue=te+Ue,z={id:c++,callback:Z,priorityLevel:z,startTime:te,expirationTime:Ue,sortIndex:-1},te>Se?(z.sortIndex=te,e(u,z),n(l)===null&&z===n(u)&&(m?(g(x),x=-1):m=!0,Oe(T,te-Se))):(z.sortIndex=Ue,e(l,z),p||f||(p=!0,gr(b))),z},t.unstable_shouldYield=oe,t.unstable_wrapCallback=function(z){var Z=d;return function(){var te=d;d=Z;try{return z.apply(this,arguments)}finally{d=te}}}})(hP);cP.exports=hP;var KM=cP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dP=M,Hn=KM;function D(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fP=new Set,Ac={};function oa(t,e){fl(t,e),fl(t+"Capture",e)}function fl(t,e){for(Ac[t]=e,t=0;t<e.length;t++)fP.add(e[t])}var Si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ry=Object.prototype.hasOwnProperty,QM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S0={},R0={};function YM(t){return ry.call(R0,t)?!0:ry.call(S0,t)?!1:QM.test(t)?R0[t]=!0:(S0[t]=!0,!1)}function JM(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function XM(t,e,n,r){if(e===null||typeof e>"u"||JM(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function In(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xt[t]=new In(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xt[e]=new In(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xt[t]=new In(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xt[t]=new In(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xt[t]=new In(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xt[t]=new In(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xt[t]=new In(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xt[t]=new In(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xt[t]=new In(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ow=/[\-:]([a-z])/g;function Lw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ow,Lw);Xt[e]=new In(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ow,Lw);Xt[e]=new In(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ow,Lw);Xt[e]=new In(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xt[t]=new In(t,1,!1,t.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xt[t]=new In(t,1,!1,t.toLowerCase(),null,!0,!0)});function Mw(t,e,n,r){var i=Xt.hasOwnProperty(e)?Xt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(XM(e,n,i,r)&&(n=null),r||i===null?YM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Di=dP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ld=Symbol.for("react.element"),Ma=Symbol.for("react.portal"),Va=Symbol.for("react.fragment"),Vw=Symbol.for("react.strict_mode"),iy=Symbol.for("react.profiler"),pP=Symbol.for("react.provider"),mP=Symbol.for("react.context"),Fw=Symbol.for("react.forward_ref"),sy=Symbol.for("react.suspense"),oy=Symbol.for("react.suspense_list"),Uw=Symbol.for("react.memo"),es=Symbol.for("react.lazy"),gP=Symbol.for("react.offscreen"),A0=Symbol.iterator;function _u(t){return t===null||typeof t!="object"?null:(t=A0&&t[A0]||t["@@iterator"],typeof t=="function"?t:null)}var et=Object.assign,Hg;function Wu(t){if(Hg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Hg=e&&e[1]||""}return`
`+Hg+t}var Gg=!1;function Kg(t,e){if(!t||Gg)return"";Gg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Gg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Wu(t):""}function ZM(t){switch(t.tag){case 5:return Wu(t.type);case 16:return Wu("Lazy");case 13:return Wu("Suspense");case 19:return Wu("SuspenseList");case 0:case 2:case 15:return t=Kg(t.type,!1),t;case 11:return t=Kg(t.type.render,!1),t;case 1:return t=Kg(t.type,!0),t;default:return""}}function ay(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Va:return"Fragment";case Ma:return"Portal";case iy:return"Profiler";case Vw:return"StrictMode";case sy:return"Suspense";case oy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mP:return(t.displayName||"Context")+".Consumer";case pP:return(t._context.displayName||"Context")+".Provider";case Fw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Uw:return e=t.displayName||null,e!==null?e:ay(t.type)||"Memo";case es:e=t._payload,t=t._init;try{return ay(t(e))}catch{}}return null}function eV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ay(e);case 8:return e===Vw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Cs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _P(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function tV(t){var e=_P(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Md(t){t._valueTracker||(t._valueTracker=tV(t))}function yP(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_P(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Bf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ly(t,e){var n=e.checked;return et({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function C0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Cs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vP(t,e){e=e.checked,e!=null&&Mw(t,"checked",e,!1)}function uy(t,e){vP(t,e);var n=Cs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?cy(t,e.type,n):e.hasOwnProperty("defaultValue")&&cy(t,e.type,Cs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function P0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function cy(t,e,n){(e!=="number"||Bf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Hu=Array.isArray;function Xa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Cs(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function hy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(D(91));return et({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function b0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(D(92));if(Hu(n)){if(1<n.length)throw Error(D(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Cs(n)}}function wP(t,e){var n=Cs(e.value),r=Cs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function k0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function EP(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?EP(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Vd,IP=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Vd=Vd||document.createElement("div"),Vd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Vd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Cc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var nc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nV=["Webkit","ms","Moz","O"];Object.keys(nc).forEach(function(t){nV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nc[e]=nc[t]})});function TP(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||nc.hasOwnProperty(t)&&nc[t]?(""+e).trim():e+"px"}function SP(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=TP(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var rV=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fy(t,e){if(e){if(rV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(D(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(D(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(D(61))}if(e.style!=null&&typeof e.style!="object")throw Error(D(62))}}function py(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var my=null;function Bw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gy=null,Za=null,el=null;function N0(t){if(t=zh(t)){if(typeof gy!="function")throw Error(D(280));var e=t.stateNode;e&&(e=sm(e),gy(t.stateNode,t.type,e))}}function RP(t){Za?el?el.push(t):el=[t]:Za=t}function AP(){if(Za){var t=Za,e=el;if(el=Za=null,N0(t),e)for(t=0;t<e.length;t++)N0(e[t])}}function CP(t,e){return t(e)}function PP(){}var Qg=!1;function bP(t,e,n){if(Qg)return t(e,n);Qg=!0;try{return CP(t,e,n)}finally{Qg=!1,(Za!==null||el!==null)&&(PP(),AP())}}function Pc(t,e){var n=t.stateNode;if(n===null)return null;var r=sm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(D(231,e,typeof n));return n}var _y=!1;if(Si)try{var yu={};Object.defineProperty(yu,"passive",{get:function(){_y=!0}}),window.addEventListener("test",yu,yu),window.removeEventListener("test",yu,yu)}catch{_y=!1}function iV(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var rc=!1,$f=null,zf=!1,yy=null,sV={onError:function(t){rc=!0,$f=t}};function oV(t,e,n,r,i,s,o,a,l){rc=!1,$f=null,iV.apply(sV,arguments)}function aV(t,e,n,r,i,s,o,a,l){if(oV.apply(this,arguments),rc){if(rc){var u=$f;rc=!1,$f=null}else throw Error(D(198));zf||(zf=!0,yy=u)}}function aa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function kP(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function x0(t){if(aa(t)!==t)throw Error(D(188))}function lV(t){var e=t.alternate;if(!e){if(e=aa(t),e===null)throw Error(D(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return x0(i),t;if(s===r)return x0(i),e;s=s.sibling}throw Error(D(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(D(189))}}if(n.alternate!==r)throw Error(D(190))}if(n.tag!==3)throw Error(D(188));return n.stateNode.current===n?t:e}function NP(t){return t=lV(t),t!==null?xP(t):null}function xP(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=xP(t);if(e!==null)return e;t=t.sibling}return null}var DP=Hn.unstable_scheduleCallback,D0=Hn.unstable_cancelCallback,uV=Hn.unstable_shouldYield,cV=Hn.unstable_requestPaint,ft=Hn.unstable_now,hV=Hn.unstable_getCurrentPriorityLevel,$w=Hn.unstable_ImmediatePriority,OP=Hn.unstable_UserBlockingPriority,jf=Hn.unstable_NormalPriority,dV=Hn.unstable_LowPriority,LP=Hn.unstable_IdlePriority,tm=null,Jr=null;function fV(t){if(Jr&&typeof Jr.onCommitFiberRoot=="function")try{Jr.onCommitFiberRoot(tm,t,void 0,(t.current.flags&128)===128)}catch{}}var Ar=Math.clz32?Math.clz32:gV,pV=Math.log,mV=Math.LN2;function gV(t){return t>>>=0,t===0?32:31-(pV(t)/mV|0)|0}var Fd=64,Ud=4194304;function Gu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function qf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Gu(a):(s&=o,s!==0&&(r=Gu(s)))}else o=n&~i,o!==0?r=Gu(o):s!==0&&(r=Gu(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ar(e),i=1<<n,r|=t[n],e&=~i;return r}function _V(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yV(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ar(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=_V(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function vy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function MP(){var t=Fd;return Fd<<=1,!(Fd&4194240)&&(Fd=64),t}function Yg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ar(e),t[e]=n}function vV(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ar(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function zw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ar(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Pe=0;function VP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var FP,jw,UP,BP,$P,wy=!1,Bd=[],ds=null,fs=null,ps=null,bc=new Map,kc=new Map,ns=[],wV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function O0(t,e){switch(t){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":ps=null;break;case"pointerover":case"pointerout":bc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":kc.delete(e.pointerId)}}function vu(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=zh(e),e!==null&&jw(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function EV(t,e,n,r,i){switch(e){case"focusin":return ds=vu(ds,t,e,n,r,i),!0;case"dragenter":return fs=vu(fs,t,e,n,r,i),!0;case"mouseover":return ps=vu(ps,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return bc.set(s,vu(bc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,kc.set(s,vu(kc.get(s)||null,t,e,n,r,i)),!0}return!1}function zP(t){var e=yo(t.target);if(e!==null){var n=aa(e);if(n!==null){if(e=n.tag,e===13){if(e=kP(n),e!==null){t.blockedOn=e,$P(t.priority,function(){UP(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ey(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);my=r,n.target.dispatchEvent(r),my=null}else return e=zh(n),e!==null&&jw(e),t.blockedOn=n,!1;e.shift()}return!0}function L0(t,e,n){pf(t)&&n.delete(e)}function IV(){wy=!1,ds!==null&&pf(ds)&&(ds=null),fs!==null&&pf(fs)&&(fs=null),ps!==null&&pf(ps)&&(ps=null),bc.forEach(L0),kc.forEach(L0)}function wu(t,e){t.blockedOn===e&&(t.blockedOn=null,wy||(wy=!0,Hn.unstable_scheduleCallback(Hn.unstable_NormalPriority,IV)))}function Nc(t){function e(i){return wu(i,t)}if(0<Bd.length){wu(Bd[0],t);for(var n=1;n<Bd.length;n++){var r=Bd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ds!==null&&wu(ds,t),fs!==null&&wu(fs,t),ps!==null&&wu(ps,t),bc.forEach(e),kc.forEach(e),n=0;n<ns.length;n++)r=ns[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ns.length&&(n=ns[0],n.blockedOn===null);)zP(n),n.blockedOn===null&&ns.shift()}var tl=Di.ReactCurrentBatchConfig,Wf=!0;function TV(t,e,n,r){var i=Pe,s=tl.transition;tl.transition=null;try{Pe=1,qw(t,e,n,r)}finally{Pe=i,tl.transition=s}}function SV(t,e,n,r){var i=Pe,s=tl.transition;tl.transition=null;try{Pe=4,qw(t,e,n,r)}finally{Pe=i,tl.transition=s}}function qw(t,e,n,r){if(Wf){var i=Ey(t,e,n,r);if(i===null)o_(t,e,r,Hf,n),O0(t,r);else if(EV(i,t,e,n,r))r.stopPropagation();else if(O0(t,r),e&4&&-1<wV.indexOf(t)){for(;i!==null;){var s=zh(i);if(s!==null&&FP(s),s=Ey(t,e,n,r),s===null&&o_(t,e,r,Hf,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else o_(t,e,r,null,n)}}var Hf=null;function Ey(t,e,n,r){if(Hf=null,t=Bw(r),t=yo(t),t!==null)if(e=aa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=kP(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Hf=t,null}function jP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hV()){case $w:return 1;case OP:return 4;case jf:case dV:return 16;case LP:return 536870912;default:return 16}default:return 16}}var os=null,Ww=null,mf=null;function qP(){if(mf)return mf;var t,e=Ww,n=e.length,r,i="value"in os?os.value:os.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return mf=i.slice(t,1<r?1-r:void 0)}function gf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $d(){return!0}function M0(){return!1}function Xn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?$d:M0,this.isPropagationStopped=M0,this}return et(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$d)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$d)},persist:function(){},isPersistent:$d}),e}var jl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hw=Xn(jl),$h=et({},jl,{view:0,detail:0}),RV=Xn($h),Jg,Xg,Eu,nm=et({},$h,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Eu&&(Eu&&t.type==="mousemove"?(Jg=t.screenX-Eu.screenX,Xg=t.screenY-Eu.screenY):Xg=Jg=0,Eu=t),Jg)},movementY:function(t){return"movementY"in t?t.movementY:Xg}}),V0=Xn(nm),AV=et({},nm,{dataTransfer:0}),CV=Xn(AV),PV=et({},$h,{relatedTarget:0}),Zg=Xn(PV),bV=et({},jl,{animationName:0,elapsedTime:0,pseudoElement:0}),kV=Xn(bV),NV=et({},jl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xV=Xn(NV),DV=et({},jl,{data:0}),F0=Xn(DV),OV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},LV={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VV(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=MV[t])?!!e[t]:!1}function Gw(){return VV}var FV=et({},$h,{key:function(t){if(t.key){var e=OV[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=gf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?LV[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gw,charCode:function(t){return t.type==="keypress"?gf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?gf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),UV=Xn(FV),BV=et({},nm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),U0=Xn(BV),$V=et({},$h,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gw}),zV=Xn($V),jV=et({},jl,{propertyName:0,elapsedTime:0,pseudoElement:0}),qV=Xn(jV),WV=et({},nm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),HV=Xn(WV),GV=[9,13,27,32],Kw=Si&&"CompositionEvent"in window,ic=null;Si&&"documentMode"in document&&(ic=document.documentMode);var KV=Si&&"TextEvent"in window&&!ic,WP=Si&&(!Kw||ic&&8<ic&&11>=ic),B0=" ",$0=!1;function HP(t,e){switch(t){case"keyup":return GV.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fa=!1;function QV(t,e){switch(t){case"compositionend":return GP(e);case"keypress":return e.which!==32?null:($0=!0,B0);case"textInput":return t=e.data,t===B0&&$0?null:t;default:return null}}function YV(t,e){if(Fa)return t==="compositionend"||!Kw&&HP(t,e)?(t=qP(),mf=Ww=os=null,Fa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WP&&e.locale!=="ko"?null:e.data;default:return null}}var JV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function z0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!JV[t.type]:e==="textarea"}function KP(t,e,n,r){RP(r),e=Gf(e,"onChange"),0<e.length&&(n=new Hw("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var sc=null,xc=null;function XV(t){sb(t,0)}function rm(t){var e=$a(t);if(yP(e))return t}function ZV(t,e){if(t==="change")return e}var QP=!1;if(Si){var e_;if(Si){var t_="oninput"in document;if(!t_){var j0=document.createElement("div");j0.setAttribute("oninput","return;"),t_=typeof j0.oninput=="function"}e_=t_}else e_=!1;QP=e_&&(!document.documentMode||9<document.documentMode)}function q0(){sc&&(sc.detachEvent("onpropertychange",YP),xc=sc=null)}function YP(t){if(t.propertyName==="value"&&rm(xc)){var e=[];KP(e,xc,t,Bw(t)),bP(XV,e)}}function eF(t,e,n){t==="focusin"?(q0(),sc=e,xc=n,sc.attachEvent("onpropertychange",YP)):t==="focusout"&&q0()}function tF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return rm(xc)}function nF(t,e){if(t==="click")return rm(e)}function rF(t,e){if(t==="input"||t==="change")return rm(e)}function iF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var br=typeof Object.is=="function"?Object.is:iF;function Dc(t,e){if(br(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ry.call(e,i)||!br(t[i],e[i]))return!1}return!0}function W0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function H0(t,e){var n=W0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=W0(n)}}function JP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?JP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function XP(){for(var t=window,e=Bf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Bf(t.document)}return e}function Qw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sF(t){var e=XP(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&JP(n.ownerDocument.documentElement,n)){if(r!==null&&Qw(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=H0(n,s);var o=H0(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oF=Si&&"documentMode"in document&&11>=document.documentMode,Ua=null,Iy=null,oc=null,Ty=!1;function G0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ty||Ua==null||Ua!==Bf(r)||(r=Ua,"selectionStart"in r&&Qw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),oc&&Dc(oc,r)||(oc=r,r=Gf(Iy,"onSelect"),0<r.length&&(e=new Hw("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ua)))}function zd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ba={animationend:zd("Animation","AnimationEnd"),animationiteration:zd("Animation","AnimationIteration"),animationstart:zd("Animation","AnimationStart"),transitionend:zd("Transition","TransitionEnd")},n_={},ZP={};Si&&(ZP=document.createElement("div").style,"AnimationEvent"in window||(delete Ba.animationend.animation,delete Ba.animationiteration.animation,delete Ba.animationstart.animation),"TransitionEvent"in window||delete Ba.transitionend.transition);function im(t){if(n_[t])return n_[t];if(!Ba[t])return t;var e=Ba[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ZP)return n_[t]=e[n];return t}var eb=im("animationend"),tb=im("animationiteration"),nb=im("animationstart"),rb=im("transitionend"),ib=new Map,K0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ws(t,e){ib.set(t,e),oa(e,[t])}for(var r_=0;r_<K0.length;r_++){var i_=K0[r_],aF=i_.toLowerCase(),lF=i_[0].toUpperCase()+i_.slice(1);Ws(aF,"on"+lF)}Ws(eb,"onAnimationEnd");Ws(tb,"onAnimationIteration");Ws(nb,"onAnimationStart");Ws("dblclick","onDoubleClick");Ws("focusin","onFocus");Ws("focusout","onBlur");Ws(rb,"onTransitionEnd");fl("onMouseEnter",["mouseout","mouseover"]);fl("onMouseLeave",["mouseout","mouseover"]);fl("onPointerEnter",["pointerout","pointerover"]);fl("onPointerLeave",["pointerout","pointerover"]);oa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oa("onBeforeInput",["compositionend","keypress","textInput","paste"]);oa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ku));function Q0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,aV(r,e,void 0,t),t.currentTarget=null}function sb(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Q0(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Q0(i,a,u),s=l}}}if(zf)throw t=yy,zf=!1,yy=null,t}function Be(t,e){var n=e[Py];n===void 0&&(n=e[Py]=new Set);var r=t+"__bubble";n.has(r)||(ob(e,t,2,!1),n.add(r))}function s_(t,e,n){var r=0;e&&(r|=4),ob(n,t,r,e)}var jd="_reactListening"+Math.random().toString(36).slice(2);function Oc(t){if(!t[jd]){t[jd]=!0,fP.forEach(function(n){n!=="selectionchange"&&(uF.has(n)||s_(n,!1,t),s_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[jd]||(e[jd]=!0,s_("selectionchange",!1,e))}}function ob(t,e,n,r){switch(jP(e)){case 1:var i=TV;break;case 4:i=SV;break;default:i=qw}n=i.bind(null,e,n,t),i=void 0,!_y||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function o_(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=yo(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}bP(function(){var u=s,c=Bw(n),h=[];e:{var d=ib.get(t);if(d!==void 0){var f=Hw,p=t;switch(t){case"keypress":if(gf(n)===0)break e;case"keydown":case"keyup":f=UV;break;case"focusin":p="focus",f=Zg;break;case"focusout":p="blur",f=Zg;break;case"beforeblur":case"afterblur":f=Zg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=V0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=CV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=zV;break;case eb:case tb:case nb:f=kV;break;case rb:f=qV;break;case"scroll":f=RV;break;case"wheel":f=HV;break;case"copy":case"cut":case"paste":f=xV;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=U0}var m=(e&4)!==0,v=!m&&t==="scroll",g=m?d!==null?d+"Capture":null:d;m=[];for(var _=u,y;_!==null;){y=_;var T=y.stateNode;if(y.tag===5&&T!==null&&(y=T,g!==null&&(T=Pc(_,g),T!=null&&m.push(Lc(_,T,y)))),v)break;_=_.return}0<m.length&&(d=new f(d,p,null,n,c),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==my&&(p=n.relatedTarget||n.fromElement)&&(yo(p)||p[Ri]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=u,p=p?yo(p):null,p!==null&&(v=aa(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(m=V0,T="onMouseLeave",g="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(m=U0,T="onPointerLeave",g="onPointerEnter",_="pointer"),v=f==null?d:$a(f),y=p==null?d:$a(p),d=new m(T,_+"leave",f,n,c),d.target=v,d.relatedTarget=y,T=null,yo(c)===u&&(m=new m(g,_+"enter",p,n,c),m.target=y,m.relatedTarget=v,T=m),v=T,f&&p)t:{for(m=f,g=p,_=0,y=m;y;y=Ta(y))_++;for(y=0,T=g;T;T=Ta(T))y++;for(;0<_-y;)m=Ta(m),_--;for(;0<y-_;)g=Ta(g),y--;for(;_--;){if(m===g||g!==null&&m===g.alternate)break t;m=Ta(m),g=Ta(g)}m=null}else m=null;f!==null&&Y0(h,d,f,m,!1),p!==null&&v!==null&&Y0(h,v,p,m,!0)}}e:{if(d=u?$a(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var b=ZV;else if(z0(d))if(QP)b=rF;else{b=tF;var w=eF}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(b=nF);if(b&&(b=b(t,u))){KP(h,b,n,c);break e}w&&w(t,d,u),t==="focusout"&&(w=d._wrapperState)&&w.controlled&&d.type==="number"&&cy(d,"number",d.value)}switch(w=u?$a(u):window,t){case"focusin":(z0(w)||w.contentEditable==="true")&&(Ua=w,Iy=u,oc=null);break;case"focusout":oc=Iy=Ua=null;break;case"mousedown":Ty=!0;break;case"contextmenu":case"mouseup":case"dragend":Ty=!1,G0(h,n,c);break;case"selectionchange":if(oF)break;case"keydown":case"keyup":G0(h,n,c)}var A;if(Kw)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Fa?HP(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(WP&&n.locale!=="ko"&&(Fa||x!=="onCompositionStart"?x==="onCompositionEnd"&&Fa&&(A=qP()):(os=c,Ww="value"in os?os.value:os.textContent,Fa=!0)),w=Gf(u,x),0<w.length&&(x=new F0(x,t,null,n,c),h.push({event:x,listeners:w}),A?x.data=A:(A=GP(n),A!==null&&(x.data=A)))),(A=KV?QV(t,n):YV(t,n))&&(u=Gf(u,"onBeforeInput"),0<u.length&&(c=new F0("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=A))}sb(h,e)})}function Lc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gf(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Pc(t,n),s!=null&&r.unshift(Lc(t,s,i)),s=Pc(t,e),s!=null&&r.push(Lc(t,s,i))),t=t.return}return r}function Ta(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Y0(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Pc(n,s),l!=null&&o.unshift(Lc(n,l,a))):i||(l=Pc(n,s),l!=null&&o.push(Lc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var cF=/\r\n?/g,hF=/\u0000|\uFFFD/g;function J0(t){return(typeof t=="string"?t:""+t).replace(cF,`
`).replace(hF,"")}function qd(t,e,n){if(e=J0(e),J0(t)!==e&&n)throw Error(D(425))}function Kf(){}var Sy=null,Ry=null;function Ay(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Cy=typeof setTimeout=="function"?setTimeout:void 0,dF=typeof clearTimeout=="function"?clearTimeout:void 0,X0=typeof Promise=="function"?Promise:void 0,fF=typeof queueMicrotask=="function"?queueMicrotask:typeof X0<"u"?function(t){return X0.resolve(null).then(t).catch(pF)}:Cy;function pF(t){setTimeout(function(){throw t})}function a_(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Nc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Nc(e)}function ms(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Z0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ql=Math.random().toString(36).slice(2),Ur="__reactFiber$"+ql,Mc="__reactProps$"+ql,Ri="__reactContainer$"+ql,Py="__reactEvents$"+ql,mF="__reactListeners$"+ql,gF="__reactHandles$"+ql;function yo(t){var e=t[Ur];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ri]||n[Ur]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Z0(t);t!==null;){if(n=t[Ur])return n;t=Z0(t)}return e}t=n,n=t.parentNode}return null}function zh(t){return t=t[Ur]||t[Ri],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $a(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(D(33))}function sm(t){return t[Mc]||null}var by=[],za=-1;function Hs(t){return{current:t}}function je(t){0>za||(t.current=by[za],by[za]=null,za--)}function Ve(t,e){za++,by[za]=t.current,t.current=e}var Ps={},un=Hs(Ps),Dn=Hs(!1),Mo=Ps;function pl(t,e){var n=t.type.contextTypes;if(!n)return Ps;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function On(t){return t=t.childContextTypes,t!=null}function Qf(){je(Dn),je(un)}function eS(t,e,n){if(un.current!==Ps)throw Error(D(168));Ve(un,e),Ve(Dn,n)}function ab(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(D(108,eV(t)||"Unknown",i));return et({},n,r)}function Yf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ps,Mo=un.current,Ve(un,t),Ve(Dn,Dn.current),!0}function tS(t,e,n){var r=t.stateNode;if(!r)throw Error(D(169));n?(t=ab(t,e,Mo),r.__reactInternalMemoizedMergedChildContext=t,je(Dn),je(un),Ve(un,t)):je(Dn),Ve(Dn,n)}var hi=null,om=!1,l_=!1;function lb(t){hi===null?hi=[t]:hi.push(t)}function _F(t){om=!0,lb(t)}function Gs(){if(!l_&&hi!==null){l_=!0;var t=0,e=Pe;try{var n=hi;for(Pe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}hi=null,om=!1}catch(i){throw hi!==null&&(hi=hi.slice(t+1)),DP($w,Gs),i}finally{Pe=e,l_=!1}}return null}var ja=[],qa=0,Jf=null,Xf=0,tr=[],nr=0,Vo=null,di=1,fi="";function oo(t,e){ja[qa++]=Xf,ja[qa++]=Jf,Jf=t,Xf=e}function ub(t,e,n){tr[nr++]=di,tr[nr++]=fi,tr[nr++]=Vo,Vo=t;var r=di;t=fi;var i=32-Ar(r)-1;r&=~(1<<i),n+=1;var s=32-Ar(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,di=1<<32-Ar(e)+i|n<<i|r,fi=s+t}else di=1<<s|n<<i|r,fi=t}function Yw(t){t.return!==null&&(oo(t,1),ub(t,1,0))}function Jw(t){for(;t===Jf;)Jf=ja[--qa],ja[qa]=null,Xf=ja[--qa],ja[qa]=null;for(;t===Vo;)Vo=tr[--nr],tr[nr]=null,fi=tr[--nr],tr[nr]=null,di=tr[--nr],tr[nr]=null}var Wn=null,jn=null,We=!1,Tr=null;function cb(t,e){var n=sr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wn=t,jn=ms(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wn=t,jn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vo!==null?{id:di,overflow:fi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=sr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Wn=t,jn=null,!0):!1;default:return!1}}function ky(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ny(t){if(We){var e=jn;if(e){var n=e;if(!nS(t,e)){if(ky(t))throw Error(D(418));e=ms(n.nextSibling);var r=Wn;e&&nS(t,e)?cb(r,n):(t.flags=t.flags&-4097|2,We=!1,Wn=t)}}else{if(ky(t))throw Error(D(418));t.flags=t.flags&-4097|2,We=!1,Wn=t}}}function rS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wn=t}function Wd(t){if(t!==Wn)return!1;if(!We)return rS(t),We=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ay(t.type,t.memoizedProps)),e&&(e=jn)){if(ky(t))throw hb(),Error(D(418));for(;e;)cb(t,e),e=ms(e.nextSibling)}if(rS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(D(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){jn=ms(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}jn=null}}else jn=Wn?ms(t.stateNode.nextSibling):null;return!0}function hb(){for(var t=jn;t;)t=ms(t.nextSibling)}function ml(){jn=Wn=null,We=!1}function Xw(t){Tr===null?Tr=[t]:Tr.push(t)}var yF=Di.ReactCurrentBatchConfig;function wr(t,e){if(t&&t.defaultProps){e=et({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Zf=Hs(null),ep=null,Wa=null,Zw=null;function eE(){Zw=Wa=ep=null}function tE(t){var e=Zf.current;je(Zf),t._currentValue=e}function xy(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function nl(t,e){ep=t,Zw=Wa=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Pn=!0),t.firstContext=null)}function dr(t){var e=t._currentValue;if(Zw!==t)if(t={context:t,memoizedValue:e,next:null},Wa===null){if(ep===null)throw Error(D(308));Wa=t,ep.dependencies={lanes:0,firstContext:t}}else Wa=Wa.next=t;return e}var vo=null;function nE(t){vo===null?vo=[t]:vo.push(t)}function db(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,nE(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ai(t,r)}function Ai(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ts=!1;function rE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function gs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ee&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ai(t,n)}return i=r.interleaved,i===null?(e.next=e,nE(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ai(t,n)}function _f(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zw(t,n)}}function iS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function tp(t,e,n,r){var i=t.updateQueue;ts=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,c=u=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(d=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=et({},h,d);break e;case 2:ts=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,o|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Uo|=o,t.lanes=o,t.memoizedState=h}}function sS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(D(191,i));i.call(r)}}}var pb=new dP.Component().refs;function Dy(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:et({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var am={isMounted:function(t){return(t=t._reactInternals)?aa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=gn(),i=ys(t),s=vi(r,i);s.payload=e,n!=null&&(s.callback=n),e=gs(t,s,i),e!==null&&(Cr(e,t,i,r),_f(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=gn(),i=ys(t),s=vi(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=gs(t,s,i),e!==null&&(Cr(e,t,i,r),_f(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=gn(),r=ys(t),i=vi(n,r);i.tag=2,e!=null&&(i.callback=e),e=gs(t,i,r),e!==null&&(Cr(e,t,r,n),_f(e,t,r))}};function oS(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Dc(n,r)||!Dc(i,s):!0}function mb(t,e,n){var r=!1,i=Ps,s=e.contextType;return typeof s=="object"&&s!==null?s=dr(s):(i=On(e)?Mo:un.current,r=e.contextTypes,s=(r=r!=null)?pl(t,i):Ps),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=am,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function aS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&am.enqueueReplaceState(e,e.state,null)}function Oy(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=pb,rE(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=dr(s):(s=On(e)?Mo:un.current,i.context=pl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Dy(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&am.enqueueReplaceState(i,i.state,null),tp(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Iu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(D(309));var r=n.stateNode}if(!r)throw Error(D(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===pb&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(D(284));if(!n._owner)throw Error(D(290,t))}return t}function Hd(t,e){throw t=Object.prototype.toString.call(e),Error(D(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lS(t){var e=t._init;return e(t._payload)}function gb(t){function e(g,_){if(t){var y=g.deletions;y===null?(g.deletions=[_],g.flags|=16):y.push(_)}}function n(g,_){if(!t)return null;for(;_!==null;)e(g,_),_=_.sibling;return null}function r(g,_){for(g=new Map;_!==null;)_.key!==null?g.set(_.key,_):g.set(_.index,_),_=_.sibling;return g}function i(g,_){return g=vs(g,_),g.index=0,g.sibling=null,g}function s(g,_,y){return g.index=y,t?(y=g.alternate,y!==null?(y=y.index,y<_?(g.flags|=2,_):y):(g.flags|=2,_)):(g.flags|=1048576,_)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,_,y,T){return _===null||_.tag!==6?(_=m_(y,g.mode,T),_.return=g,_):(_=i(_,y),_.return=g,_)}function l(g,_,y,T){var b=y.type;return b===Va?c(g,_,y.props.children,T,y.key):_!==null&&(_.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===es&&lS(b)===_.type)?(T=i(_,y.props),T.ref=Iu(g,_,y),T.return=g,T):(T=Tf(y.type,y.key,y.props,null,g.mode,T),T.ref=Iu(g,_,y),T.return=g,T)}function u(g,_,y,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==y.containerInfo||_.stateNode.implementation!==y.implementation?(_=g_(y,g.mode,T),_.return=g,_):(_=i(_,y.children||[]),_.return=g,_)}function c(g,_,y,T,b){return _===null||_.tag!==7?(_=ko(y,g.mode,T,b),_.return=g,_):(_=i(_,y),_.return=g,_)}function h(g,_,y){if(typeof _=="string"&&_!==""||typeof _=="number")return _=m_(""+_,g.mode,y),_.return=g,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ld:return y=Tf(_.type,_.key,_.props,null,g.mode,y),y.ref=Iu(g,null,_),y.return=g,y;case Ma:return _=g_(_,g.mode,y),_.return=g,_;case es:var T=_._init;return h(g,T(_._payload),y)}if(Hu(_)||_u(_))return _=ko(_,g.mode,y,null),_.return=g,_;Hd(g,_)}return null}function d(g,_,y,T){var b=_!==null?_.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:a(g,_,""+y,T);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ld:return y.key===b?l(g,_,y,T):null;case Ma:return y.key===b?u(g,_,y,T):null;case es:return b=y._init,d(g,_,b(y._payload),T)}if(Hu(y)||_u(y))return b!==null?null:c(g,_,y,T,null);Hd(g,y)}return null}function f(g,_,y,T,b){if(typeof T=="string"&&T!==""||typeof T=="number")return g=g.get(y)||null,a(_,g,""+T,b);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Ld:return g=g.get(T.key===null?y:T.key)||null,l(_,g,T,b);case Ma:return g=g.get(T.key===null?y:T.key)||null,u(_,g,T,b);case es:var w=T._init;return f(g,_,y,w(T._payload),b)}if(Hu(T)||_u(T))return g=g.get(y)||null,c(_,g,T,b,null);Hd(_,T)}return null}function p(g,_,y,T){for(var b=null,w=null,A=_,x=_=0,$=null;A!==null&&x<y.length;x++){A.index>x?($=A,A=null):$=A.sibling;var G=d(g,A,y[x],T);if(G===null){A===null&&(A=$);break}t&&A&&G.alternate===null&&e(g,A),_=s(G,_,x),w===null?b=G:w.sibling=G,w=G,A=$}if(x===y.length)return n(g,A),We&&oo(g,x),b;if(A===null){for(;x<y.length;x++)A=h(g,y[x],T),A!==null&&(_=s(A,_,x),w===null?b=A:w.sibling=A,w=A);return We&&oo(g,x),b}for(A=r(g,A);x<y.length;x++)$=f(A,g,x,y[x],T),$!==null&&(t&&$.alternate!==null&&A.delete($.key===null?x:$.key),_=s($,_,x),w===null?b=$:w.sibling=$,w=$);return t&&A.forEach(function(oe){return e(g,oe)}),We&&oo(g,x),b}function m(g,_,y,T){var b=_u(y);if(typeof b!="function")throw Error(D(150));if(y=b.call(y),y==null)throw Error(D(151));for(var w=b=null,A=_,x=_=0,$=null,G=y.next();A!==null&&!G.done;x++,G=y.next()){A.index>x?($=A,A=null):$=A.sibling;var oe=d(g,A,G.value,T);if(oe===null){A===null&&(A=$);break}t&&A&&oe.alternate===null&&e(g,A),_=s(oe,_,x),w===null?b=oe:w.sibling=oe,w=oe,A=$}if(G.done)return n(g,A),We&&oo(g,x),b;if(A===null){for(;!G.done;x++,G=y.next())G=h(g,G.value,T),G!==null&&(_=s(G,_,x),w===null?b=G:w.sibling=G,w=G);return We&&oo(g,x),b}for(A=r(g,A);!G.done;x++,G=y.next())G=f(A,g,x,G.value,T),G!==null&&(t&&G.alternate!==null&&A.delete(G.key===null?x:G.key),_=s(G,_,x),w===null?b=G:w.sibling=G,w=G);return t&&A.forEach(function(Re){return e(g,Re)}),We&&oo(g,x),b}function v(g,_,y,T){if(typeof y=="object"&&y!==null&&y.type===Va&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ld:e:{for(var b=y.key,w=_;w!==null;){if(w.key===b){if(b=y.type,b===Va){if(w.tag===7){n(g,w.sibling),_=i(w,y.props.children),_.return=g,g=_;break e}}else if(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===es&&lS(b)===w.type){n(g,w.sibling),_=i(w,y.props),_.ref=Iu(g,w,y),_.return=g,g=_;break e}n(g,w);break}else e(g,w);w=w.sibling}y.type===Va?(_=ko(y.props.children,g.mode,T,y.key),_.return=g,g=_):(T=Tf(y.type,y.key,y.props,null,g.mode,T),T.ref=Iu(g,_,y),T.return=g,g=T)}return o(g);case Ma:e:{for(w=y.key;_!==null;){if(_.key===w)if(_.tag===4&&_.stateNode.containerInfo===y.containerInfo&&_.stateNode.implementation===y.implementation){n(g,_.sibling),_=i(_,y.children||[]),_.return=g,g=_;break e}else{n(g,_);break}else e(g,_);_=_.sibling}_=g_(y,g.mode,T),_.return=g,g=_}return o(g);case es:return w=y._init,v(g,_,w(y._payload),T)}if(Hu(y))return p(g,_,y,T);if(_u(y))return m(g,_,y,T);Hd(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,_!==null&&_.tag===6?(n(g,_.sibling),_=i(_,y),_.return=g,g=_):(n(g,_),_=m_(y,g.mode,T),_.return=g,g=_),o(g)):n(g,_)}return v}var gl=gb(!0),_b=gb(!1),jh={},Xr=Hs(jh),Vc=Hs(jh),Fc=Hs(jh);function wo(t){if(t===jh)throw Error(D(174));return t}function iE(t,e){switch(Ve(Fc,e),Ve(Vc,t),Ve(Xr,jh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=dy(e,t)}je(Xr),Ve(Xr,e)}function _l(){je(Xr),je(Vc),je(Fc)}function yb(t){wo(Fc.current);var e=wo(Xr.current),n=dy(e,t.type);e!==n&&(Ve(Vc,t),Ve(Xr,n))}function sE(t){Vc.current===t&&(je(Xr),je(Vc))}var Ye=Hs(0);function np(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var u_=[];function oE(){for(var t=0;t<u_.length;t++)u_[t]._workInProgressVersionPrimary=null;u_.length=0}var yf=Di.ReactCurrentDispatcher,c_=Di.ReactCurrentBatchConfig,Fo=0,Xe=null,wt=null,bt=null,rp=!1,ac=!1,Uc=0,vF=0;function en(){throw Error(D(321))}function aE(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!br(t[n],e[n]))return!1;return!0}function lE(t,e,n,r,i,s){if(Fo=s,Xe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yf.current=t===null||t.memoizedState===null?TF:SF,t=n(r,i),ac){s=0;do{if(ac=!1,Uc=0,25<=s)throw Error(D(301));s+=1,bt=wt=null,e.updateQueue=null,yf.current=RF,t=n(r,i)}while(ac)}if(yf.current=ip,e=wt!==null&&wt.next!==null,Fo=0,bt=wt=Xe=null,rp=!1,e)throw Error(D(300));return t}function uE(){var t=Uc!==0;return Uc=0,t}function Fr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?Xe.memoizedState=bt=t:bt=bt.next=t,bt}function fr(){if(wt===null){var t=Xe.alternate;t=t!==null?t.memoizedState:null}else t=wt.next;var e=bt===null?Xe.memoizedState:bt.next;if(e!==null)bt=e,wt=t;else{if(t===null)throw Error(D(310));wt=t,t={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},bt===null?Xe.memoizedState=bt=t:bt=bt.next=t}return bt}function Bc(t,e){return typeof e=="function"?e(t):e}function h_(t){var e=fr(),n=e.queue;if(n===null)throw Error(D(311));n.lastRenderedReducer=t;var r=wt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((Fo&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,Xe.lanes|=c,Uo|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,br(r,e.memoizedState)||(Pn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Xe.lanes|=s,Uo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function d_(t){var e=fr(),n=e.queue;if(n===null)throw Error(D(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);br(s,e.memoizedState)||(Pn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function vb(){}function wb(t,e){var n=Xe,r=fr(),i=e(),s=!br(r.memoizedState,i);if(s&&(r.memoizedState=i,Pn=!0),r=r.queue,cE(Tb.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,$c(9,Ib.bind(null,n,r,i,e),void 0,null),Ot===null)throw Error(D(349));Fo&30||Eb(n,e,i)}return i}function Eb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Xe.updateQueue,e===null?(e={lastEffect:null,stores:null},Xe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ib(t,e,n,r){e.value=n,e.getSnapshot=r,Sb(e)&&Rb(t)}function Tb(t,e,n){return n(function(){Sb(e)&&Rb(t)})}function Sb(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!br(t,n)}catch{return!0}}function Rb(t){var e=Ai(t,1);e!==null&&Cr(e,t,1,-1)}function uS(t){var e=Fr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:t},e.queue=t,t=t.dispatch=IF.bind(null,Xe,t),[e.memoizedState,t]}function $c(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Xe.updateQueue,e===null?(e={lastEffect:null,stores:null},Xe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ab(){return fr().memoizedState}function vf(t,e,n,r){var i=Fr();Xe.flags|=t,i.memoizedState=$c(1|e,n,void 0,r===void 0?null:r)}function lm(t,e,n,r){var i=fr();r=r===void 0?null:r;var s=void 0;if(wt!==null){var o=wt.memoizedState;if(s=o.destroy,r!==null&&aE(r,o.deps)){i.memoizedState=$c(e,n,s,r);return}}Xe.flags|=t,i.memoizedState=$c(1|e,n,s,r)}function cS(t,e){return vf(8390656,8,t,e)}function cE(t,e){return lm(2048,8,t,e)}function Cb(t,e){return lm(4,2,t,e)}function Pb(t,e){return lm(4,4,t,e)}function bb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kb(t,e,n){return n=n!=null?n.concat([t]):null,lm(4,4,bb.bind(null,e,t),n)}function hE(){}function Nb(t,e){var n=fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&aE(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function xb(t,e){var n=fr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&aE(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Db(t,e,n){return Fo&21?(br(n,e)||(n=MP(),Xe.lanes|=n,Uo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Pn=!0),t.memoizedState=n)}function wF(t,e){var n=Pe;Pe=n!==0&&4>n?n:4,t(!0);var r=c_.transition;c_.transition={};try{t(!1),e()}finally{Pe=n,c_.transition=r}}function Ob(){return fr().memoizedState}function EF(t,e,n){var r=ys(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Lb(t))Mb(e,n);else if(n=db(t,e,n,r),n!==null){var i=gn();Cr(n,t,r,i),Vb(n,e,r)}}function IF(t,e,n){var r=ys(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Lb(t))Mb(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,br(a,o)){var l=e.interleaved;l===null?(i.next=i,nE(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=db(t,e,i,r),n!==null&&(i=gn(),Cr(n,t,r,i),Vb(n,e,r))}}function Lb(t){var e=t.alternate;return t===Xe||e!==null&&e===Xe}function Mb(t,e){ac=rp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Vb(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zw(t,n)}}var ip={readContext:dr,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},TF={readContext:dr,useCallback:function(t,e){return Fr().memoizedState=[t,e===void 0?null:e],t},useContext:dr,useEffect:cS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,vf(4194308,4,bb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return vf(4194308,4,t,e)},useInsertionEffect:function(t,e){return vf(4,2,t,e)},useMemo:function(t,e){var n=Fr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Fr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=EF.bind(null,Xe,t),[r.memoizedState,t]},useRef:function(t){var e=Fr();return t={current:t},e.memoizedState=t},useState:uS,useDebugValue:hE,useDeferredValue:function(t){return Fr().memoizedState=t},useTransition:function(){var t=uS(!1),e=t[0];return t=wF.bind(null,t[1]),Fr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Xe,i=Fr();if(We){if(n===void 0)throw Error(D(407));n=n()}else{if(n=e(),Ot===null)throw Error(D(349));Fo&30||Eb(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,cS(Tb.bind(null,r,s,t),[t]),r.flags|=2048,$c(9,Ib.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Fr(),e=Ot.identifierPrefix;if(We){var n=fi,r=di;n=(r&~(1<<32-Ar(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Uc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=vF++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},SF={readContext:dr,useCallback:Nb,useContext:dr,useEffect:cE,useImperativeHandle:kb,useInsertionEffect:Cb,useLayoutEffect:Pb,useMemo:xb,useReducer:h_,useRef:Ab,useState:function(){return h_(Bc)},useDebugValue:hE,useDeferredValue:function(t){var e=fr();return Db(e,wt.memoizedState,t)},useTransition:function(){var t=h_(Bc)[0],e=fr().memoizedState;return[t,e]},useMutableSource:vb,useSyncExternalStore:wb,useId:Ob,unstable_isNewReconciler:!1},RF={readContext:dr,useCallback:Nb,useContext:dr,useEffect:cE,useImperativeHandle:kb,useInsertionEffect:Cb,useLayoutEffect:Pb,useMemo:xb,useReducer:d_,useRef:Ab,useState:function(){return d_(Bc)},useDebugValue:hE,useDeferredValue:function(t){var e=fr();return wt===null?e.memoizedState=t:Db(e,wt.memoizedState,t)},useTransition:function(){var t=d_(Bc)[0],e=fr().memoizedState;return[t,e]},useMutableSource:vb,useSyncExternalStore:wb,useId:Ob,unstable_isNewReconciler:!1};function yl(t,e){try{var n="",r=e;do n+=ZM(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function f_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ly(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var AF=typeof WeakMap=="function"?WeakMap:Map;function Fb(t,e,n){n=vi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){op||(op=!0,Wy=r),Ly(t,e)},n}function Ub(t,e,n){n=vi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Ly(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Ly(t,e),typeof r!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function hS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new AF;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=BF.bind(null,t,e,n),e.then(t,t))}function dS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fS(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=vi(-1,1),e.tag=2,gs(n,e,1))),n.lanes|=1),t)}var CF=Di.ReactCurrentOwner,Pn=!1;function dn(t,e,n,r){e.child=t===null?_b(e,null,n,r):gl(e,t.child,n,r)}function pS(t,e,n,r,i){n=n.render;var s=e.ref;return nl(e,i),r=lE(t,e,n,r,s,i),n=uE(),t!==null&&!Pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ci(t,e,i)):(We&&n&&Yw(e),e.flags|=1,dn(t,e,r,i),e.child)}function mS(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!vE(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Bb(t,e,s,r,i)):(t=Tf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Dc,n(o,r)&&t.ref===e.ref)return Ci(t,e,i)}return e.flags|=1,t=vs(s,r),t.ref=e.ref,t.return=e,e.child=t}function Bb(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Dc(s,r)&&t.ref===e.ref)if(Pn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Pn=!0);else return e.lanes=t.lanes,Ci(t,e,i)}return My(t,e,n,r,i)}function $b(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Ga,Bn),Bn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ve(Ga,Bn),Bn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ve(Ga,Bn),Bn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ve(Ga,Bn),Bn|=r;return dn(t,e,i,n),e.child}function zb(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function My(t,e,n,r,i){var s=On(n)?Mo:un.current;return s=pl(e,s),nl(e,i),n=lE(t,e,n,r,s,i),r=uE(),t!==null&&!Pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ci(t,e,i)):(We&&r&&Yw(e),e.flags|=1,dn(t,e,n,i),e.child)}function gS(t,e,n,r,i){if(On(n)){var s=!0;Yf(e)}else s=!1;if(nl(e,i),e.stateNode===null)wf(t,e),mb(e,n,r),Oy(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=dr(u):(u=On(n)?Mo:un.current,u=pl(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&aS(e,o,r,u),ts=!1;var d=e.memoizedState;o.state=d,tp(e,r,o,i),l=e.memoizedState,a!==r||d!==l||Dn.current||ts?(typeof c=="function"&&(Dy(e,n,c,r),l=e.memoizedState),(a=ts||oS(e,n,a,r,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,fb(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:wr(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=dr(l):(l=On(n)?Mo:un.current,l=pl(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&aS(e,o,r,l),ts=!1,d=e.memoizedState,o.state=d,tp(e,r,o,i);var p=e.memoizedState;a!==h||d!==p||Dn.current||ts?(typeof f=="function"&&(Dy(e,n,f,r),p=e.memoizedState),(u=ts||oS(e,n,u,r,d,p,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return Vy(t,e,n,r,s,i)}function Vy(t,e,n,r,i,s){zb(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&tS(e,n,!1),Ci(t,e,s);r=e.stateNode,CF.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=gl(e,t.child,null,s),e.child=gl(e,null,a,s)):dn(t,e,a,s),e.memoizedState=r.state,i&&tS(e,n,!0),e.child}function jb(t){var e=t.stateNode;e.pendingContext?eS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&eS(t,e.context,!1),iE(t,e.containerInfo)}function _S(t,e,n,r,i){return ml(),Xw(i),e.flags|=256,dn(t,e,n,r),e.child}var Fy={dehydrated:null,treeContext:null,retryLane:0};function Uy(t){return{baseLanes:t,cachePool:null,transitions:null}}function qb(t,e,n){var r=e.pendingProps,i=Ye.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ve(Ye,i&1),t===null)return Ny(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=hm(o,r,0,null),t=ko(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Uy(n),e.memoizedState=Fy,t):dE(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return PF(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=vs(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=vs(a,s):(s=ko(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Uy(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Fy,r}return s=t.child,t=s.sibling,r=vs(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function dE(t,e){return e=hm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Gd(t,e,n,r){return r!==null&&Xw(r),gl(e,t.child,null,n),t=dE(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function PF(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=f_(Error(D(422))),Gd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=hm({mode:"visible",children:r.children},i,0,null),s=ko(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&gl(e,t.child,null,o),e.child.memoizedState=Uy(o),e.memoizedState=Fy,s);if(!(e.mode&1))return Gd(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(D(419)),r=f_(s,r,void 0),Gd(t,e,o,r)}if(a=(o&t.childLanes)!==0,Pn||a){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ai(t,i),Cr(r,t,i,-1))}return yE(),r=f_(Error(D(421))),Gd(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=$F.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,jn=ms(i.nextSibling),Wn=e,We=!0,Tr=null,t!==null&&(tr[nr++]=di,tr[nr++]=fi,tr[nr++]=Vo,di=t.id,fi=t.overflow,Vo=e),e=dE(e,r.children),e.flags|=4096,e)}function yS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),xy(t.return,e,n)}function p_(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Wb(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(dn(t,e,r.children,n),r=Ye.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yS(t,n,e);else if(t.tag===19)yS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ve(Ye,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&np(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),p_(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&np(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}p_(e,!0,n,null,s);break;case"together":p_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ci(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Uo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(D(153));if(e.child!==null){for(t=e.child,n=vs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function bF(t,e,n){switch(e.tag){case 3:jb(e),ml();break;case 5:yb(e);break;case 1:On(e.type)&&Yf(e);break;case 4:iE(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ve(Zf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ve(Ye,Ye.current&1),e.flags|=128,null):n&e.child.childLanes?qb(t,e,n):(Ve(Ye,Ye.current&1),t=Ci(t,e,n),t!==null?t.sibling:null);Ve(Ye,Ye.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Wb(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ve(Ye,Ye.current),r)break;return null;case 22:case 23:return e.lanes=0,$b(t,e,n)}return Ci(t,e,n)}var Hb,By,Gb,Kb;Hb=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};By=function(){};Gb=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,wo(Xr.current);var s=null;switch(n){case"input":i=ly(t,i),r=ly(t,r),s=[];break;case"select":i=et({},i,{value:void 0}),r=et({},r,{value:void 0}),s=[];break;case"textarea":i=hy(t,i),r=hy(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Kf)}fy(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ac.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ac.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Be("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Kb=function(t,e,n,r){n!==r&&(e.flags|=4)};function Tu(t,e){if(!We)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function tn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function kF(t,e,n){var r=e.pendingProps;switch(Jw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(e),null;case 1:return On(e.type)&&Qf(),tn(e),null;case 3:return r=e.stateNode,_l(),je(Dn),je(un),oE(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Tr!==null&&(Ky(Tr),Tr=null))),By(t,e),tn(e),null;case 5:sE(e);var i=wo(Fc.current);if(n=e.type,t!==null&&e.stateNode!=null)Gb(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(D(166));return tn(e),null}if(t=wo(Xr.current),Wd(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ur]=e,r[Mc]=s,t=(e.mode&1)!==0,n){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(i=0;i<Ku.length;i++)Be(Ku[i],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":C0(r,s),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Be("invalid",r);break;case"textarea":b0(r,s),Be("invalid",r)}fy(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&qd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&qd(r.textContent,a,t),i=["children",""+a]):Ac.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Be("scroll",r)}switch(n){case"input":Md(r),P0(r,s,!0);break;case"textarea":Md(r),k0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Kf)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=EP(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ur]=e,t[Mc]=r,Hb(t,e,!1,!1),e.stateNode=t;e:{switch(o=py(n,r),n){case"dialog":Be("cancel",t),Be("close",t),i=r;break;case"iframe":case"object":case"embed":Be("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ku.length;i++)Be(Ku[i],t);i=r;break;case"source":Be("error",t),i=r;break;case"img":case"image":case"link":Be("error",t),Be("load",t),i=r;break;case"details":Be("toggle",t),i=r;break;case"input":C0(t,r),i=ly(t,r),Be("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=et({},r,{value:void 0}),Be("invalid",t);break;case"textarea":b0(t,r),i=hy(t,r),Be("invalid",t);break;default:i=r}fy(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?SP(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&IP(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Cc(t,l):typeof l=="number"&&Cc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ac.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Be("scroll",t):l!=null&&Mw(t,s,l,o))}switch(n){case"input":Md(t),P0(t,r,!1);break;case"textarea":Md(t),k0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Cs(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Xa(t,!!r.multiple,s,!1):r.defaultValue!=null&&Xa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Kf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return tn(e),null;case 6:if(t&&e.stateNode!=null)Kb(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(D(166));if(n=wo(Fc.current),wo(Xr.current),Wd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ur]=e,(s=r.nodeValue!==n)&&(t=Wn,t!==null))switch(t.tag){case 3:qd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qd(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ur]=e,e.stateNode=r}return tn(e),null;case 13:if(je(Ye),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(We&&jn!==null&&e.mode&1&&!(e.flags&128))hb(),ml(),e.flags|=98560,s=!1;else if(s=Wd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(D(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(D(317));s[Ur]=e}else ml(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;tn(e),s=!1}else Tr!==null&&(Ky(Tr),Tr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ye.current&1?It===0&&(It=3):yE())),e.updateQueue!==null&&(e.flags|=4),tn(e),null);case 4:return _l(),By(t,e),t===null&&Oc(e.stateNode.containerInfo),tn(e),null;case 10:return tE(e.type._context),tn(e),null;case 17:return On(e.type)&&Qf(),tn(e),null;case 19:if(je(Ye),s=e.memoizedState,s===null)return tn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Tu(s,!1);else{if(It!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=np(t),o!==null){for(e.flags|=128,Tu(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ve(Ye,Ye.current&1|2),e.child}t=t.sibling}s.tail!==null&&ft()>vl&&(e.flags|=128,r=!0,Tu(s,!1),e.lanes=4194304)}else{if(!r)if(t=np(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Tu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!We)return tn(e),null}else 2*ft()-s.renderingStartTime>vl&&n!==1073741824&&(e.flags|=128,r=!0,Tu(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ft(),e.sibling=null,n=Ye.current,Ve(Ye,r?n&1|2:n&1),e):(tn(e),null);case 22:case 23:return _E(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Bn&1073741824&&(tn(e),e.subtreeFlags&6&&(e.flags|=8192)):tn(e),null;case 24:return null;case 25:return null}throw Error(D(156,e.tag))}function NF(t,e){switch(Jw(e),e.tag){case 1:return On(e.type)&&Qf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return _l(),je(Dn),je(un),oE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return sE(e),null;case 13:if(je(Ye),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(D(340));ml()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return je(Ye),null;case 4:return _l(),null;case 10:return tE(e.type._context),null;case 22:case 23:return _E(),null;case 24:return null;default:return null}}var Kd=!1,sn=!1,xF=typeof WeakSet=="function"?WeakSet:Set,W=null;function Ha(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){it(t,e,r)}else n.current=null}function $y(t,e,n){try{n()}catch(r){it(t,e,r)}}var vS=!1;function DF(t,e){if(Sy=Wf,t=XP(),Qw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var f;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++u===i&&(a=o),d===s&&++c===r&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ry={focusedElem:t,selectionRange:n},Wf=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,g=e.stateNode,_=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:wr(e.type,m),v);g.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(D(163))}}catch(T){it(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return p=vS,vS=!1,p}function lc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&$y(e,n,s)}i=i.next}while(i!==r)}}function um(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function zy(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Qb(t){var e=t.alternate;e!==null&&(t.alternate=null,Qb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ur],delete e[Mc],delete e[Py],delete e[mF],delete e[gF])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Yb(t){return t.tag===5||t.tag===3||t.tag===4}function wS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Yb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Kf));else if(r!==4&&(t=t.child,t!==null))for(jy(t,e,n),t=t.sibling;t!==null;)jy(t,e,n),t=t.sibling}function qy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(qy(t,e,n),t=t.sibling;t!==null;)qy(t,e,n),t=t.sibling}var Wt=null,Er=!1;function Wi(t,e,n){for(n=n.child;n!==null;)Jb(t,e,n),n=n.sibling}function Jb(t,e,n){if(Jr&&typeof Jr.onCommitFiberUnmount=="function")try{Jr.onCommitFiberUnmount(tm,n)}catch{}switch(n.tag){case 5:sn||Ha(n,e);case 6:var r=Wt,i=Er;Wt=null,Wi(t,e,n),Wt=r,Er=i,Wt!==null&&(Er?(t=Wt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Wt.removeChild(n.stateNode));break;case 18:Wt!==null&&(Er?(t=Wt,n=n.stateNode,t.nodeType===8?a_(t.parentNode,n):t.nodeType===1&&a_(t,n),Nc(t)):a_(Wt,n.stateNode));break;case 4:r=Wt,i=Er,Wt=n.stateNode.containerInfo,Er=!0,Wi(t,e,n),Wt=r,Er=i;break;case 0:case 11:case 14:case 15:if(!sn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&$y(n,e,o),i=i.next}while(i!==r)}Wi(t,e,n);break;case 1:if(!sn&&(Ha(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){it(n,e,a)}Wi(t,e,n);break;case 21:Wi(t,e,n);break;case 22:n.mode&1?(sn=(r=sn)||n.memoizedState!==null,Wi(t,e,n),sn=r):Wi(t,e,n);break;default:Wi(t,e,n)}}function ES(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new xF),e.forEach(function(r){var i=zF.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function yr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Wt=a.stateNode,Er=!1;break e;case 3:Wt=a.stateNode.containerInfo,Er=!0;break e;case 4:Wt=a.stateNode.containerInfo,Er=!0;break e}a=a.return}if(Wt===null)throw Error(D(160));Jb(s,o,i),Wt=null,Er=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){it(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Xb(e,t),e=e.sibling}function Xb(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yr(e,t),Mr(t),r&4){try{lc(3,t,t.return),um(3,t)}catch(m){it(t,t.return,m)}try{lc(5,t,t.return)}catch(m){it(t,t.return,m)}}break;case 1:yr(e,t),Mr(t),r&512&&n!==null&&Ha(n,n.return);break;case 5:if(yr(e,t),Mr(t),r&512&&n!==null&&Ha(n,n.return),t.flags&32){var i=t.stateNode;try{Cc(i,"")}catch(m){it(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&vP(i,s),py(a,o);var u=py(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?SP(i,h):c==="dangerouslySetInnerHTML"?IP(i,h):c==="children"?Cc(i,h):Mw(i,c,h,u)}switch(a){case"input":uy(i,s);break;case"textarea":wP(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Xa(i,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?Xa(i,!!s.multiple,s.defaultValue,!0):Xa(i,!!s.multiple,s.multiple?[]:"",!1))}i[Mc]=s}catch(m){it(t,t.return,m)}}break;case 6:if(yr(e,t),Mr(t),r&4){if(t.stateNode===null)throw Error(D(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){it(t,t.return,m)}}break;case 3:if(yr(e,t),Mr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Nc(e.containerInfo)}catch(m){it(t,t.return,m)}break;case 4:yr(e,t),Mr(t);break;case 13:yr(e,t),Mr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(mE=ft())),r&4&&ES(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(sn=(u=sn)||c,yr(e,t),sn=u):yr(e,t),Mr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(W=t,c=t.child;c!==null;){for(h=W=c;W!==null;){switch(d=W,f=d.child,d.tag){case 0:case 11:case 14:case 15:lc(4,d,d.return);break;case 1:Ha(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){it(r,n,m)}}break;case 5:Ha(d,d.return);break;case 22:if(d.memoizedState!==null){TS(h);continue}}f!==null?(f.return=d,W=f):TS(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=TP("display",o))}catch(m){it(t,t.return,m)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){it(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yr(e,t),Mr(t),r&4&&ES(t);break;case 21:break;default:yr(e,t),Mr(t)}}function Mr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Yb(n)){var r=n;break e}n=n.return}throw Error(D(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Cc(i,""),r.flags&=-33);var s=wS(t);qy(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=wS(t);jy(t,a,o);break;default:throw Error(D(161))}}catch(l){it(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function OF(t,e,n){W=t,Zb(t)}function Zb(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var i=W,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Kd;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||sn;a=Kd;var u=sn;if(Kd=o,(sn=l)&&!u)for(W=i;W!==null;)o=W,l=o.child,o.tag===22&&o.memoizedState!==null?SS(i):l!==null?(l.return=o,W=l):SS(i);for(;s!==null;)W=s,Zb(s),s=s.sibling;W=i,Kd=a,sn=u}IS(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,W=s):IS(t)}}function IS(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:sn||um(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!sn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:wr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&sS(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}sS(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Nc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(D(163))}sn||e.flags&512&&zy(e)}catch(d){it(e,e.return,d)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function TS(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function SS(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{um(4,e)}catch(l){it(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){it(e,i,l)}}var s=e.return;try{zy(e)}catch(l){it(e,s,l)}break;case 5:var o=e.return;try{zy(e)}catch(l){it(e,o,l)}}}catch(l){it(e,e.return,l)}if(e===t){W=null;break}var a=e.sibling;if(a!==null){a.return=e.return,W=a;break}W=e.return}}var LF=Math.ceil,sp=Di.ReactCurrentDispatcher,fE=Di.ReactCurrentOwner,ur=Di.ReactCurrentBatchConfig,Ee=0,Ot=null,yt=null,Qt=0,Bn=0,Ga=Hs(0),It=0,zc=null,Uo=0,cm=0,pE=0,uc=null,An=null,mE=0,vl=1/0,ci=null,op=!1,Wy=null,_s=null,Qd=!1,as=null,ap=0,cc=0,Hy=null,Ef=-1,If=0;function gn(){return Ee&6?ft():Ef!==-1?Ef:Ef=ft()}function ys(t){return t.mode&1?Ee&2&&Qt!==0?Qt&-Qt:yF.transition!==null?(If===0&&(If=MP()),If):(t=Pe,t!==0||(t=window.event,t=t===void 0?16:jP(t.type)),t):1}function Cr(t,e,n,r){if(50<cc)throw cc=0,Hy=null,Error(D(185));Bh(t,n,r),(!(Ee&2)||t!==Ot)&&(t===Ot&&(!(Ee&2)&&(cm|=n),It===4&&rs(t,Qt)),Ln(t,r),n===1&&Ee===0&&!(e.mode&1)&&(vl=ft()+500,om&&Gs()))}function Ln(t,e){var n=t.callbackNode;yV(t,e);var r=qf(t,t===Ot?Qt:0);if(r===0)n!==null&&D0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&D0(n),e===1)t.tag===0?_F(RS.bind(null,t)):lb(RS.bind(null,t)),fF(function(){!(Ee&6)&&Gs()}),n=null;else{switch(VP(r)){case 1:n=$w;break;case 4:n=OP;break;case 16:n=jf;break;case 536870912:n=LP;break;default:n=jf}n=ak(n,ek.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ek(t,e){if(Ef=-1,If=0,Ee&6)throw Error(D(327));var n=t.callbackNode;if(rl()&&t.callbackNode!==n)return null;var r=qf(t,t===Ot?Qt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=lp(t,r);else{e=r;var i=Ee;Ee|=2;var s=nk();(Ot!==t||Qt!==e)&&(ci=null,vl=ft()+500,bo(t,e));do try{FF();break}catch(a){tk(t,a)}while(!0);eE(),sp.current=s,Ee=i,yt!==null?e=0:(Ot=null,Qt=0,e=It)}if(e!==0){if(e===2&&(i=vy(t),i!==0&&(r=i,e=Gy(t,i))),e===1)throw n=zc,bo(t,0),rs(t,r),Ln(t,ft()),n;if(e===6)rs(t,r);else{if(i=t.current.alternate,!(r&30)&&!MF(i)&&(e=lp(t,r),e===2&&(s=vy(t),s!==0&&(r=s,e=Gy(t,s))),e===1))throw n=zc,bo(t,0),rs(t,r),Ln(t,ft()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(D(345));case 2:ao(t,An,ci);break;case 3:if(rs(t,r),(r&130023424)===r&&(e=mE+500-ft(),10<e)){if(qf(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){gn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Cy(ao.bind(null,t,An,ci),e);break}ao(t,An,ci);break;case 4:if(rs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Ar(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=ft()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*LF(r/1960))-r,10<r){t.timeoutHandle=Cy(ao.bind(null,t,An,ci),r);break}ao(t,An,ci);break;case 5:ao(t,An,ci);break;default:throw Error(D(329))}}}return Ln(t,ft()),t.callbackNode===n?ek.bind(null,t):null}function Gy(t,e){var n=uc;return t.current.memoizedState.isDehydrated&&(bo(t,e).flags|=256),t=lp(t,e),t!==2&&(e=An,An=n,e!==null&&Ky(e)),t}function Ky(t){An===null?An=t:An.push.apply(An,t)}function MF(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!br(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function rs(t,e){for(e&=~pE,e&=~cm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ar(e),r=1<<n;t[n]=-1,e&=~r}}function RS(t){if(Ee&6)throw Error(D(327));rl();var e=qf(t,0);if(!(e&1))return Ln(t,ft()),null;var n=lp(t,e);if(t.tag!==0&&n===2){var r=vy(t);r!==0&&(e=r,n=Gy(t,r))}if(n===1)throw n=zc,bo(t,0),rs(t,e),Ln(t,ft()),n;if(n===6)throw Error(D(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ao(t,An,ci),Ln(t,ft()),null}function gE(t,e){var n=Ee;Ee|=1;try{return t(e)}finally{Ee=n,Ee===0&&(vl=ft()+500,om&&Gs())}}function Bo(t){as!==null&&as.tag===0&&!(Ee&6)&&rl();var e=Ee;Ee|=1;var n=ur.transition,r=Pe;try{if(ur.transition=null,Pe=1,t)return t()}finally{Pe=r,ur.transition=n,Ee=e,!(Ee&6)&&Gs()}}function _E(){Bn=Ga.current,je(Ga)}function bo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,dF(n)),yt!==null)for(n=yt.return;n!==null;){var r=n;switch(Jw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Qf();break;case 3:_l(),je(Dn),je(un),oE();break;case 5:sE(r);break;case 4:_l();break;case 13:je(Ye);break;case 19:je(Ye);break;case 10:tE(r.type._context);break;case 22:case 23:_E()}n=n.return}if(Ot=t,yt=t=vs(t.current,null),Qt=Bn=e,It=0,zc=null,pE=cm=Uo=0,An=uc=null,vo!==null){for(e=0;e<vo.length;e++)if(n=vo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}vo=null}return t}function tk(t,e){do{var n=yt;try{if(eE(),yf.current=ip,rp){for(var r=Xe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}rp=!1}if(Fo=0,bt=wt=Xe=null,ac=!1,Uc=0,fE.current=null,n===null||n.return===null){It=1,zc=e,yt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Qt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=dS(o);if(f!==null){f.flags&=-257,fS(f,o,a,s,e),f.mode&1&&hS(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){hS(s,u,e),yE();break e}l=Error(D(426))}}else if(We&&a.mode&1){var v=dS(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),fS(v,o,a,s,e),Xw(yl(l,a));break e}}s=l=yl(l,a),It!==4&&(It=2),uc===null?uc=[s]:uc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=Fb(s,l,e);iS(s,g);break e;case 1:a=l;var _=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(_s===null||!_s.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var T=Ub(s,a,e);iS(s,T);break e}}s=s.return}while(s!==null)}ik(n)}catch(b){e=b,yt===n&&n!==null&&(yt=n=n.return);continue}break}while(!0)}function nk(){var t=sp.current;return sp.current=ip,t===null?ip:t}function yE(){(It===0||It===3||It===2)&&(It=4),Ot===null||!(Uo&268435455)&&!(cm&268435455)||rs(Ot,Qt)}function lp(t,e){var n=Ee;Ee|=2;var r=nk();(Ot!==t||Qt!==e)&&(ci=null,bo(t,e));do try{VF();break}catch(i){tk(t,i)}while(!0);if(eE(),Ee=n,sp.current=r,yt!==null)throw Error(D(261));return Ot=null,Qt=0,It}function VF(){for(;yt!==null;)rk(yt)}function FF(){for(;yt!==null&&!uV();)rk(yt)}function rk(t){var e=ok(t.alternate,t,Bn);t.memoizedProps=t.pendingProps,e===null?ik(t):yt=e,fE.current=null}function ik(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=NF(n,e),n!==null){n.flags&=32767,yt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{It=6,yt=null;return}}else if(n=kF(n,e,Bn),n!==null){yt=n;return}if(e=e.sibling,e!==null){yt=e;return}yt=e=t}while(e!==null);It===0&&(It=5)}function ao(t,e,n){var r=Pe,i=ur.transition;try{ur.transition=null,Pe=1,UF(t,e,n,r)}finally{ur.transition=i,Pe=r}return null}function UF(t,e,n,r){do rl();while(as!==null);if(Ee&6)throw Error(D(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(D(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(vV(t,s),t===Ot&&(yt=Ot=null,Qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qd||(Qd=!0,ak(jf,function(){return rl(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ur.transition,ur.transition=null;var o=Pe;Pe=1;var a=Ee;Ee|=4,fE.current=null,DF(t,n),Xb(n,t),sF(Ry),Wf=!!Sy,Ry=Sy=null,t.current=n,OF(n),cV(),Ee=a,Pe=o,ur.transition=s}else t.current=n;if(Qd&&(Qd=!1,as=t,ap=i),s=t.pendingLanes,s===0&&(_s=null),fV(n.stateNode),Ln(t,ft()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(op)throw op=!1,t=Wy,Wy=null,t;return ap&1&&t.tag!==0&&rl(),s=t.pendingLanes,s&1?t===Hy?cc++:(cc=0,Hy=t):cc=0,Gs(),null}function rl(){if(as!==null){var t=VP(ap),e=ur.transition,n=Pe;try{if(ur.transition=null,Pe=16>t?16:t,as===null)var r=!1;else{if(t=as,as=null,ap=0,Ee&6)throw Error(D(331));var i=Ee;for(Ee|=4,W=t.current;W!==null;){var s=W,o=s.child;if(W.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(W=u;W!==null;){var c=W;switch(c.tag){case 0:case 11:case 15:lc(8,c,s)}var h=c.child;if(h!==null)h.return=c,W=h;else for(;W!==null;){c=W;var d=c.sibling,f=c.return;if(Qb(c),c===u){W=null;break}if(d!==null){d.return=f,W=d;break}W=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}W=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,W=o;else e:for(;W!==null;){if(s=W,s.flags&2048)switch(s.tag){case 0:case 11:case 15:lc(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,W=g;break e}W=s.return}}var _=t.current;for(W=_;W!==null;){o=W;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,W=y;else e:for(o=_;W!==null;){if(a=W,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:um(9,a)}}catch(b){it(a,a.return,b)}if(a===o){W=null;break e}var T=a.sibling;if(T!==null){T.return=a.return,W=T;break e}W=a.return}}if(Ee=i,Gs(),Jr&&typeof Jr.onPostCommitFiberRoot=="function")try{Jr.onPostCommitFiberRoot(tm,t)}catch{}r=!0}return r}finally{Pe=n,ur.transition=e}}return!1}function AS(t,e,n){e=yl(n,e),e=Fb(t,e,1),t=gs(t,e,1),e=gn(),t!==null&&(Bh(t,1,e),Ln(t,e))}function it(t,e,n){if(t.tag===3)AS(t,t,n);else for(;e!==null;){if(e.tag===3){AS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_s===null||!_s.has(r))){t=yl(n,t),t=Ub(e,t,1),e=gs(e,t,1),t=gn(),e!==null&&(Bh(e,1,t),Ln(e,t));break}}e=e.return}}function BF(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=gn(),t.pingedLanes|=t.suspendedLanes&n,Ot===t&&(Qt&n)===n&&(It===4||It===3&&(Qt&130023424)===Qt&&500>ft()-mE?bo(t,0):pE|=n),Ln(t,e)}function sk(t,e){e===0&&(t.mode&1?(e=Ud,Ud<<=1,!(Ud&130023424)&&(Ud=4194304)):e=1);var n=gn();t=Ai(t,e),t!==null&&(Bh(t,e,n),Ln(t,n))}function $F(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),sk(t,n)}function zF(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(D(314))}r!==null&&r.delete(e),sk(t,n)}var ok;ok=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dn.current)Pn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Pn=!1,bF(t,e,n);Pn=!!(t.flags&131072)}else Pn=!1,We&&e.flags&1048576&&ub(e,Xf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wf(t,e),t=e.pendingProps;var i=pl(e,un.current);nl(e,n),i=lE(null,e,r,t,i,n);var s=uE();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,On(r)?(s=!0,Yf(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,rE(e),i.updater=am,e.stateNode=i,i._reactInternals=e,Oy(e,r,t,n),e=Vy(null,e,r,!0,s,n)):(e.tag=0,We&&s&&Yw(e),dn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=qF(r),t=wr(r,t),i){case 0:e=My(null,e,r,t,n);break e;case 1:e=gS(null,e,r,t,n);break e;case 11:e=pS(null,e,r,t,n);break e;case 14:e=mS(null,e,r,wr(r.type,t),n);break e}throw Error(D(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wr(r,i),My(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wr(r,i),gS(t,e,r,i,n);case 3:e:{if(jb(e),t===null)throw Error(D(387));r=e.pendingProps,s=e.memoizedState,i=s.element,fb(t,e),tp(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=yl(Error(D(423)),e),e=_S(t,e,r,n,i);break e}else if(r!==i){i=yl(Error(D(424)),e),e=_S(t,e,r,n,i);break e}else for(jn=ms(e.stateNode.containerInfo.firstChild),Wn=e,We=!0,Tr=null,n=_b(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ml(),r===i){e=Ci(t,e,n);break e}dn(t,e,r,n)}e=e.child}return e;case 5:return yb(e),t===null&&Ny(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Ay(r,i)?o=null:s!==null&&Ay(r,s)&&(e.flags|=32),zb(t,e),dn(t,e,o,n),e.child;case 6:return t===null&&Ny(e),null;case 13:return qb(t,e,n);case 4:return iE(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=gl(e,null,r,n):dn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wr(r,i),pS(t,e,r,i,n);case 7:return dn(t,e,e.pendingProps,n),e.child;case 8:return dn(t,e,e.pendingProps.children,n),e.child;case 12:return dn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ve(Zf,r._currentValue),r._currentValue=o,s!==null)if(br(s.value,o)){if(s.children===i.children&&!Dn.current){e=Ci(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=vi(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),xy(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(D(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),xy(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}dn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,nl(e,n),i=dr(i),r=r(i),e.flags|=1,dn(t,e,r,n),e.child;case 14:return r=e.type,i=wr(r,e.pendingProps),i=wr(r.type,i),mS(t,e,r,i,n);case 15:return Bb(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wr(r,i),wf(t,e),e.tag=1,On(r)?(t=!0,Yf(e)):t=!1,nl(e,n),mb(e,r,i),Oy(e,r,i,n),Vy(null,e,r,!0,t,n);case 19:return Wb(t,e,n);case 22:return $b(t,e,n)}throw Error(D(156,e.tag))};function ak(t,e){return DP(t,e)}function jF(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sr(t,e,n,r){return new jF(t,e,n,r)}function vE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qF(t){if(typeof t=="function")return vE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Fw)return 11;if(t===Uw)return 14}return 2}function vs(t,e){var n=t.alternate;return n===null?(n=sr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Tf(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")vE(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Va:return ko(n.children,i,s,e);case Vw:o=8,i|=8;break;case iy:return t=sr(12,n,e,i|2),t.elementType=iy,t.lanes=s,t;case sy:return t=sr(13,n,e,i),t.elementType=sy,t.lanes=s,t;case oy:return t=sr(19,n,e,i),t.elementType=oy,t.lanes=s,t;case gP:return hm(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pP:o=10;break e;case mP:o=9;break e;case Fw:o=11;break e;case Uw:o=14;break e;case es:o=16,r=null;break e}throw Error(D(130,t==null?t:typeof t,""))}return e=sr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ko(t,e,n,r){return t=sr(7,t,r,e),t.lanes=n,t}function hm(t,e,n,r){return t=sr(22,t,r,e),t.elementType=gP,t.lanes=n,t.stateNode={isHidden:!1},t}function m_(t,e,n){return t=sr(6,t,null,e),t.lanes=n,t}function g_(t,e,n){return e=sr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function WF(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yg(0),this.expirationTimes=Yg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function wE(t,e,n,r,i,s,o,a,l){return t=new WF(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=sr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},rE(s),t}function HF(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ma,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function lk(t){if(!t)return Ps;t=t._reactInternals;e:{if(aa(t)!==t||t.tag!==1)throw Error(D(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(On(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(D(171))}if(t.tag===1){var n=t.type;if(On(n))return ab(t,n,e)}return e}function uk(t,e,n,r,i,s,o,a,l){return t=wE(n,r,!0,t,i,s,o,a,l),t.context=lk(null),n=t.current,r=gn(),i=ys(n),s=vi(r,i),s.callback=e??null,gs(n,s,i),t.current.lanes=i,Bh(t,i,r),Ln(t,r),t}function dm(t,e,n,r){var i=e.current,s=gn(),o=ys(i);return n=lk(n),e.context===null?e.context=n:e.pendingContext=n,e=vi(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=gs(i,e,o),t!==null&&(Cr(t,i,o,s),_f(t,i,o)),o}function up(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function CS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function EE(t,e){CS(t,e),(t=t.alternate)&&CS(t,e)}function GF(){return null}var ck=typeof reportError=="function"?reportError:function(t){console.error(t)};function IE(t){this._internalRoot=t}fm.prototype.render=IE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(D(409));dm(t,e,null,null)};fm.prototype.unmount=IE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Bo(function(){dm(null,t,null,null)}),e[Ri]=null}};function fm(t){this._internalRoot=t}fm.prototype.unstable_scheduleHydration=function(t){if(t){var e=BP();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ns.length&&e!==0&&e<ns[n].priority;n++);ns.splice(n,0,t),n===0&&zP(t)}};function TE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function pm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function PS(){}function KF(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=up(o);s.call(u)}}var o=uk(e,r,t,0,null,!1,!1,"",PS);return t._reactRootContainer=o,t[Ri]=o.current,Oc(t.nodeType===8?t.parentNode:t),Bo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=up(l);a.call(u)}}var l=wE(t,0,!1,null,null,!1,!1,"",PS);return t._reactRootContainer=l,t[Ri]=l.current,Oc(t.nodeType===8?t.parentNode:t),Bo(function(){dm(e,l,n,r)}),l}function mm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=up(o);a.call(l)}}dm(e,o,t,i)}else o=KF(n,e,t,i,r);return up(o)}FP=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Gu(e.pendingLanes);n!==0&&(zw(e,n|1),Ln(e,ft()),!(Ee&6)&&(vl=ft()+500,Gs()))}break;case 13:Bo(function(){var r=Ai(t,1);if(r!==null){var i=gn();Cr(r,t,1,i)}}),EE(t,1)}};jw=function(t){if(t.tag===13){var e=Ai(t,134217728);if(e!==null){var n=gn();Cr(e,t,134217728,n)}EE(t,134217728)}};UP=function(t){if(t.tag===13){var e=ys(t),n=Ai(t,e);if(n!==null){var r=gn();Cr(n,t,e,r)}EE(t,e)}};BP=function(){return Pe};$P=function(t,e){var n=Pe;try{return Pe=t,e()}finally{Pe=n}};gy=function(t,e,n){switch(e){case"input":if(uy(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=sm(r);if(!i)throw Error(D(90));yP(r),uy(r,i)}}}break;case"textarea":wP(t,n);break;case"select":e=n.value,e!=null&&Xa(t,!!n.multiple,e,!1)}};CP=gE;PP=Bo;var QF={usingClientEntryPoint:!1,Events:[zh,$a,sm,RP,AP,gE]},Su={findFiberByHostInstance:yo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},YF={bundleType:Su.bundleType,version:Su.version,rendererPackageName:Su.rendererPackageName,rendererConfig:Su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Di.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=NP(t),t===null?null:t.stateNode},findFiberByHostInstance:Su.findFiberByHostInstance||GF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yd.isDisabled&&Yd.supportsFiber)try{tm=Yd.inject(YF),Jr=Yd}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QF;Jn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!TE(e))throw Error(D(200));return HF(t,e,null,n)};Jn.createRoot=function(t,e){if(!TE(t))throw Error(D(299));var n=!1,r="",i=ck;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=wE(t,1,!1,null,null,n,!1,r,i),t[Ri]=e.current,Oc(t.nodeType===8?t.parentNode:t),new IE(e)};Jn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(D(188)):(t=Object.keys(t).join(","),Error(D(268,t)));return t=NP(e),t=t===null?null:t.stateNode,t};Jn.flushSync=function(t){return Bo(t)};Jn.hydrate=function(t,e,n){if(!pm(e))throw Error(D(200));return mm(null,t,e,!0,n)};Jn.hydrateRoot=function(t,e,n){if(!TE(t))throw Error(D(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=ck;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=uk(e,null,t,1,n??null,i,!1,s,o),t[Ri]=e.current,Oc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new fm(e)};Jn.render=function(t,e,n){if(!pm(e))throw Error(D(200));return mm(null,t,e,!1,n)};Jn.unmountComponentAtNode=function(t){if(!pm(t))throw Error(D(40));return t._reactRootContainer?(Bo(function(){mm(null,null,t,!1,function(){t._reactRootContainer=null,t[Ri]=null})}),!0):!1};Jn.unstable_batchedUpdates=gE;Jn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!pm(n))throw Error(D(200));if(t==null||t._reactInternals===void 0)throw Error(D(38));return mm(t,e,n,!1,r)};Jn.version="18.2.0-next-9e3b772b8-20220608";function hk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hk)}catch(t){console.error(t)}}hk(),uP.exports=Jn;var SE=uP.exports;const dk=$l(SE),JF=eP({__proto__:null,default:dk},[SE]);var bS=SE;ny.createRoot=bS.createRoot,ny.hydrateRoot=bS.hydrateRoot;const Hi="f2fbf25cb3af33f477d320640e0c47b6",rn={fetchTrending:`/trending/all/week?api_key=${Hi}&language=en-US`,fetchNetflixOriginals:`/discover/tv?api_key=${Hi}&with_networks=213`,fetchTopRated:`/movie/top_rated?api_key=${Hi}&language=en-US&page=1`,fetchActionMovies:`/discover/movie?api_key=${Hi}&with_genres=28`,fetchComedyMovies:`/discover/movie?api_key=${Hi}&with_genres=35`,fetchHorrorMovies:`/discover/movie?api_key=${Hi}&with_genres=27`,fetchRomanceMovies:`/discover/movie?api_key=${Hi}&with_genres=10749`,fetchDocumentaries:`/discover/movie?api_key=${Hi}&with_genres=99`},XF=[{id:"req_1",title:"NETFLIX ORIGINALS",URL:rn.fetchNetflixOriginals},{id:"req_2",title:"Trending Now",URL:rn.fetchTrending},{id:"req_3",title:"Top Rated",URL:rn.fetchTopRated},{id:"req_4",title:"Action Movies",URL:rn.fetchActionMovies},{id:"req_5",title:"Comedy Movies",URL:rn.fetchComedyMovies},{id:"req_6",title:"Horror Movies",URL:rn.fetchHorrorMovies},{id:"req_7",title:"Romance Movies",URL:rn.fetchRomanceMovies},{id:"req_8",title:"Documentaries",URL:rn.fetchDocumentaries}];function fk(t,e){return function(){return t.apply(e,arguments)}}const{toString:ZF}=Object.prototype,{getPrototypeOf:RE}=Object,gm=(t=>e=>{const n=ZF.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ai=t=>(t=t.toLowerCase(),e=>gm(e)===t),_m=t=>e=>typeof e===t,{isArray:Wl}=Array,jc=_m("undefined");function eU(t){return t!==null&&!jc(t)&&t.constructor!==null&&!jc(t.constructor)&&cr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const pk=ai("ArrayBuffer");function tU(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&pk(t.buffer),e}const nU=_m("string"),cr=_m("function"),mk=_m("number"),ym=t=>t!==null&&typeof t=="object",rU=t=>t===!0||t===!1,Sf=t=>{if(gm(t)!=="object")return!1;const e=RE(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},iU=ai("Date"),sU=ai("File"),oU=ai("Blob"),aU=ai("FileList"),lU=t=>ym(t)&&cr(t.pipe),uU=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||cr(t.append)&&((e=gm(t))==="formdata"||e==="object"&&cr(t.toString)&&t.toString()==="[object FormData]"))},cU=ai("URLSearchParams"),hU=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function qh(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Wl(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,t[a],a,t)}}function gk(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const _k=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,yk=t=>!jc(t)&&t!==_k;function Qy(){const{caseless:t}=yk(this)&&this||{},e={},n=(r,i)=>{const s=t&&gk(e,i)||i;Sf(e[s])&&Sf(r)?e[s]=Qy(e[s],r):Sf(r)?e[s]=Qy({},r):Wl(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&qh(arguments[r],n);return e}const dU=(t,e,n,{allOwnKeys:r}={})=>(qh(e,(i,s)=>{n&&cr(i)?t[s]=fk(i,n):t[s]=i},{allOwnKeys:r}),t),fU=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),pU=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},mU=(t,e,n,r)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!r||r(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&RE(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},gU=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},_U=t=>{if(!t)return null;if(Wl(t))return t;let e=t.length;if(!mk(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},yU=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&RE(Uint8Array)),vU=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},wU=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},EU=ai("HTMLFormElement"),IU=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),kS=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),TU=ai("RegExp"),vk=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};qh(n,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(r[s]=o||i)}),Object.defineProperties(t,r)},SU=t=>{vk(t,(e,n)=>{if(cr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(cr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},RU=(t,e)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return Wl(t)?r(t):r(String(t).split(e)),n},AU=()=>{},CU=(t,e)=>(t=+t,Number.isFinite(t)?t:e),__="abcdefghijklmnopqrstuvwxyz",NS="0123456789",wk={DIGIT:NS,ALPHA:__,ALPHA_DIGIT:__+__.toUpperCase()+NS},PU=(t=16,e=wk.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function bU(t){return!!(t&&cr(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const kU=t=>{const e=new Array(10),n=(r,i)=>{if(ym(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const s=Wl(r)?[]:{};return qh(r,(o,a)=>{const l=n(o,i+1);!jc(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return n(t,0)},NU=ai("AsyncFunction"),xU=t=>t&&(ym(t)||cr(t))&&cr(t.then)&&cr(t.catch),P={isArray:Wl,isArrayBuffer:pk,isBuffer:eU,isFormData:uU,isArrayBufferView:tU,isString:nU,isNumber:mk,isBoolean:rU,isObject:ym,isPlainObject:Sf,isUndefined:jc,isDate:iU,isFile:sU,isBlob:oU,isRegExp:TU,isFunction:cr,isStream:lU,isURLSearchParams:cU,isTypedArray:yU,isFileList:aU,forEach:qh,merge:Qy,extend:dU,trim:hU,stripBOM:fU,inherits:pU,toFlatObject:mU,kindOf:gm,kindOfTest:ai,endsWith:gU,toArray:_U,forEachEntry:vU,matchAll:wU,isHTMLForm:EU,hasOwnProperty:kS,hasOwnProp:kS,reduceDescriptors:vk,freezeMethods:SU,toObjectSet:RU,toCamelCase:IU,noop:AU,toFiniteNumber:CU,findKey:gk,global:_k,isContextDefined:yk,ALPHABET:wk,generateString:PU,isSpecCompliantForm:bU,toJSONObject:kU,isAsyncFn:NU,isThenable:xU};function ve(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}P.inherits(ve,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:P.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Ek=ve.prototype,Ik={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Ik[t]={value:t}});Object.defineProperties(ve,Ik);Object.defineProperty(Ek,"isAxiosError",{value:!0});ve.from=(t,e,n,r,i,s)=>{const o=Object.create(Ek);return P.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),ve.call(o,t.message,e,n,r,i),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const DU=null;function Yy(t){return P.isPlainObject(t)||P.isArray(t)}function Tk(t){return P.endsWith(t,"[]")?t.slice(0,-2):t}function xS(t,e,n){return t?t.concat(e).map(function(i,s){return i=Tk(i),!n&&s?"["+i+"]":i}).join(n?".":""):e}function OU(t){return P.isArray(t)&&!t.some(Yy)}const LU=P.toFlatObject(P,{},null,function(e){return/^is[A-Z]/.test(e)});function vm(t,e,n){if(!P.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=P.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,v){return!P.isUndefined(v[m])});const r=n.metaTokens,i=n.visitor||c,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&P.isSpecCompliantForm(e);if(!P.isFunction(i))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(P.isDate(p))return p.toISOString();if(!l&&P.isBlob(p))throw new ve("Blob is not supported. Use a Buffer instead.");return P.isArrayBuffer(p)||P.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function c(p,m,v){let g=p;if(p&&!v&&typeof p=="object"){if(P.endsWith(m,"{}"))m=r?m:m.slice(0,-2),p=JSON.stringify(p);else if(P.isArray(p)&&OU(p)||(P.isFileList(p)||P.endsWith(m,"[]"))&&(g=P.toArray(p)))return m=Tk(m),g.forEach(function(y,T){!(P.isUndefined(y)||y===null)&&e.append(o===!0?xS([m],T,s):o===null?m:m+"[]",u(y))}),!1}return Yy(p)?!0:(e.append(xS(v,m,s),u(p)),!1)}const h=[],d=Object.assign(LU,{defaultVisitor:c,convertValue:u,isVisitable:Yy});function f(p,m){if(!P.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(p),P.forEach(p,function(g,_){(!(P.isUndefined(g)||g===null)&&i.call(e,g,P.isString(_)?_.trim():_,m,d))===!0&&f(g,m?m.concat(_):[_])}),h.pop()}}if(!P.isObject(t))throw new TypeError("data must be an object");return f(t),e}function DS(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function AE(t,e){this._pairs=[],t&&vm(t,this,e)}const Sk=AE.prototype;Sk.append=function(e,n){this._pairs.push([e,n])};Sk.toString=function(e){const n=e?function(r){return e.call(this,r,DS)}:DS;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function MU(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Rk(t,e,n){if(!e)return t;const r=n&&n.encode||MU,i=n&&n.serialize;let s;if(i?s=i(e,n):s=P.isURLSearchParams(e)?e.toString():new AE(e,n).toString(r),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class VU{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){P.forEach(this.handlers,function(r){r!==null&&e(r)})}}const OS=VU,Ak={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},FU=typeof URLSearchParams<"u"?URLSearchParams:AE,UU=typeof FormData<"u"?FormData:null,BU=typeof Blob<"u"?Blob:null,$U={isBrowser:!0,classes:{URLSearchParams:FU,FormData:UU,Blob:BU},protocols:["http","https","file","blob","url","data"]},Ck=typeof window<"u"&&typeof document<"u",zU=(t=>Ck&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),jU=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",qU=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ck,hasStandardBrowserEnv:zU,hasStandardBrowserWebWorkerEnv:jU},Symbol.toStringTag,{value:"Module"})),Wr={...qU,...$U};function WU(t,e){return vm(t,new Wr.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return Wr.isNode&&P.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function HU(t){return P.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function GU(t){const e={},n=Object.keys(t);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],e[s]=t[s];return e}function Pk(t){function e(n,r,i,s){let o=n[s++];const a=Number.isFinite(+o),l=s>=n.length;return o=!o&&P.isArray(i)?i.length:o,l?(P.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!P.isObject(i[o]))&&(i[o]=[]),e(n,r,i[o],s)&&P.isArray(i[o])&&(i[o]=GU(i[o])),!a)}if(P.isFormData(t)&&P.isFunction(t.entries)){const n={};return P.forEachEntry(t,(r,i)=>{e(HU(r),i,n,0)}),n}return null}function KU(t,e,n){if(P.isString(t))try{return(e||JSON.parse)(t),P.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const CE={transitional:Ak,adapter:["xhr","http"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=P.isObject(e);if(s&&P.isHTMLForm(e)&&(e=new FormData(e)),P.isFormData(e))return i&&i?JSON.stringify(Pk(e)):e;if(P.isArrayBuffer(e)||P.isBuffer(e)||P.isStream(e)||P.isFile(e)||P.isBlob(e))return e;if(P.isArrayBufferView(e))return e.buffer;if(P.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return WU(e,this.formSerializer).toString();if((a=P.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return vm(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),KU(e)):e}],transformResponse:[function(e){const n=this.transitional||CE.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(e&&P.isString(e)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?ve.from(a,ve.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Wr.classes.FormData,Blob:Wr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};P.forEach(["delete","get","head","post","put","patch"],t=>{CE.headers[t]={}});const PE=CE,QU=P.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),YU=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||e[n]&&QU[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},LS=Symbol("internals");function Ru(t){return t&&String(t).trim().toLowerCase()}function Rf(t){return t===!1||t==null?t:P.isArray(t)?t.map(Rf):String(t)}function JU(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const XU=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function y_(t,e,n,r,i){if(P.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!P.isString(e)){if(P.isString(r))return e.indexOf(r)!==-1;if(P.isRegExp(r))return r.test(e)}}function ZU(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function eB(t,e){const n=P.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}class wm{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function s(a,l,u){const c=Ru(l);if(!c)throw new Error("header name must be a non-empty string");const h=P.findKey(i,c);(!h||i[h]===void 0||u===!0||u===void 0&&i[h]!==!1)&&(i[h||l]=Rf(a))}const o=(a,l)=>P.forEach(a,(u,c)=>s(u,c,l));return P.isPlainObject(e)||e instanceof this.constructor?o(e,n):P.isString(e)&&(e=e.trim())&&!XU(e)?o(YU(e),n):e!=null&&s(n,e,r),this}get(e,n){if(e=Ru(e),e){const r=P.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return JU(i);if(P.isFunction(n))return n.call(this,i,r);if(P.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Ru(e),e){const r=P.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||y_(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function s(o){if(o=Ru(o),o){const a=P.findKey(r,o);a&&(!n||y_(r,r[a],a,n))&&(delete r[a],i=!0)}}return P.isArray(e)?e.forEach(s):s(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!e||y_(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const n=this,r={};return P.forEach(this,(i,s)=>{const o=P.findKey(r,s);if(o){n[o]=Rf(i),delete n[s];return}const a=e?ZU(s):String(s).trim();a!==s&&delete n[s],n[a]=Rf(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return P.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&P.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[LS]=this[LS]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=Ru(o);r[a]||(eB(i,o),r[a]=!0)}return P.isArray(e)?e.forEach(s):s(e),this}}wm.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);P.reduceDescriptors(wm.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});P.freezeMethods(wm);const wi=wm;function v_(t,e){const n=this||PE,r=e||n,i=wi.from(r.headers);let s=r.data;return P.forEach(t,function(a){s=a.call(n,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function bk(t){return!!(t&&t.__CANCEL__)}function Wh(t,e,n){ve.call(this,t??"canceled",ve.ERR_CANCELED,e,n),this.name="CanceledError"}P.inherits(Wh,ve,{__CANCEL__:!0});function tB(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new ve("Request failed with status code "+n.status,[ve.ERR_BAD_REQUEST,ve.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const nB=Wr.hasStandardBrowserEnv?{write(t,e,n,r,i,s){const o=[t+"="+encodeURIComponent(e)];P.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),P.isString(r)&&o.push("path="+r),P.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function rB(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function iB(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function kk(t,e){return t&&!rB(e)?iB(t,e):e}const sB=Wr.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function i(s){let o=s;return e&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=i(window.location.href),function(o){const a=P.isString(o)?i(o):o;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function oB(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function aB(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=r[s];o||(o=u),n[i]=l,r[i]=u;let h=s,d=0;for(;h!==i;)d+=n[h++],h=h%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),u-o<e)return;const f=c&&u-c;return f?Math.round(d*1e3/f):void 0}}function MS(t,e){let n=0;const r=aB(50,250);return i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,a=s-n,l=r(a),u=s<=o;n=s;const c={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&u?(o-s)/l:void 0,event:i};c[e?"download":"upload"]=!0,t(c)}}const lB=typeof XMLHttpRequest<"u",uB=lB&&function(t){return new Promise(function(n,r){let i=t.data;const s=wi.from(t.headers).normalize();let{responseType:o,withXSRFToken:a}=t,l;function u(){t.cancelToken&&t.cancelToken.unsubscribe(l),t.signal&&t.signal.removeEventListener("abort",l)}let c;if(P.isFormData(i)){if(Wr.hasStandardBrowserEnv||Wr.hasStandardBrowserWebWorkerEnv)s.setContentType(!1);else if((c=s.getContentType())!==!1){const[m,...v]=c?c.split(";").map(g=>g.trim()).filter(Boolean):[];s.setContentType([m||"multipart/form-data",...v].join("; "))}}let h=new XMLHttpRequest;if(t.auth){const m=t.auth.username||"",v=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(m+":"+v))}const d=kk(t.baseURL,t.url);h.open(t.method.toUpperCase(),Rk(d,t.params,t.paramsSerializer),!0),h.timeout=t.timeout;function f(){if(!h)return;const m=wi.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),g={data:!o||o==="text"||o==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:m,config:t,request:h};tB(function(y){n(y),u()},function(y){r(y),u()},g),h=null}if("onloadend"in h?h.onloadend=f:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(f)},h.onabort=function(){h&&(r(new ve("Request aborted",ve.ECONNABORTED,t,h)),h=null)},h.onerror=function(){r(new ve("Network Error",ve.ERR_NETWORK,t,h)),h=null},h.ontimeout=function(){let v=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const g=t.transitional||Ak;t.timeoutErrorMessage&&(v=t.timeoutErrorMessage),r(new ve(v,g.clarifyTimeoutError?ve.ETIMEDOUT:ve.ECONNABORTED,t,h)),h=null},Wr.hasStandardBrowserEnv&&(a&&P.isFunction(a)&&(a=a(t)),a||a!==!1&&sB(d))){const m=t.xsrfHeaderName&&t.xsrfCookieName&&nB.read(t.xsrfCookieName);m&&s.set(t.xsrfHeaderName,m)}i===void 0&&s.setContentType(null),"setRequestHeader"in h&&P.forEach(s.toJSON(),function(v,g){h.setRequestHeader(g,v)}),P.isUndefined(t.withCredentials)||(h.withCredentials=!!t.withCredentials),o&&o!=="json"&&(h.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&h.addEventListener("progress",MS(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&h.upload&&h.upload.addEventListener("progress",MS(t.onUploadProgress)),(t.cancelToken||t.signal)&&(l=m=>{h&&(r(!m||m.type?new Wh(null,t,h):m),h.abort(),h=null)},t.cancelToken&&t.cancelToken.subscribe(l),t.signal&&(t.signal.aborted?l():t.signal.addEventListener("abort",l)));const p=oB(d);if(p&&Wr.protocols.indexOf(p)===-1){r(new ve("Unsupported protocol "+p+":",ve.ERR_BAD_REQUEST,t));return}h.send(i||null)})},Jy={http:DU,xhr:uB};P.forEach(Jy,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const VS=t=>`- ${t}`,cB=t=>P.isFunction(t)||t===null||t===!1,Nk={getAdapter:t=>{t=P.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let s=0;s<e;s++){n=t[s];let o;if(r=n,!cB(n)&&(r=Jy[(o=String(n)).toLowerCase()],r===void 0))throw new ve(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(VS).join(`
`):" "+VS(s[0]):"as no adapter specified";throw new ve("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Jy};function w_(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Wh(null,t)}function FS(t){return w_(t),t.headers=wi.from(t.headers),t.data=v_.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Nk.getAdapter(t.adapter||PE.adapter)(t).then(function(r){return w_(t),r.data=v_.call(t,t.transformResponse,r),r.headers=wi.from(r.headers),r},function(r){return bk(r)||(w_(t),r&&r.response&&(r.response.data=v_.call(t,t.transformResponse,r.response),r.response.headers=wi.from(r.response.headers))),Promise.reject(r)})}const US=t=>t instanceof wi?t.toJSON():t;function wl(t,e){e=e||{};const n={};function r(u,c,h){return P.isPlainObject(u)&&P.isPlainObject(c)?P.merge.call({caseless:h},u,c):P.isPlainObject(c)?P.merge({},c):P.isArray(c)?c.slice():c}function i(u,c,h){if(P.isUndefined(c)){if(!P.isUndefined(u))return r(void 0,u,h)}else return r(u,c,h)}function s(u,c){if(!P.isUndefined(c))return r(void 0,c)}function o(u,c){if(P.isUndefined(c)){if(!P.isUndefined(u))return r(void 0,u)}else return r(void 0,c)}function a(u,c,h){if(h in e)return r(u,c);if(h in t)return r(void 0,u)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,c)=>i(US(u),US(c),!0)};return P.forEach(Object.keys(Object.assign({},t,e)),function(c){const h=l[c]||i,d=h(t[c],e[c],c);P.isUndefined(d)&&h!==a||(n[c]=d)}),n}const xk="1.6.2",bE={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{bE[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const BS={};bE.transitional=function(e,n,r){function i(s,o){return"[Axios v"+xk+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new ve(i(o," has been removed"+(n?" in "+n:"")),ve.ERR_DEPRECATED);return n&&!BS[o]&&(BS[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,o,a):!0}};function hB(t,e,n){if(typeof t!="object")throw new ve("options must be an object",ve.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new ve("option "+s+" must be "+l,ve.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ve("Unknown option "+s,ve.ERR_BAD_OPTION)}}const Xy={assertOptions:hB,validators:bE},Gi=Xy.validators;class cp{constructor(e){this.defaults=e,this.interceptors={request:new OS,response:new OS}}request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=wl(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&Xy.assertOptions(r,{silentJSONParsing:Gi.transitional(Gi.boolean),forcedJSONParsing:Gi.transitional(Gi.boolean),clarifyTimeoutError:Gi.transitional(Gi.boolean)},!1),i!=null&&(P.isFunction(i)?n.paramsSerializer={serialize:i}:Xy.assertOptions(i,{encode:Gi.function,serialize:Gi.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&P.merge(s.common,s[n.method]);s&&P.forEach(["delete","get","head","post","put","patch","common"],p=>{delete s[p]}),n.headers=wi.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let c,h=0,d;if(!l){const p=[FS.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,u),d=p.length,c=Promise.resolve(n);h<d;)c=c.then(p[h++],p[h++]);return c}d=a.length;let f=n;for(h=0;h<d;){const p=a[h++],m=a[h++];try{f=p(f)}catch(v){m.call(this,v);break}}try{c=FS.call(this,f)}catch(p){return Promise.reject(p)}for(h=0,d=u.length;h<d;)c=c.then(u[h++],u[h++]);return c}getUri(e){e=wl(this.defaults,e);const n=kk(e.baseURL,e.url);return Rk(n,e.params,e.paramsSerializer)}}P.forEach(["delete","get","head","options"],function(e){cp.prototype[e]=function(n,r){return this.request(wl(r||{},{method:e,url:n,data:(r||{}).data}))}});P.forEach(["post","put","patch"],function(e){function n(r){return function(s,o,a){return this.request(wl(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}cp.prototype[e]=n(),cp.prototype[e+"Form"]=n(!0)});const Af=cp;class kE{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new Wh(s,o,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new kE(function(i){e=i}),cancel:e}}}const dB=kE;function fB(t){return function(n){return t.apply(null,n)}}function pB(t){return P.isObject(t)&&t.isAxiosError===!0}const Zy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Zy).forEach(([t,e])=>{Zy[e]=t});const mB=Zy;function Dk(t){const e=new Af(t),n=fk(Af.prototype.request,e);return P.extend(n,Af.prototype,e,{allOwnKeys:!0}),P.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return Dk(wl(t,i))},n}const vt=Dk(PE);vt.Axios=Af;vt.CanceledError=Wh;vt.CancelToken=dB;vt.isCancel=bk;vt.VERSION=xk;vt.toFormData=vm;vt.AxiosError=ve;vt.Cancel=vt.CanceledError;vt.all=function(e){return Promise.all(e)};vt.spread=fB;vt.isAxiosError=pB;vt.mergeConfig=wl;vt.AxiosHeaders=wi;vt.formToJSON=t=>Pk(P.isHTMLForm(t)?new FormData(t):t);vt.getAdapter=Nk.getAdapter;vt.HttpStatusCode=mB;vt.default=vt;const gB=vt,Ok=gB.create({baseURL:"https://api.themoviedb.org/3"});function $S(t){Promise.resolve().then(t).catch(function(e){return setTimeout(function(){throw e})})}var _B=function(){function t(){this.queue=[],this.transactions=0,this.notifyFn=function(n){n()},this.batchNotifyFn=function(n){n()}}var e=t.prototype;return e.batch=function(r){var i;this.transactions++;try{i=r()}finally{this.transactions--,this.transactions||this.flush()}return i},e.schedule=function(r){var i=this;this.transactions?this.queue.push(r):$S(function(){i.notifyFn(r)})},e.batchCalls=function(r){var i=this;return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];i.schedule(function(){r.apply(void 0,o)})}},e.flush=function(){var r=this,i=this.queue;this.queue=[],i.length&&$S(function(){r.batchNotifyFn(function(){i.forEach(function(s){r.notifyFn(s)})})})},e.setNotifyFunction=function(r){this.notifyFn=r},e.setBatchNotifyFunction=function(r){this.batchNotifyFn=r},t}(),yB=new _B,vB=dk.unstable_batchedUpdates;yB.setBatchNotifyFunction(vB);const wB=()=>{const[t,e]=M.useState("");M.useState();const n=XF[0].URL;console.log(t),M.useEffect(()=>{(async()=>{const s=await Ok.get(n);console.log(s),e(s.data.results[Math.floor(Math.random()*s.data.results.length-1)])})()},[]);const r=(i,s)=>(i==null?void 0:i.length)>150?i.substr(0,s-1)+"  ....":i;return j.createElement("header",{className:"h-[450px] sm:h-[500px] sml:h-[535px] bg-[image:var(--image-pp-url)] md:bg-[image:var(--image-bp-url)] bg-cover bg-center sml:bg-top object-cover object-top text-gray-100 flex flex-col justify-end",style:{"--image-bp-url":`url("https://image.tmdb.org/t/p/original/${t==null?void 0:t.backdrop_path}")`,"--image-pp-url":`url("https://image.tmdb.org/t/p/original/${t==null?void 0:t.poster_path}")`}},j.createElement("div",{className:" flex flex-col justify-end items-start h-[400px] max-sm:h-[300px]   min-w-full text-white text-lg"},j.createElement("h1",{className:"   font-bold text-4xl   ml-[50px] pb-[10px]   max-sm:pb-[10px]"},(t==null?void 0:t.name)||(t==null?void 0:t.original_name)),j.createElement("div",{className:"flex pt-[10px] "},j.createElement("button",{className:" flex text-center hover:bg-black  hover:text-white animate-bounce  ease-in text-md items-center rounded-md h-[30px] max-sm:h-[25px]  ml-[50px]  max-sm:pl-[10px] bg-white text-black font-semibold px-3 py-[1px] max-sm:px-3 max-sm:py-2 shadow-lg"},"Play"),j.createElement("button",{className:"flex text-center text-md  hover:bg-black  hover:text-white items-center rounded-md h-[30px] max-sm:h-[25px] ml-[30px] max-sm:ml-[20px] bg-white text-black font-semibold px-3 py-2 max-sm:px-3 max-sm:py-2 shadow-lg"},"next")),j.createElement("p",{className:"pt-[30px] max-w-[500px] ml-[50px] "},r(t==null?void 0:t.overview,150))),j.createElement("div",{className:"w-full h-[80px] bg-gradient-to-b from-transparent to-black"}))};/**
 * @remix-run/router v1.14.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function st(){return st=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},st.apply(this,arguments)}var dt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(dt||(dt={}));const zS="popstate";function EB(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return qc("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Hh(i)}return TB(e,n,null,t)}function pe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function $o(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IB(){return Math.random().toString(36).substr(2,8)}function jS(t,e){return{usr:t.state,key:t.key,idx:e}}function qc(t,e,n,r){return n===void 0&&(n=null),st({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Oi(e):e,{state:n,key:e&&e.key||r||IB()})}function Hh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Oi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function TB(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=dt.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(st({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=dt.Pop;let v=c(),g=v==null?null:v-u;u=v,l&&l({action:a,location:m.location,delta:g})}function d(v,g){a=dt.Push;let _=qc(m.location,v,g);n&&n(_,v),u=c()+1;let y=jS(_,u),T=m.createHref(_);try{o.pushState(y,"",T)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;i.location.assign(T)}s&&l&&l({action:a,location:m.location,delta:1})}function f(v,g){a=dt.Replace;let _=qc(m.location,v,g);n&&n(_,v),u=c();let y=jS(_,u),T=m.createHref(_);o.replaceState(y,"",T),s&&l&&l({action:a,location:m.location,delta:0})}function p(v){let g=i.location.origin!=="null"?i.location.origin:i.location.href,_=typeof v=="string"?v:Hh(v);return pe(g,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,g)}let m={get action(){return a},get location(){return t(i,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(zS,h),l=v,()=>{i.removeEventListener(zS,h),l=null}},createHref(v){return e(i,v)},createURL:p,encodeLocation(v){let g=p(v);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:d,replace:f,go(v){return o.go(v)}};return m}var rt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(rt||(rt={}));const SB=new Set(["lazy","caseSensitive","path","id","index","children"]);function RB(t){return t.index===!0}function ev(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,s)=>{let o=[...n,s],a=typeof i.id=="string"?i.id:o.join("-");if(pe(i.index!==!0||!i.children,"Cannot specify children on an index route"),pe(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),RB(i)){let l=st({},i,e(i),{id:a});return r[a]=l,l}else{let l=st({},i,e(i),{id:a,children:void 0});return r[a]=l,i.children&&(l.children=ev(i.children,e,o,r)),l}})}function Ka(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Oi(e):e,i=Gh(r.pathname||"/",n);if(i==null)return null;let s=Lk(t);CB(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=MB(s[a],UB(i));return o}function AB(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function Lk(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(pe(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=ws([r,l.relativePath]),c=n.concat(l);s.children&&s.children.length>0&&(pe(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Lk(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:OB(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of Mk(s.path))i(s,o,l)}),e}function Mk(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=Mk(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function CB(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:LB(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const PB=/^:\w+$/,bB=3,kB=2,NB=1,xB=10,DB=-2,qS=t=>t==="*";function OB(t,e){let n=t.split("/"),r=n.length;return n.some(qS)&&(r+=DB),e&&(r+=kB),n.filter(i=>!qS(i)).reduce((i,s)=>i+(PB.test(s)?bB:s===""?NB:xB),r)}function LB(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function MB(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let o=0;o<n.length;++o){let a=n[o],l=o===n.length-1,u=i==="/"?e:e.slice(i.length)||"/",c=VB({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);let h=a.route;s.push({params:r,pathname:ws([i,c.pathname]),pathnameBase:jB(ws([i,c.pathnameBase])),route:h}),c.pathnameBase!=="/"&&(i=ws([i,c.pathnameBase]))}return s}function VB(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=FB(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let m=a[h]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[h];return f&&!p?u[d]=void 0:u[d]=BB(p||"",d),u},{}),pathname:s,pathnameBase:o,pattern:t}}function FB(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),$o(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function UB(t){try{return decodeURI(t)}catch(e){return $o(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function BB(t,e){try{return decodeURIComponent(t)}catch(n){return $o(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Gh(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function $B(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Oi(t):t;return{pathname:n?n.startsWith("/")?n:zB(n,e):e,search:qB(r),hash:WB(i)}}function zB(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function E_(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Vk(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Fk(t,e){let n=Vk(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Uk(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Oi(t):(i=st({},t),pe(!i.pathname||!i.pathname.includes("?"),E_("?","pathname","search",i)),pe(!i.pathname||!i.pathname.includes("#"),E_("#","pathname","hash",i)),pe(!i.search||!i.search.includes("#"),E_("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=$B(i,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const ws=t=>t.join("/").replace(/\/\/+/g,"/"),jB=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),qB=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,WB=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class NE{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Bk(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const $k=["post","put","patch","delete"],HB=new Set($k),GB=["get",...$k],KB=new Set(GB),QB=new Set([301,302,303,307,308]),YB=new Set([307,308]),I_={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},JB={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Au={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},zk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,XB=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),jk="remix-router-transitions";function ZB(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;pe(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let E=t.detectErrorBoundary;i=S=>({hasErrorBoundary:E(S)})}else i=XB;let s={},o=ev(t.routes,i,void 0,s),a,l=t.basename||"/",u=st({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},t.future),c=null,h=new Set,d=null,f=null,p=null,m=t.hydrationData!=null,v=Ka(o,t.history.location,l),g=null;if(v==null){let E=er(404,{pathname:t.history.location.pathname}),{matches:S,route:C}=XS(o);v=S,g={[C.id]:E}}let _,y=v.some(E=>E.route.lazy),T=v.some(E=>E.route.loader);if(y)_=!1;else if(!T)_=!0;else if(u.v7_partialHydration){let E=t.hydrationData?t.hydrationData.loaderData:null,S=t.hydrationData?t.hydrationData.errors:null;_=v.every(C=>C.route.loader&&C.route.loader.hydrate!==!0&&(E&&E[C.route.id]!==void 0||S&&S[C.route.id]!==void 0))}else _=t.hydrationData!=null;let b,w={historyAction:t.history.action,location:t.history.location,matches:v,initialized:_,navigation:I_,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||g,fetchers:new Map,blockers:new Map},A=dt.Pop,x=!1,$,G=!1,oe=new Map,Re=null,ke=!1,Tn=!1,li=[],gr=[],Oe=new Map,z=0,Z=-1,te=new Map,Se=new Set,Ue=new Map,Or=new Map,$t=new Set,_r=new Map,cn=new Map,$i=!1;function gM(){if(c=t.history.listen(E=>{let{action:S,location:C,delta:F}=E;if($i){$i=!1;return}$o(cn.size===0||F!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let K=y0({currentLocation:w.location,nextLocation:C,historyAction:S});if(K&&F!=null){$i=!0,t.history.go(F*-1),Nd(K,{state:"blocked",location:C,proceed(){Nd(K,{state:"proceeding",proceed:void 0,reset:void 0,location:C}),t.history.go(F)},reset(){let he=new Map(w.blockers);he.set(K,Au),Un({blockers:he})}});return}return ro(S,C)}),n){c2(e,oe);let E=()=>h2(e,oe);e.addEventListener("pagehide",E),Re=()=>e.removeEventListener("pagehide",E)}return w.initialized||ro(dt.Pop,w.location,{initialHydration:!0}),b}function _M(){c&&c(),Re&&Re(),h.clear(),$&&$.abort(),w.fetchers.forEach((E,S)=>kd(S)),w.blockers.forEach((E,S)=>_0(S))}function yM(E){return h.add(E),()=>h.delete(E)}function Un(E,S){S===void 0&&(S={}),w=st({},w,E);let C=[],F=[];u.v7_fetcherPersist&&w.fetchers.forEach((K,he)=>{K.state==="idle"&&($t.has(he)?F.push(he):C.push(he))}),[...h].forEach(K=>K(w,{deletedFetchers:F,unstable_viewTransitionOpts:S.viewTransitionOpts,unstable_flushSync:S.flushSync===!0})),u.v7_fetcherPersist&&(C.forEach(K=>w.fetchers.delete(K)),F.forEach(K=>kd(K)))}function pu(E,S,C){var F,K;let{flushSync:he}=C===void 0?{}:C,re=w.actionData!=null&&w.navigation.formMethod!=null&&Ir(w.navigation.formMethod)&&w.navigation.state==="loading"&&((F=E.state)==null?void 0:F._isRedirect)!==!0,ne;S.actionData?Object.keys(S.actionData).length>0?ne=S.actionData:ne=null:re?ne=w.actionData:ne=null;let J=S.loaderData?JS(w.loaderData,S.loaderData,S.matches||[],S.errors):w.loaderData,_e=w.blockers;_e.size>0&&(_e=new Map(_e),_e.forEach((Le,zt)=>_e.set(zt,Au)));let Rt=x===!0||w.navigation.formMethod!=null&&Ir(w.navigation.formMethod)&&((K=E.state)==null?void 0:K._isRedirect)!==!0;a&&(o=a,a=void 0),ke||A===dt.Pop||(A===dt.Push?t.history.push(E,E.state):A===dt.Replace&&t.history.replace(E,E.state));let le;if(A===dt.Pop){let Le=oe.get(w.location.pathname);Le&&Le.has(E.pathname)?le={currentLocation:w.location,nextLocation:E}:oe.has(E.pathname)&&(le={currentLocation:E,nextLocation:w.location})}else if(G){let Le=oe.get(w.location.pathname);Le?Le.add(E.pathname):(Le=new Set([E.pathname]),oe.set(w.location.pathname,Le)),le={currentLocation:w.location,nextLocation:E}}Un(st({},S,{actionData:ne,loaderData:J,historyAction:A,location:E,initialized:!0,navigation:I_,revalidation:"idle",restoreScrollPosition:w0(E,S.matches||w.matches),preventScrollReset:Rt,blockers:_e}),{viewTransitionOpts:le,flushSync:he===!0}),A=dt.Pop,x=!1,G=!1,ke=!1,Tn=!1,li=[],gr=[]}async function h0(E,S){if(typeof E=="number"){t.history.go(E);return}let C=tv(w.location,w.matches,l,u.v7_prependBasename,E,u.v7_relativeSplatPath,S==null?void 0:S.fromRouteId,S==null?void 0:S.relative),{path:F,submission:K,error:he}=WS(u.v7_normalizeFormMethod,!1,C,S),re=w.location,ne=qc(w.location,F,S&&S.state);ne=st({},ne,t.history.encodeLocation(ne));let J=S&&S.replace!=null?S.replace:void 0,_e=dt.Push;J===!0?_e=dt.Replace:J===!1||K!=null&&Ir(K.formMethod)&&K.formAction===w.location.pathname+w.location.search&&(_e=dt.Replace);let Rt=S&&"preventScrollReset"in S?S.preventScrollReset===!0:void 0,le=(S&&S.unstable_flushSync)===!0,Le=y0({currentLocation:re,nextLocation:ne,historyAction:_e});if(Le){Nd(Le,{state:"blocked",location:ne,proceed(){Nd(Le,{state:"proceeding",proceed:void 0,reset:void 0,location:ne}),h0(E,S)},reset(){let zt=new Map(w.blockers);zt.set(Le,Au),Un({blockers:zt})}});return}return await ro(_e,ne,{submission:K,pendingError:he,preventScrollReset:Rt,replace:S&&S.replace,enableViewTransition:S&&S.unstable_viewTransition,flushSync:le})}function vM(){if(Ug(),Un({revalidation:"loading"}),w.navigation.state!=="submitting"){if(w.navigation.state==="idle"){ro(w.historyAction,w.location,{startUninterruptedRevalidation:!0});return}ro(A||w.historyAction,w.navigation.location,{overrideNavigation:w.navigation})}}async function ro(E,S,C){$&&$.abort(),$=null,A=E,ke=(C&&C.startUninterruptedRevalidation)===!0,PM(w.location,w.matches),x=(C&&C.preventScrollReset)===!0,G=(C&&C.enableViewTransition)===!0;let F=a||o,K=C&&C.overrideNavigation,he=Ka(F,S,l),re=(C&&C.flushSync)===!0;if(!he){let zt=er(404,{pathname:S.pathname}),{matches:Zn,route:At}=XS(F);Bg(),pu(S,{matches:Zn,loaderData:{},errors:{[At.id]:zt}},{flushSync:re});return}if(w.initialized&&!Tn&&i2(w.location,S)&&!(C&&C.submission&&Ir(C.submission.formMethod))){pu(S,{matches:he},{flushSync:re});return}$=new AbortController;let ne=Pu(t.history,S,$.signal,C&&C.submission),J,_e;if(C&&C.pendingError)_e={[hc(he).route.id]:C.pendingError};else if(C&&C.submission&&Ir(C.submission.formMethod)){let zt=await wM(ne,S,C.submission,he,{replace:C.replace,flushSync:re});if(zt.shortCircuited)return;J=zt.pendingActionData,_e=zt.pendingActionError,K=T_(S,C.submission),re=!1,ne=new Request(ne.url,{signal:ne.signal})}let{shortCircuited:Rt,loaderData:le,errors:Le}=await EM(ne,S,he,K,C&&C.submission,C&&C.fetcherSubmission,C&&C.replace,C&&C.initialHydration===!0,re,J,_e);Rt||($=null,pu(S,st({matches:he},J?{actionData:J}:{},{loaderData:le,errors:Le})))}async function wM(E,S,C,F,K){K===void 0&&(K={}),Ug();let he=l2(S,C);Un({navigation:he},{flushSync:K.flushSync===!0});let re,ne=rv(F,S);if(!ne.route.action&&!ne.route.lazy)re={type:rt.error,error:er(405,{method:E.method,pathname:S.pathname,routeId:ne.route.id})};else if(re=await Cu("action",E,ne,F,s,i,l,u.v7_relativeSplatPath),E.signal.aborted)return{shortCircuited:!0};if(Io(re)){let J;return K&&K.replace!=null?J=K.replace:J=re.location===w.location.pathname+w.location.search,await mu(w,re,{submission:C,replace:J}),{shortCircuited:!0}}if(Qa(re)){let J=hc(F,ne.route.id);return(K&&K.replace)!==!0&&(A=dt.Push),{pendingActionData:{},pendingActionError:{[J.route.id]:re.error}}}if(Eo(re))throw er(400,{type:"defer-action"});return{pendingActionData:{[ne.route.id]:re.data}}}async function EM(E,S,C,F,K,he,re,ne,J,_e,Rt){let le=F||T_(S,K),Le=K||he||tR(le),zt=a||o,[Zn,At]=HS(t.history,w,C,Le,S,u.v7_partialHydration&&ne===!0,Tn,li,gr,$t,Ue,Se,zt,l,_e,Rt);if(Bg(xe=>!(C&&C.some(qe=>qe.route.id===xe))||Zn&&Zn.some(qe=>qe.route.id===xe)),Z=++z,Zn.length===0&&At.length===0){let xe=m0();return pu(S,st({matches:C,loaderData:{},errors:Rt||null},_e?{actionData:_e}:{},xe?{fetchers:new Map(w.fetchers)}:{}),{flushSync:J}),{shortCircuited:!0}}if(!ke&&(!u.v7_partialHydration||!ne)){At.forEach(qe=>{let Lr=w.fetchers.get(qe.key),Dd=bu(void 0,Lr?Lr.data:void 0);w.fetchers.set(qe.key,Dd)});let xe=_e||w.actionData;Un(st({navigation:le},xe?Object.keys(xe).length===0?{actionData:null}:{actionData:xe}:{},At.length>0?{fetchers:new Map(w.fetchers)}:{}),{flushSync:J})}At.forEach(xe=>{Oe.has(xe.key)&&ji(xe.key),xe.controller&&Oe.set(xe.key,xe.controller)});let wa=()=>At.forEach(xe=>ji(xe.key));$&&$.signal.addEventListener("abort",wa);let{results:$g,loaderResults:Ea,fetcherResults:qi}=await d0(w.matches,C,Zn,At,E);if(E.signal.aborted)return{shortCircuited:!0};$&&$.signal.removeEventListener("abort",wa),At.forEach(xe=>Oe.delete(xe.key));let io=ZS($g);if(io){if(io.idx>=Zn.length){let xe=At[io.idx-Zn.length].key;Se.add(xe)}return await mu(w,io.result,{replace:re}),{shortCircuited:!0}}let{loaderData:zg,errors:jg}=YS(w,C,Zn,Ea,Rt,At,qi,_r);_r.forEach((xe,qe)=>{xe.subscribe(Lr=>{(Lr||xe.done)&&_r.delete(qe)})});let qg=m0(),Ia=g0(Z),xd=qg||Ia||At.length>0;return st({loaderData:zg,errors:jg},xd?{fetchers:new Map(w.fetchers)}:{})}function IM(E,S,C,F){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Oe.has(E)&&ji(E);let K=(F&&F.unstable_flushSync)===!0,he=a||o,re=tv(w.location,w.matches,l,u.v7_prependBasename,C,u.v7_relativeSplatPath,S,F==null?void 0:F.relative),ne=Ka(he,re,l);if(!ne){gu(E,S,er(404,{pathname:re}),{flushSync:K});return}let{path:J,submission:_e,error:Rt}=WS(u.v7_normalizeFormMethod,!0,re,F);if(Rt){gu(E,S,Rt,{flushSync:K});return}let le=rv(ne,J);if(x=(F&&F.preventScrollReset)===!0,_e&&Ir(_e.formMethod)){TM(E,S,J,le,ne,K,_e);return}Ue.set(E,{routeId:S,path:J}),SM(E,S,J,le,ne,K,_e)}async function TM(E,S,C,F,K,he,re){if(Ug(),Ue.delete(E),!F.route.action&&!F.route.lazy){let qe=er(405,{method:re.formMethod,pathname:C,routeId:S});gu(E,S,qe,{flushSync:he});return}let ne=w.fetchers.get(E);zi(E,u2(re,ne),{flushSync:he});let J=new AbortController,_e=Pu(t.history,C,J.signal,re);Oe.set(E,J);let Rt=z,le=await Cu("action",_e,F,K,s,i,l,u.v7_relativeSplatPath);if(_e.signal.aborted){Oe.get(E)===J&&Oe.delete(E);return}if(u.v7_fetcherPersist&&$t.has(E)){if(Io(le)||Qa(le)){zi(E,Zi(void 0));return}}else{if(Io(le))if(Oe.delete(E),Z>Rt){zi(E,Zi(void 0));return}else return Se.add(E),zi(E,bu(re)),mu(w,le,{fetcherSubmission:re});if(Qa(le)){gu(E,S,le.error);return}}if(Eo(le))throw er(400,{type:"defer-action"});let Le=w.navigation.location||w.location,zt=Pu(t.history,Le,J.signal),Zn=a||o,At=w.navigation.state!=="idle"?Ka(Zn,w.navigation.location,l):w.matches;pe(At,"Didn't find any matches after fetcher action");let wa=++z;te.set(E,wa);let $g=bu(re,le.data);w.fetchers.set(E,$g);let[Ea,qi]=HS(t.history,w,At,re,Le,!1,Tn,li,gr,$t,Ue,Se,Zn,l,{[F.route.id]:le.data},void 0);qi.filter(qe=>qe.key!==E).forEach(qe=>{let Lr=qe.key,Dd=w.fetchers.get(Lr),kM=bu(void 0,Dd?Dd.data:void 0);w.fetchers.set(Lr,kM),Oe.has(Lr)&&ji(Lr),qe.controller&&Oe.set(Lr,qe.controller)}),Un({fetchers:new Map(w.fetchers)});let io=()=>qi.forEach(qe=>ji(qe.key));J.signal.addEventListener("abort",io);let{results:zg,loaderResults:jg,fetcherResults:qg}=await d0(w.matches,At,Ea,qi,zt);if(J.signal.aborted)return;J.signal.removeEventListener("abort",io),te.delete(E),Oe.delete(E),qi.forEach(qe=>Oe.delete(qe.key));let Ia=ZS(zg);if(Ia){if(Ia.idx>=Ea.length){let qe=qi[Ia.idx-Ea.length].key;Se.add(qe)}return mu(w,Ia.result)}let{loaderData:xd,errors:xe}=YS(w,w.matches,Ea,jg,void 0,qi,qg,_r);if(w.fetchers.has(E)){let qe=Zi(le.data);w.fetchers.set(E,qe)}g0(wa),w.navigation.state==="loading"&&wa>Z?(pe(A,"Expected pending action"),$&&$.abort(),pu(w.navigation.location,{matches:At,loaderData:xd,errors:xe,fetchers:new Map(w.fetchers)})):(Un({errors:xe,loaderData:JS(w.loaderData,xd,At,xe),fetchers:new Map(w.fetchers)}),Tn=!1)}async function SM(E,S,C,F,K,he,re){let ne=w.fetchers.get(E);zi(E,bu(re,ne?ne.data:void 0),{flushSync:he});let J=new AbortController,_e=Pu(t.history,C,J.signal);Oe.set(E,J);let Rt=z,le=await Cu("loader",_e,F,K,s,i,l,u.v7_relativeSplatPath);if(Eo(le)&&(le=await Hk(le,_e.signal,!0)||le),Oe.get(E)===J&&Oe.delete(E),!_e.signal.aborted){if($t.has(E)){zi(E,Zi(void 0));return}if(Io(le))if(Z>Rt){zi(E,Zi(void 0));return}else{Se.add(E),await mu(w,le);return}if(Qa(le)){gu(E,S,le.error);return}pe(!Eo(le),"Unhandled fetcher deferred data"),zi(E,Zi(le.data))}}async function mu(E,S,C){let{submission:F,fetcherSubmission:K,replace:he}=C===void 0?{}:C;S.revalidate&&(Tn=!0);let re=qc(E.location,S.location,{_isRedirect:!0});if(pe(re,"Expected a location on the redirect navigation"),n){let Le=!1;if(S.reloadDocument)Le=!0;else if(zk.test(S.location)){const zt=t.history.createURL(S.location);Le=zt.origin!==e.location.origin||Gh(zt.pathname,l)==null}if(Le){he?e.location.replace(S.location):e.location.assign(S.location);return}}$=null;let ne=he===!0?dt.Replace:dt.Push,{formMethod:J,formAction:_e,formEncType:Rt}=E.navigation;!F&&!K&&J&&_e&&Rt&&(F=tR(E.navigation));let le=F||K;if(YB.has(S.status)&&le&&Ir(le.formMethod))await ro(ne,re,{submission:st({},le,{formAction:S.location}),preventScrollReset:x});else{let Le=T_(re,F);await ro(ne,re,{overrideNavigation:Le,fetcherSubmission:K,preventScrollReset:x})}}async function d0(E,S,C,F,K){let he=await Promise.all([...C.map(J=>Cu("loader",K,J,S,s,i,l,u.v7_relativeSplatPath)),...F.map(J=>J.matches&&J.match&&J.controller?Cu("loader",Pu(t.history,J.path,J.controller.signal),J.match,J.matches,s,i,l,u.v7_relativeSplatPath):{type:rt.error,error:er(404,{pathname:J.path})})]),re=he.slice(0,C.length),ne=he.slice(C.length);return await Promise.all([eR(E,C,re,re.map(()=>K.signal),!1,w.loaderData),eR(E,F.map(J=>J.match),ne,F.map(J=>J.controller?J.controller.signal:null),!0)]),{results:he,loaderResults:re,fetcherResults:ne}}function Ug(){Tn=!0,li.push(...Bg()),Ue.forEach((E,S)=>{Oe.has(S)&&(gr.push(S),ji(S))})}function zi(E,S,C){C===void 0&&(C={}),w.fetchers.set(E,S),Un({fetchers:new Map(w.fetchers)},{flushSync:(C&&C.flushSync)===!0})}function gu(E,S,C,F){F===void 0&&(F={});let K=hc(w.matches,S);kd(E),Un({errors:{[K.route.id]:C},fetchers:new Map(w.fetchers)},{flushSync:(F&&F.flushSync)===!0})}function f0(E){return u.v7_fetcherPersist&&(Or.set(E,(Or.get(E)||0)+1),$t.has(E)&&$t.delete(E)),w.fetchers.get(E)||JB}function kd(E){let S=w.fetchers.get(E);Oe.has(E)&&!(S&&S.state==="loading"&&te.has(E))&&ji(E),Ue.delete(E),te.delete(E),Se.delete(E),$t.delete(E),w.fetchers.delete(E)}function RM(E){if(u.v7_fetcherPersist){let S=(Or.get(E)||0)-1;S<=0?(Or.delete(E),$t.add(E)):Or.set(E,S)}else kd(E);Un({fetchers:new Map(w.fetchers)})}function ji(E){let S=Oe.get(E);pe(S,"Expected fetch controller: "+E),S.abort(),Oe.delete(E)}function p0(E){for(let S of E){let C=f0(S),F=Zi(C.data);w.fetchers.set(S,F)}}function m0(){let E=[],S=!1;for(let C of Se){let F=w.fetchers.get(C);pe(F,"Expected fetcher: "+C),F.state==="loading"&&(Se.delete(C),E.push(C),S=!0)}return p0(E),S}function g0(E){let S=[];for(let[C,F]of te)if(F<E){let K=w.fetchers.get(C);pe(K,"Expected fetcher: "+C),K.state==="loading"&&(ji(C),te.delete(C),S.push(C))}return p0(S),S.length>0}function AM(E,S){let C=w.blockers.get(E)||Au;return cn.get(E)!==S&&cn.set(E,S),C}function _0(E){w.blockers.delete(E),cn.delete(E)}function Nd(E,S){let C=w.blockers.get(E)||Au;pe(C.state==="unblocked"&&S.state==="blocked"||C.state==="blocked"&&S.state==="blocked"||C.state==="blocked"&&S.state==="proceeding"||C.state==="blocked"&&S.state==="unblocked"||C.state==="proceeding"&&S.state==="unblocked","Invalid blocker state transition: "+C.state+" -> "+S.state);let F=new Map(w.blockers);F.set(E,S),Un({blockers:F})}function y0(E){let{currentLocation:S,nextLocation:C,historyAction:F}=E;if(cn.size===0)return;cn.size>1&&$o(!1,"A router only supports one blocker at a time");let K=Array.from(cn.entries()),[he,re]=K[K.length-1],ne=w.blockers.get(he);if(!(ne&&ne.state==="proceeding")&&re({currentLocation:S,nextLocation:C,historyAction:F}))return he}function Bg(E){let S=[];return _r.forEach((C,F)=>{(!E||E(F))&&(C.cancel(),S.push(F),_r.delete(F))}),S}function CM(E,S,C){if(d=E,p=S,f=C||null,!m&&w.navigation===I_){m=!0;let F=w0(w.location,w.matches);F!=null&&Un({restoreScrollPosition:F})}return()=>{d=null,p=null,f=null}}function v0(E,S){return f&&f(E,S.map(F=>AB(F,w.loaderData)))||E.key}function PM(E,S){if(d&&p){let C=v0(E,S);d[C]=p()}}function w0(E,S){if(d){let C=v0(E,S),F=d[C];if(typeof F=="number")return F}return null}function bM(E){s={},a=ev(E,i,void 0,s)}return b={get basename(){return l},get future(){return u},get state(){return w},get routes(){return o},get window(){return e},initialize:gM,subscribe:yM,enableScrollRestoration:CM,navigate:h0,fetch:IM,revalidate:vM,createHref:E=>t.history.createHref(E),encodeLocation:E=>t.history.encodeLocation(E),getFetcher:f0,deleteFetcher:RM,dispose:_M,getBlocker:AM,deleteBlocker:_0,_internalFetchControllers:Oe,_internalActiveDeferreds:_r,_internalSetRoutes:bM},b}function e2(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function tv(t,e,n,r,i,s,o,a){let l,u;if(o){l=[];for(let h of e)if(l.push(h),h.route.id===o){u=h;break}}else l=e,u=e[e.length-1];let c=Uk(i||".",Fk(l,s),Gh(t.pathname,n)||t.pathname,a==="path");return i==null&&(c.search=t.search,c.hash=t.hash),(i==null||i===""||i===".")&&u&&u.route.index&&!xE(c.search)&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(c.pathname=c.pathname==="/"?n:ws([n,c.pathname])),Hh(c)}function WS(t,e,n,r){if(!r||!e2(r))return{path:n};if(r.formMethod&&!a2(r.formMethod))return{path:n,error:er(405,{method:r.formMethod})};let i=()=>({path:n,error:er(400,{type:"invalid-body"})}),s=r.formMethod||"get",o=t?s.toUpperCase():s.toLowerCase(),a=Wk(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Ir(o))return i();let d=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((f,p)=>{let[m,v]=p;return""+f+m+"="+v+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:d}}}else if(r.formEncType==="application/json"){if(!Ir(o))return i();try{let d=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:d,text:void 0}}}catch{return i()}}}pe(typeof FormData=="function","FormData is not available in this environment");let l,u;if(r.formData)l=nv(r.formData),u=r.formData;else if(r.body instanceof FormData)l=nv(r.body),u=r.body;else if(r.body instanceof URLSearchParams)l=r.body,u=QS(l);else if(r.body==null)l=new URLSearchParams,u=new FormData;else try{l=new URLSearchParams(r.body),u=QS(l)}catch{return i()}let c={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(Ir(c.formMethod))return{path:n,submission:c};let h=Oi(n);return e&&h.search&&xE(h.search)&&l.append("index",""),h.search="?"+l,{path:Hh(h),submission:c}}function t2(t,e){let n=t;if(e){let r=t.findIndex(i=>i.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function HS(t,e,n,r,i,s,o,a,l,u,c,h,d,f,p,m){let v=m?Object.values(m)[0]:p?Object.values(p)[0]:void 0,g=t.createURL(e.location),_=t.createURL(i),y=m?Object.keys(m)[0]:void 0,b=t2(n,y).filter((A,x)=>{let{route:$}=A;if($.lazy)return!0;if($.loader==null)return!1;if(s)return $.loader.hydrate?!0:e.loaderData[$.id]===void 0&&(!e.errors||e.errors[$.id]===void 0);if(n2(e.loaderData,e.matches[x],A)||a.some(Re=>Re===A.route.id))return!0;let G=e.matches[x],oe=A;return GS(A,st({currentUrl:g,currentParams:G.params,nextUrl:_,nextParams:oe.params},r,{actionResult:v,defaultShouldRevalidate:o||g.pathname+g.search===_.pathname+_.search||g.search!==_.search||qk(G,oe)}))}),w=[];return c.forEach((A,x)=>{if(s||!n.some(ke=>ke.route.id===A.routeId)||u.has(x))return;let $=Ka(d,A.path,f);if(!$){w.push({key:x,routeId:A.routeId,path:A.path,matches:null,match:null,controller:null});return}let G=e.fetchers.get(x),oe=rv($,A.path),Re=!1;h.has(x)?Re=!1:l.includes(x)?Re=!0:G&&G.state!=="idle"&&G.data===void 0?Re=o:Re=GS(oe,st({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:_,nextParams:n[n.length-1].params},r,{actionResult:v,defaultShouldRevalidate:o})),Re&&w.push({key:x,routeId:A.routeId,path:A.path,matches:$,match:oe,controller:new AbortController})}),[b,w]}function n2(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function qk(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function GS(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function KS(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];pe(i,"No route found in manifest");let s={};for(let o in r){let l=i[o]!==void 0&&o!=="hasErrorBoundary";$o(!l,'Route "'+i.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!l&&!SB.has(o)&&(s[o]=r[o])}Object.assign(i,s),Object.assign(i,st({},e(i),{lazy:void 0}))}async function Cu(t,e,n,r,i,s,o,a,l){l===void 0&&(l={});let u,c,h,d=m=>{let v,g=new Promise((_,y)=>v=y);return h=()=>v(),e.signal.addEventListener("abort",h),Promise.race([m({request:e,params:n.params,context:l.requestContext}),g])};try{let m=n.route[t];if(n.route.lazy)if(m){let v,g=await Promise.all([d(m).catch(_=>{v=_}),KS(n.route,s,i)]);if(v)throw v;c=g[0]}else if(await KS(n.route,s,i),m=n.route[t],m)c=await d(m);else if(t==="action"){let v=new URL(e.url),g=v.pathname+v.search;throw er(405,{method:e.method,pathname:g,routeId:n.route.id})}else return{type:rt.data,data:void 0};else if(m)c=await d(m);else{let v=new URL(e.url),g=v.pathname+v.search;throw er(404,{pathname:g})}pe(c!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){u=rt.error,c=m}finally{h&&e.signal.removeEventListener("abort",h)}if(o2(c)){let m=c.status;if(QB.has(m)){let g=c.headers.get("Location");if(pe(g,"Redirects returned/thrown from loaders/actions must have a Location header"),!zk.test(g))g=tv(new URL(e.url),r.slice(0,r.indexOf(n)+1),o,!0,g,a);else if(!l.isStaticRequest){let _=new URL(e.url),y=g.startsWith("//")?new URL(_.protocol+g):new URL(g),T=Gh(y.pathname,o)!=null;y.origin===_.origin&&T&&(g=y.pathname+y.search+y.hash)}if(l.isStaticRequest)throw c.headers.set("Location",g),c;return{type:rt.redirect,status:m,location:g,revalidate:c.headers.get("X-Remix-Revalidate")!==null,reloadDocument:c.headers.get("X-Remix-Reload-Document")!==null}}if(l.isRouteRequest)throw{type:u===rt.error?rt.error:rt.data,response:c};let v;try{let g=c.headers.get("Content-Type");g&&/\bapplication\/json\b/.test(g)?v=await c.json():v=await c.text()}catch(g){return{type:rt.error,error:g}}return u===rt.error?{type:u,error:new NE(m,c.statusText,v),headers:c.headers}:{type:rt.data,data:v,statusCode:c.status,headers:c.headers}}if(u===rt.error)return{type:u,error:c};if(s2(c)){var f,p;return{type:rt.deferred,deferredData:c,statusCode:(f=c.init)==null?void 0:f.status,headers:((p=c.init)==null?void 0:p.headers)&&new Headers(c.init.headers)}}return{type:rt.data,data:c}}function Pu(t,e,n,r){let i=t.createURL(Wk(e)).toString(),s={signal:n};if(r&&Ir(r.formMethod)){let{formMethod:o,formEncType:a}=r;s.method=o.toUpperCase(),a==="application/json"?(s.headers=new Headers({"Content-Type":a}),s.body=JSON.stringify(r.json)):a==="text/plain"?s.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?s.body=nv(r.formData):s.body=r.formData}return new Request(i,s)}function nv(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function QS(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function r2(t,e,n,r,i){let s={},o=null,a,l=!1,u={};return n.forEach((c,h)=>{let d=e[h].route.id;if(pe(!Io(c),"Cannot handle redirect results in processLoaderData"),Qa(c)){let f=hc(t,d),p=c.error;r&&(p=Object.values(r)[0],r=void 0),o=o||{},o[f.route.id]==null&&(o[f.route.id]=p),s[d]=void 0,l||(l=!0,a=Bk(c.error)?c.error.status:500),c.headers&&(u[d]=c.headers)}else Eo(c)?(i.set(d,c.deferredData),s[d]=c.deferredData.data):s[d]=c.data,c.statusCode!=null&&c.statusCode!==200&&!l&&(a=c.statusCode),c.headers&&(u[d]=c.headers)}),r&&(o=r,s[Object.keys(r)[0]]=void 0),{loaderData:s,errors:o,statusCode:a||200,loaderHeaders:u}}function YS(t,e,n,r,i,s,o,a){let{loaderData:l,errors:u}=r2(e,n,r,i,a);for(let c=0;c<s.length;c++){let{key:h,match:d,controller:f}=s[c];pe(o!==void 0&&o[c]!==void 0,"Did not find corresponding fetcher result");let p=o[c];if(!(f&&f.signal.aborted))if(Qa(p)){let m=hc(t.matches,d==null?void 0:d.route.id);u&&u[m.route.id]||(u=st({},u,{[m.route.id]:p.error})),t.fetchers.delete(h)}else if(Io(p))pe(!1,"Unhandled fetcher revalidation redirect");else if(Eo(p))pe(!1,"Unhandled fetcher deferred data");else{let m=Zi(p.data);t.fetchers.set(h,m)}}return{loaderData:l,errors:u}}function JS(t,e,n,r){let i=st({},e);for(let s of n){let o=s.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(i[o]=e[o]):t[o]!==void 0&&s.route.loader&&(i[o]=t[o]),r&&r.hasOwnProperty(o))break}return i}function hc(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function XS(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function er(t,e){let{pathname:n,routeId:r,method:i,type:s}=e===void 0?{}:e,o="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(o="Bad Request",i&&n&&r?a="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":s==="defer-action"?a="defer() is not supported in actions":s==="invalid-body"&&(a="Unable to encode submission body")):t===403?(o="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):t===404?(o="Not Found",a='No route matches URL "'+n+'"'):t===405&&(o="Method Not Allowed",i&&n&&r?a="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(a='Invalid request method "'+i.toUpperCase()+'"')),new NE(t||500,o,new Error(a),!0)}function ZS(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Io(n))return{result:n,idx:e}}}function Wk(t){let e=typeof t=="string"?Oi(t):t;return Hh(st({},e,{hash:""}))}function i2(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function Eo(t){return t.type===rt.deferred}function Qa(t){return t.type===rt.error}function Io(t){return(t&&t.type)===rt.redirect}function s2(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function o2(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function a2(t){return KB.has(t.toLowerCase())}function Ir(t){return HB.has(t.toLowerCase())}async function eR(t,e,n,r,i,s){for(let o=0;o<n.length;o++){let a=n[o],l=e[o];if(!l)continue;let u=t.find(h=>h.route.id===l.route.id),c=u!=null&&!qk(u,l)&&(s&&s[l.route.id])!==void 0;if(Eo(a)&&(i||c)){let h=r[o];pe(h,"Expected an AbortSignal for revalidating fetcher deferred result"),await Hk(a,h,i).then(d=>{d&&(n[o]=d||n[o])})}}}async function Hk(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:rt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:rt.error,error:i}}return{type:rt.data,data:t.deferredData.data}}}function xE(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function rv(t,e){let n=typeof e=="string"?Oi(e).search:e.search;if(t[t.length-1].route.index&&xE(n||""))return t[t.length-1];let r=Vk(t);return r[r.length-1]}function tR(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:s,json:o}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:s,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function T_(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function l2(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function bu(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function u2(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Zi(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function c2(t,e){try{let n=t.sessionStorage.getItem(jk);if(n){let r=JSON.parse(n);for(let[i,s]of Object.entries(r||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function h2(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(jk,JSON.stringify(n))}catch(r){$o(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wc(){return Wc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wc.apply(this,arguments)}const Em=M.createContext(null),Gk=M.createContext(null),Im=M.createContext(null),Tm=M.createContext(null),Hl=M.createContext({outlet:null,matches:[],isDataRoute:!1}),Kk=M.createContext(null);function Sm(){return M.useContext(Tm)!=null}function Qk(){return Sm()||pe(!1),M.useContext(Tm).location}function Yk(t){M.useContext(Im).static||M.useLayoutEffect(t)}function d2(){let{isDataRoute:t}=M.useContext(Hl);return t?S2():f2()}function f2(){Sm()||pe(!1);let t=M.useContext(Em),{basename:e,future:n,navigator:r}=M.useContext(Im),{matches:i}=M.useContext(Hl),{pathname:s}=Qk(),o=JSON.stringify(Fk(i,n.v7_relativeSplatPath)),a=M.useRef(!1);return Yk(()=>{a.current=!0}),M.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let h=Uk(u,JSON.parse(o),s,c.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ws([e,h.pathname])),(c.replace?r.replace:r.push)(h,c.state,c)},[e,r,o,s,t])}function p2(t,e,n,r){Sm()||pe(!1);let{navigator:i}=M.useContext(Im),{matches:s}=M.useContext(Hl),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Qk(),c;if(e){var h;let v=typeof e=="string"?Oi(e):e;l==="/"||(h=v.pathname)!=null&&h.startsWith(l)||pe(!1),c=v}else c=u;let d=c.pathname||"/",f=l==="/"?d:d.slice(l.length)||"/",p=Ka(t,{pathname:f}),m=v2(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},a,v.params),pathname:ws([l,i.encodeLocation?i.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:ws([l,i.encodeLocation?i.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,n,r);return e&&m?M.createElement(Tm.Provider,{value:{location:Wc({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:dt.Pop}},m):m}function m2(){let t=T2(),e=Bk(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),n?M.createElement("pre",{style:i},n):null,s)}const g2=M.createElement(m2,null);class _2 extends M.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?M.createElement(Hl.Provider,{value:this.props.routeContext},M.createElement(Kk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function y2(t){let{routeContext:e,match:n,children:r}=t,i=M.useContext(Em);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),M.createElement(Hl.Provider,{value:e},r)}function v2(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let c=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id]));c>=0||pe(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let h=o[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:f}=n,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,h,d)=>{let f,p=!1,m=null,v=null;n&&(f=a&&h.route.id?a[h.route.id]:void 0,m=h.route.errorElement||g2,l&&(u<0&&d===0?(R2("route-fallback",!1),p=!0,v=null):u===d&&(p=!0,v=h.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,d+1)),_=()=>{let y;return f?y=m:p?y=v:h.route.Component?y=M.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=c,M.createElement(y2,{match:h,routeContext:{outlet:c,matches:g,isDataRoute:n!=null},children:y})};return n&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?M.createElement(_2,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:_(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):_()},null)}var Jk=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Jk||{}),hp=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(hp||{});function w2(t){let e=M.useContext(Em);return e||pe(!1),e}function E2(t){let e=M.useContext(Gk);return e||pe(!1),e}function I2(t){let e=M.useContext(Hl);return e||pe(!1),e}function Xk(t){let e=I2(),n=e.matches[e.matches.length-1];return n.route.id||pe(!1),n.route.id}function T2(){var t;let e=M.useContext(Kk),n=E2(hp.UseRouteError),r=Xk(hp.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function S2(){let{router:t}=w2(Jk.UseNavigateStable),e=Xk(hp.UseNavigateStable),n=M.useRef(!1);return Yk(()=>{n.current=!0}),M.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Wc({fromRouteId:e},s)))},[t,e])}const nR={};function R2(t,e,n){!e&&!nR[t]&&(nR[t]=!0)}function A2(t){let{basename:e="/",children:n=null,location:r,navigationType:i=dt.Pop,navigator:s,static:o=!1,future:a}=t;Sm()&&pe(!1);let l=e.replace(/^\/*/,"/"),u=M.useMemo(()=>({basename:l,navigator:s,static:o,future:Wc({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=Oi(r));let{pathname:c="/",search:h="",hash:d="",state:f=null,key:p="default"}=r,m=M.useMemo(()=>{let v=Gh(c,l);return v==null?null:{location:{pathname:v,search:h,hash:d,state:f,key:p},navigationType:i}},[l,c,h,d,f,p,i]);return m==null?null:M.createElement(Im.Provider,{value:u},M.createElement(Tm.Provider,{children:n,value:m}))}new Promise(()=>{});function C2(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:M.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:M.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:M.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dp(){return dp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dp.apply(this,arguments)}function P2(t,e){return ZB({basename:e==null?void 0:e.basename,future:dp({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:EB({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||b2(),routes:t,mapRouteProperties:C2,window:e==null?void 0:e.window}).initialize()}function b2(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=dp({},e,{errors:k2(e.errors)})),e}function k2(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new NE(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let o=new s(i.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let s=new Error(i.message);s.stack="",n[r]=s}}else n[r]=i;return n}const N2=M.createContext({isTransitioning:!1}),x2=M.createContext(new Map),D2="startTransition",rR=GM[D2],O2="flushSync",iR=JF[O2];function L2(t){rR?rR(t):t()}function ku(t){iR?iR(t):t()}let M2=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function V2(t){let{fallbackElement:e,router:n,future:r}=t,[i,s]=M.useState(n.state),[o,a]=M.useState(),[l,u]=M.useState({isTransitioning:!1}),[c,h]=M.useState(),[d,f]=M.useState(),[p,m]=M.useState(),v=M.useRef(new Map),{v7_startTransition:g}=r||{},_=M.useCallback(A=>{g?L2(A):A()},[g]),y=M.useCallback((A,x)=>{let{deletedFetchers:$,unstable_flushSync:G,unstable_viewTransitionOpts:oe}=x;$.forEach(ke=>v.current.delete(ke)),A.fetchers.forEach((ke,Tn)=>{ke.data!==void 0&&v.current.set(Tn,ke.data)});let Re=n.window==null||typeof n.window.document.startViewTransition!="function";if(!oe||Re){G?ku(()=>s(A)):_(()=>s(A));return}if(G){ku(()=>{d&&(c&&c.resolve(),d.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:oe.currentLocation,nextLocation:oe.nextLocation})});let ke=n.window.document.startViewTransition(()=>{ku(()=>s(A))});ke.finished.finally(()=>{ku(()=>{h(void 0),f(void 0),a(void 0),u({isTransitioning:!1})})}),ku(()=>f(ke));return}d?(c&&c.resolve(),d.skipTransition(),m({state:A,currentLocation:oe.currentLocation,nextLocation:oe.nextLocation})):(a(A),u({isTransitioning:!0,flushSync:!1,currentLocation:oe.currentLocation,nextLocation:oe.nextLocation}))},[n.window,d,c,v,_]);M.useLayoutEffect(()=>n.subscribe(y),[n,y]),M.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new M2)},[l]),M.useEffect(()=>{if(c&&o&&n.window){let A=o,x=c.promise,$=n.window.document.startViewTransition(async()=>{_(()=>s(A)),await x});$.finished.finally(()=>{h(void 0),f(void 0),a(void 0),u({isTransitioning:!1})}),f($)}},[_,o,c,n.window]),M.useEffect(()=>{c&&o&&i.location.key===o.location.key&&c.resolve()},[c,d,i.location,o]),M.useEffect(()=>{!l.isTransitioning&&p&&(a(p.state),u({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[l.isTransitioning,p]),M.useEffect(()=>{},[]);let T=M.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:A=>n.navigate(A),push:(A,x,$)=>n.navigate(A,{state:x,preventScrollReset:$==null?void 0:$.preventScrollReset}),replace:(A,x,$)=>n.navigate(A,{replace:!0,state:x,preventScrollReset:$==null?void 0:$.preventScrollReset})}),[n]),b=n.basename||"/",w=M.useMemo(()=>({router:n,navigator:T,static:!1,basename:b}),[n,T,b]);return M.createElement(M.Fragment,null,M.createElement(Em.Provider,{value:w},M.createElement(Gk.Provider,{value:i},M.createElement(x2.Provider,{value:v.current},M.createElement(N2.Provider,{value:l},M.createElement(A2,{basename:b,location:i.location,navigationType:i.historyAction,navigator:T,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},i.initialized||n.future.v7_partialHydration?M.createElement(F2,{routes:n.routes,future:n.future,state:i}):e))))),null)}function F2(t){let{routes:e,future:n,state:r}=t;return p2(e,void 0,r,n)}var sR;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(sR||(sR={}));var oR;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(oR||(oR={}));var aR={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L=function(t,e){if(!t)throw Gl(e)},Gl=function(t){return new Error("Firebase Database ("+Zk.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},U2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},DE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,c=s>>2,h=(s&3)<<4|a>>4;let d=(a&15)<<2|u>>6,f=u&63;l||(f=64,o||(d=64)),r.push(n[c],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(e1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):U2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||h==null)throw new B2;const d=s<<2|a>>4;if(r.push(d),u!==64){const f=a<<4&240|u>>2;if(r.push(f),h!==64){const p=u<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class B2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const t1=function(t){const e=e1(t);return DE.encodeByteArray(e,!0)},fp=function(t){return t1(t).replace(/\./g,"")},pp=function(t){try{return DE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $2(t){return Hc(void 0,t)}function Hc(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!z2(n)||(t[n]=Hc(t[n],e[n]));return t}function z2(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q2=()=>j2().__FIREBASE_DEFAULTS__,W2=()=>{if(typeof process>"u"||typeof aR>"u")return;const t=aR.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},H2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&pp(t[1]);return e&&JSON.parse(e)},OE=()=>{try{return q2()||W2()||H2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},n1=()=>{var t;return(t=OE())===null||t===void 0?void 0:t.config},G2=t=>{var e;return(e=OE())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[fp(JSON.stringify(n)),fp(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function LE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tt())}function ME(){var t;const e=(t=OE())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function K2(){return typeof self=="object"&&self.self===self}function i1(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Rm(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function s1(){const t=tt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function o1(){return Zk.NODE_ADMIN===!0}function Q2(){return!ME()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gc(){try{return typeof indexedDB=="object"}catch{return!1}}function Y2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2="FirebaseError";class _n extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=J2,Object.setPrototypeOf(this,_n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,la.prototype.create)}}class la{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?X2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new _n(i,a,r)}}function X2(t,e){return t.replace(Z2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Z2=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){return JSON.parse(t)}function Et(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=function(t){let e={},n={},r={},i="";try{const s=t.split(".");e=Kc(pp(s[0])||""),n=Kc(pp(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},e$=function(t){const e=a1(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},t$=function(t){const e=a1(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function zo(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function mp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function gp(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function iv(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(lR(s)&&lR(o)){if(!iv(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function lR(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ya(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Qu(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n${constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,c;for(let h=0;h<80;h++){h<40?h<20?(u=a^s&(o^a),c=1518500249):(u=s^o^a,c=1859775393):h<60?(u=s&o|a&(s|o),c=2400959708):(u=s^o^a,c=3395469782);const d=(i<<5|i>>>27)+u+l+c+r[h]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function l1(t,e){const n=new r$(t,e);return n.subscribe.bind(n)}class r${constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");i$(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=S_),i.error===void 0&&(i.error=S_),i.complete===void 0&&(i.complete=S_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function i$(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function S_(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=function(t,e,n,r){let i;if(r<e?i="at least "+e:r>n&&(i=n===0?"none":"no more than "+n),i){const s=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function Mn(t,e){return`${t} failed: ${e} argument `}function kt(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(Mn(t,e)+"must be a valid function.")}function uR(t,e,n,r){if(!(r&&!n)&&(typeof n!="object"||n===null))throw new Error(Mn(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s$=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,L(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Am=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(t){return t&&t._delegate?t._delegate:t}class Vn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Cn;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(a$(e))try{this.getOrInitializeService({instanceIdentifier:lo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=lo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=lo){return this.instances.has(e)}getOptions(e=lo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:o$(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=lo){return this.component?this.component.multipleInstances?e:lo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function o$(t){return t===lo?void 0:t}function a$(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new sv(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VE=[];var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const c1={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},l$=de.INFO,u$={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},c$=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=u$[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kl{constructor(e){this.name=e,this._logLevel=l$,this._logHandler=c$,this._userLogHandler=null,VE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?c1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}function h$(t){VE.forEach(e=>{e.setLogLevel(t)})}function d$(t,e){for(const n of VE){let r=null;e&&e.level&&(r=c1[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(r??i.logLevel)&&t({level:de[s].toLowerCase(),message:a,args:o,type:i.name})}}}const f$=(t,e)=>e.some(n=>t instanceof n);let cR,hR;function p$(){return cR||(cR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function m$(){return hR||(hR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const h1=new WeakMap,ov=new WeakMap,d1=new WeakMap,R_=new WeakMap,FE=new WeakMap;function g$(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Es(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&h1.set(n,t)}).catch(()=>{}),FE.set(e,t),e}function _$(t){if(ov.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});ov.set(t,e)}let av={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ov.get(t);if(e==="objectStoreNames")return t.objectStoreNames||d1.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Es(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function y$(t){av=t(av)}function v$(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(A_(this),e,...n);return d1.set(r,e.sort?e.sort():[e]),Es(r)}:m$().includes(t)?function(...e){return t.apply(A_(this),e),Es(h1.get(this))}:function(...e){return Es(t.apply(A_(this),e))}}function w$(t){return typeof t=="function"?v$(t):(t instanceof IDBTransaction&&_$(t),f$(t,p$())?new Proxy(t,av):t)}function Es(t){if(t instanceof IDBRequest)return g$(t);if(R_.has(t))return R_.get(t);const e=w$(t);return e!==t&&(R_.set(t,e),FE.set(e,t)),e}const A_=t=>FE.get(t);function E$(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Es(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Es(o.result),l.oldVersion,l.newVersion,Es(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const I$=["get","getKey","getAll","getAllKeys","count"],T$=["put","add","delete","clear"],C_=new Map;function dR(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(C_.get(e))return C_.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=T$.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||I$.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return C_.set(e,s),s}y$(t=>({...t,get:(e,n,r)=>dR(e,n)||t.get(e,n,r),has:(e,n)=>!!dR(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S${constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(R$(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function R$(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lv="@firebase/app",fR="0.9.25";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jo=new Kl("@firebase/app"),A$="@firebase/app-compat",C$="@firebase/analytics-compat",P$="@firebase/analytics",b$="@firebase/app-check-compat",k$="@firebase/app-check",N$="@firebase/auth",x$="@firebase/auth-compat",D$="@firebase/database",O$="@firebase/database-compat",L$="@firebase/functions",M$="@firebase/functions-compat",V$="@firebase/installations",F$="@firebase/installations-compat",U$="@firebase/messaging",B$="@firebase/messaging-compat",$$="@firebase/performance",z$="@firebase/performance-compat",j$="@firebase/remote-config",q$="@firebase/remote-config-compat",W$="@firebase/storage",H$="@firebase/storage-compat",G$="@firebase/firestore",K$="@firebase/firestore-compat",Q$="firebase",Y$="10.7.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs="[DEFAULT]",J$={[lv]:"fire-core",[A$]:"fire-core-compat",[P$]:"fire-analytics",[C$]:"fire-analytics-compat",[k$]:"fire-app-check",[b$]:"fire-app-check-compat",[N$]:"fire-auth",[x$]:"fire-auth-compat",[D$]:"fire-rtdb",[O$]:"fire-rtdb-compat",[L$]:"fire-fn",[M$]:"fire-fn-compat",[V$]:"fire-iid",[F$]:"fire-iid-compat",[U$]:"fire-fcm",[B$]:"fire-fcm-compat",[$$]:"fire-perf",[z$]:"fire-perf-compat",[j$]:"fire-rc",[q$]:"fire-rc-compat",[W$]:"fire-gcs",[H$]:"fire-gcs-compat",[G$]:"fire-fst",[K$]:"fire-fst-compat","fire-js":"fire-js",[Q$]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks=new Map,Qc=new Map;function _p(t,e){try{t.container.addComponent(e)}catch(n){jo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function f1(t,e){t.container.addOrOverwriteComponent(e)}function Pi(t){const e=t.name;if(Qc.has(e))return jo.debug(`There were multiple attempts to register component ${e}.`),!1;Qc.set(e,t);for(const n of ks.values())_p(n,t);return!0}function p1(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function X$(t,e,n=bs){p1(t,e).clearInstance(n)}function Z$(){Qc.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Ei=new la("app","Firebase",e4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let t4=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Vn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ei.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li=Y$;function UE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:bs,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ei.create("bad-app-name",{appName:String(i)});if(n||(n=n1()),!n)throw Ei.create("no-options");const s=ks.get(i);if(s){if(iv(n,s.options)&&iv(r,s.config))return s;throw Ei.create("duplicate-app",{appName:i})}const o=new u1(i);for(const l of Qc.values())o.addComponent(l);const a=new t4(n,r,o);return ks.set(i,a),a}function n4(t=bs){const e=ks.get(t);if(!e&&t===bs&&n1())return UE();if(!e)throw Ei.create("no-app",{appName:t});return e}function r4(){return Array.from(ks.values())}async function m1(t){const e=t.name;ks.has(e)&&(ks.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function hr(t,e,n){var r;let i=(r=J$[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),jo.warn(a.join(" "));return}Pi(new Vn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function g1(t,e){if(t!==null&&typeof t!="function")throw Ei.create("invalid-log-argument");d$(t,e)}function _1(t){h$(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4="firebase-heartbeat-database",s4=1,Yc="firebase-heartbeat-store";let P_=null;function y1(){return P_||(P_=E$(i4,s4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Yc)}}}).catch(t=>{throw Ei.create("idb-open",{originalErrorMessage:t.message})})),P_}async function o4(t){try{return await(await y1()).transaction(Yc).objectStore(Yc).get(v1(t))}catch(e){if(e instanceof _n)jo.warn(e.message);else{const n=Ei.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});jo.warn(n.message)}}}async function pR(t,e){try{const r=(await y1()).transaction(Yc,"readwrite");await r.objectStore(Yc).put(e,v1(t)),await r.done}catch(n){if(n instanceof _n)jo.warn(n.message);else{const r=Ei.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});jo.warn(r.message)}}}function v1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4=1024,l4=30*24*60*60*1e3;class u4{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new h4(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=mR();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=l4}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=mR(),{heartbeatsToSend:r,unsentEntries:i}=c4(this._heartbeatsCache.heartbeats),s=fp(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function mR(){return new Date().toISOString().substring(0,10)}function c4(t,e=a4){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),gR(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),gR(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class h4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Gc()?Y2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await o4(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return pR(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return pR(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function gR(t){return fp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(t){Pi(new Vn("platform-logger",e=>new S$(e),"PRIVATE")),Pi(new Vn("heartbeat",e=>new u4(e),"PRIVATE")),hr(lv,fR,t),hr(lv,fR,"esm2017"),hr("fire-js","")}d4("");const f4=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:_n,SDK_VERSION:Li,_DEFAULT_ENTRY_NAME:bs,_addComponent:_p,_addOrOverwriteComponent:f1,_apps:ks,_clearComponents:Z$,_components:Qc,_getProvider:p1,_registerComponent:Pi,_removeServiceInstance:X$,deleteApp:m1,getApp:n4,getApps:r4,initializeApp:UE,onLog:g1,registerVersion:hr,setLogLevel:_1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e,n){this._delegate=e,this.firebase=n,_p(e,new Vn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),m1(this._delegate)))}_getService(e,n=bs){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=bs){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){_p(this._delegate,e)}_addOrOverwriteComponent(e){f1(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},_R=new la("app-compat","Firebase",m4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:hr,setLogLevel:_1,onLog:g1,apps:null,SDK_VERSION:Li,INTERNAL:{registerComponent:a,removeApp:r,useAsService:l,modularAPIs:f4}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||bs,!Gn(e,u))throw _R.create("no-app",{appName:u});return e[u]}i.App=t;function s(u,c={}){const h=UE(u,c);if(Gn(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const c=u.name,h=c.replace("-compat","");if(Pi(u)&&u.type==="PUBLIC"){const d=(f=i())=>{if(typeof f[h]!="function")throw _R.create("invalid-app-argument",{appName:c});return f[h]()};u.serviceProps!==void 0&&Hc(d,u.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,c).apply(this,u.multipleInstances?f:[])}}return u.type==="PUBLIC"?n[h]:null}function l(u,c){return c==="serverAuth"?null:c}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w1(){const t=g4(p4);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:w1,extendNamespace:e,createSubscribe:l1,ErrorFactory:la,deepExtend:Hc});function e(n){Hc(t,n)}return t}const _4=w1();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR=new Kl("@firebase/app-compat"),y4="@firebase/app-compat",v4="0.2.25";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w4(t){hr(y4,v4,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(K2()&&self.firebase!==void 0){yR.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&yR.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Ks=_4;w4();var E4="firebase",I4="10.7.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ks.registerVersion(E4,I4,"app-compat");var T4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},B,BE=BE||{},ie=T4||self;function Cm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Kh(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function S4(t){return Object.prototype.hasOwnProperty.call(t,b_)&&t[b_]||(t[b_]=++R4)}var b_="closure_uid_"+(1e9*Math.random()>>>0),R4=0;function A4(t,e,n){return t.call.apply(t.bind,arguments)}function C4(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function on(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?on=A4:on=C4,on.apply(null,arguments)}function Jd(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ft(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Qs(){this.s=this.s,this.o=this.o}var P4=0;Qs.prototype.s=!1;Qs.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),P4!=0)&&S4(this)};Qs.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const E1=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function $E(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function vR(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Cm(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function an(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}an.prototype.h=function(){this.defaultPrevented=!0};var b4=function(){if(!ie.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};ie.addEventListener("test",n,e),ie.removeEventListener("test",n,e)}catch{}return t}();function Jc(t){return/^[\s\xa0]*$/.test(t)}function Pm(){var t=ie.navigator;return t&&(t=t.userAgent)?t:""}function Br(t){return Pm().indexOf(t)!=-1}function zE(t){return zE[" "](t),t}zE[" "]=function(){};function k4(t,e){var n=Iz;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var N4=Br("Opera"),El=Br("Trident")||Br("MSIE"),I1=Br("Edge"),uv=I1||El,T1=Br("Gecko")&&!(Pm().toLowerCase().indexOf("webkit")!=-1&&!Br("Edge"))&&!(Br("Trident")||Br("MSIE"))&&!Br("Edge"),x4=Pm().toLowerCase().indexOf("webkit")!=-1&&!Br("Edge");function S1(){var t=ie.document;return t?t.documentMode:void 0}var cv;e:{var k_="",N_=function(){var t=Pm();if(T1)return/rv:([^\);]+)(\)|;)/.exec(t);if(I1)return/Edge\/([\d\.]+)/.exec(t);if(El)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(x4)return/WebKit\/(\S+)/.exec(t);if(N4)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(N_&&(k_=N_?N_[1]:""),El){var x_=S1();if(x_!=null&&x_>parseFloat(k_)){cv=String(x_);break e}}cv=k_}var hv;if(ie.document&&El){var wR=S1();hv=wR||parseInt(cv,10)||void 0}else hv=void 0;var D4=hv;function Xc(t,e){if(an.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(T1){e:{try{zE(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:O4[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Xc.$.h.call(this)}}Ft(Xc,an);var O4={2:"touch",3:"pen",4:"mouse"};Xc.prototype.h=function(){Xc.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Qh="closure_listenable_"+(1e6*Math.random()|0),L4=0;function M4(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++L4,this.fa=this.ia=!1}function bm(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function jE(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function V4(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function R1(t){const e={};for(const n in t)e[n]=t[n];return e}const ER="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A1(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<ER.length;s++)n=ER[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function km(t){this.src=t,this.g={},this.h=0}km.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=fv(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new M4(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function dv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=E1(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(bm(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function fv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var qE="closure_lm_"+(1e6*Math.random()|0),D_={};function C1(t,e,n,r,i){if(r&&r.once)return b1(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)C1(t,e[s],n,r,i);return null}return n=GE(n),t&&t[Qh]?t.O(e,n,Kh(r)?!!r.capture:!!r,i):P1(t,e,n,!1,r,i)}function P1(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Kh(i)?!!i.capture:!!i,a=HE(t);if(a||(t[qE]=a=new km(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=F4(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)b4||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(N1(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function F4(){function t(n){return e.call(t.src,t.listener,n)}const e=U4;return t}function b1(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)b1(t,e[s],n,r,i);return null}return n=GE(n),t&&t[Qh]?t.P(e,n,Kh(r)?!!r.capture:!!r,i):P1(t,e,n,!0,r,i)}function k1(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)k1(t,e[s],n,r,i);else r=Kh(r)?!!r.capture:!!r,n=GE(n),t&&t[Qh]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=fv(s,n,r,i),-1<n&&(bm(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=HE(t))&&(e=t.g[e.toString()],t=-1,e&&(t=fv(e,n,r,i)),(n=-1<t?e[t]:null)&&WE(n))}function WE(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Qh])dv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(N1(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=HE(e))?(dv(n,t),n.h==0&&(n.src=null,e[qE]=null)):bm(t)}}}function N1(t){return t in D_?D_[t]:D_[t]="on"+t}function U4(t,e){if(t.fa)t=!0;else{e=new Xc(e,this);var n=t.listener,r=t.la||t.src;t.ia&&WE(t),t=n.call(r,e)}return t}function HE(t){return t=t[qE],t instanceof km?t:null}var O_="__closure_events_fn_"+(1e9*Math.random()>>>0);function GE(t){return typeof t=="function"?t:(t[O_]||(t[O_]=function(e){return t.handleEvent(e)}),t[O_])}function Mt(){Qs.call(this),this.i=new km(this),this.S=this,this.J=null}Ft(Mt,Qs);Mt.prototype[Qh]=!0;Mt.prototype.removeEventListener=function(t,e,n,r){k1(this,t,e,n,r)};function Yt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new an(e,t);else if(e instanceof an)e.target=e.target||t;else{var i=e;e=new an(r,t),A1(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Xd(o,r,!0,e)&&i}if(o=e.g=t,i=Xd(o,r,!0,e)&&i,i=Xd(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Xd(o,r,!1,e)&&i}Mt.prototype.N=function(){if(Mt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)bm(n[r]);delete t.g[e],t.h--}}this.J=null};Mt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Mt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Xd(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&dv(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var KE=ie.JSON.stringify;class B4{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function $4(){var t=QE;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class z4{constructor(){this.h=this.g=null}add(e,n){const r=x1.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var x1=new B4(()=>new j4,t=>t.reset());class j4{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function q4(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function W4(t){ie.setTimeout(()=>{throw t},0)}let Zc,eh=!1,QE=new z4,D1=()=>{const t=ie.Promise.resolve(void 0);Zc=()=>{t.then(H4)}};var H4=()=>{for(var t;t=$4();){try{t.h.call(t.g)}catch(n){W4(n)}var e=x1;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}eh=!1};function Nm(t,e){Mt.call(this),this.h=t||1,this.g=e||ie,this.j=on(this.qb,this),this.l=Date.now()}Ft(Nm,Mt);B=Nm.prototype;B.ga=!1;B.T=null;B.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Yt(this,"tick"),this.ga&&(YE(this),this.start()))}};B.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function YE(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}B.N=function(){Nm.$.N.call(this),YE(this),delete this.g};function JE(t,e,n){if(typeof t=="function")n&&(t=on(t,n));else if(t&&typeof t.handleEvent=="function")t=on(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ie.setTimeout(t,e||0)}function O1(t){t.g=JE(()=>{t.g=null,t.i&&(t.i=!1,O1(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class G4 extends Qs{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:O1(this)}N(){super.N(),this.g&&(ie.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function th(t){Qs.call(this),this.h=t,this.g={}}Ft(th,Qs);var IR=[];function L1(t,e,n,r){Array.isArray(n)||(n&&(IR[0]=n.toString()),n=IR);for(var i=0;i<n.length;i++){var s=C1(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function M1(t){jE(t.g,function(e,n){this.g.hasOwnProperty(n)&&WE(e)},t),t.g={}}th.prototype.N=function(){th.$.N.call(this),M1(this)};th.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function xm(){this.g=!0}xm.prototype.Ea=function(){this.g=!1};function K4(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");o=2<=h.length&&h[1]=="type"?o+(c+"="+u+"&"):o+(c+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function Q4(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Ja(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+J4(t,n)+(r?" "+r:"")})}function Y4(t,e){t.info(function(){return"TIMEOUT: "+e})}xm.prototype.info=function(){};function J4(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return KE(n)}catch{return e}}var ca={},TR=null;function Dm(){return TR=TR||new Mt}ca.Ta="serverreachability";function V1(t){an.call(this,ca.Ta,t)}Ft(V1,an);function nh(t){const e=Dm();Yt(e,new V1(e))}ca.STAT_EVENT="statevent";function F1(t,e){an.call(this,ca.STAT_EVENT,t),this.stat=e}Ft(F1,an);function pn(t){const e=Dm();Yt(e,new F1(e,t))}ca.Ua="timingevent";function U1(t,e){an.call(this,ca.Ua,t),this.size=e}Ft(U1,an);function Yh(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ie.setTimeout(function(){t()},e)}var Om={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},B1={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function XE(){}XE.prototype.h=null;function SR(t){return t.h||(t.h=t.i())}function $1(){}var Jh={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ZE(){an.call(this,"d")}Ft(ZE,an);function eI(){an.call(this,"c")}Ft(eI,an);var pv;function Lm(){}Ft(Lm,XE);Lm.prototype.g=function(){return new XMLHttpRequest};Lm.prototype.i=function(){return{}};pv=new Lm;function Xh(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new th(this),this.P=X4,t=uv?125:void 0,this.V=new Nm(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new z1}function z1(){this.i=null,this.g="",this.h=!1}var X4=45e3,j1={},mv={};B=Xh.prototype;B.setTimeout=function(t){this.P=t};function gv(t,e,n){t.L=1,t.A=Vm(bi(e)),t.u=n,t.S=!0,q1(t,null)}function q1(t,e){t.G=Date.now(),Zh(t),t.B=bi(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),X1(n.i,"t",r),t.o=0,n=t.l.J,t.h=new z1,t.g=vN(t.l,n?e:null,!t.u),0<t.O&&(t.M=new G4(on(t.Pa,t,t.g),t.O)),L1(t.U,t.g,"readystatechange",t.nb),e=t.I?R1(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),nh(),K4(t.j,t.v,t.B,t.m,t.W,t.u)}B.nb=function(t){t=t.target;const e=this.M;e&&Hr(t)==3?e.l():this.Pa(t)};B.Pa=function(t){try{if(t==this.g)e:{const c=Hr(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>c)&&(c!=3||uv||this.g&&(this.h.h||this.g.ja()||PR(this.g)))){this.J||c!=4||e==7||(e==8||0>=h?nh(3):nh(2)),Mm(this);var n=this.g.da();this.ca=n;t:if(W1(this)){var r=PR(this.g);t="";var i=r.length,s=Hr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){To(this),dc(this);var o="";break t}this.h.i=new ie.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,Q4(this.j,this.v,this.B,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Jc(a)){var u=a;break t}}u=null}if(n=u)Ja(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_v(this,n);else{this.i=!1,this.s=3,pn(12),To(this),dc(this);break e}}this.S?(H1(this,c,o),uv&&this.i&&c==3&&(L1(this.U,this.V,"tick",this.mb),this.V.start())):(Ja(this.j,this.m,o,null),_v(this,o)),c==4&&To(this),this.i&&!this.J&&(c==4?mN(this.l,this):(this.i=!1,Zh(this)))}else vz(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,pn(12)):(this.s=0,pn(13)),To(this),dc(this)}}}catch{}finally{}};function W1(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function H1(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=Z4(t,n),i==mv){e==4&&(t.s=4,pn(14),r=!1),Ja(t.j,t.m,null,"[Incomplete Response]");break}else if(i==j1){t.s=4,pn(15),Ja(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ja(t.j,t.m,i,null),_v(t,i);W1(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,pn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),oI(e),e.M=!0,pn(11))):(Ja(t.j,t.m,n,"[Invalid Chunked Response]"),To(t),dc(t))}B.mb=function(){if(this.g){var t=Hr(this.g),e=this.g.ja();this.o<e.length&&(Mm(this),H1(this,t,e),this.i&&t!=4&&Zh(this))}};function Z4(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?mv:(n=Number(e.substring(n,r)),isNaN(n)?j1:(r+=1,r+n>e.length?mv:(e=e.slice(r,r+n),t.o=r+n,e)))}B.cancel=function(){this.J=!0,To(this)};function Zh(t){t.Y=Date.now()+t.P,G1(t,t.P)}function G1(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Yh(on(t.lb,t),e)}function Mm(t){t.C&&(ie.clearTimeout(t.C),t.C=null)}B.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(Y4(this.j,this.B),this.L!=2&&(nh(),pn(17)),To(this),this.s=2,dc(this)):G1(this,this.Y-t)};function dc(t){t.l.H==0||t.J||mN(t.l,t)}function To(t){Mm(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,YE(t.V),M1(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function _v(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||yv(n.i,t))){if(!t.K&&yv(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)wp(n),$m(n);else break e;sI(n),pn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Yh(on(n.ib,n),6e3));if(1>=tN(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else So(n,11)}else if((t.K||n.g==t)&&wp(n),!Jc(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];const c=u[3];c!=null&&(n.ra=c,n.l.info("VER="+n.ra));const h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const d=u[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(tI(s,s.h),s.h=null))}if(r.F){const m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.Da=m,$e(r.I,r.F,m))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=yN(r,r.J?r.pa:null,r.Y),o.K){nN(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.C&&(Mm(a),Zh(a)),r.g=o}else fN(r);0<n.j.length&&zm(n)}else u[0]!="stop"&&u[0]!="close"||So(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?So(n,7):iI(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}nh(4)}catch{}}function ez(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Cm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function tz(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Cm(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function K1(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Cm(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=tz(t),r=ez(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var Q1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nz(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function No(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof No){this.h=t.h,yp(this,t.j),this.s=t.s,this.g=t.g,vp(this,t.m),this.l=t.l;var e=t.i,n=new rh;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),RR(this,n),this.o=t.o}else t&&(e=String(t).match(Q1))?(this.h=!1,yp(this,e[1]||"",!0),this.s=Yu(e[2]||""),this.g=Yu(e[3]||"",!0),vp(this,e[4]),this.l=Yu(e[5]||"",!0),RR(this,e[6]||"",!0),this.o=Yu(e[7]||"")):(this.h=!1,this.i=new rh(null,this.h))}No.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ju(e,AR,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Ju(e,AR,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Ju(n,n.charAt(0)=="/"?sz:iz,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ju(n,az)),t.join("")};function bi(t){return new No(t)}function yp(t,e,n){t.j=n?Yu(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function vp(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function RR(t,e,n){e instanceof rh?(t.i=e,lz(t.i,t.h)):(n||(e=Ju(e,oz)),t.i=new rh(e,t.h))}function $e(t,e,n){t.i.set(e,n)}function Vm(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Yu(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ju(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,rz),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rz(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var AR=/[#\/\?@]/g,iz=/[#\?:]/g,sz=/[#\?]/g,oz=/[#\?@]/g,az=/#/g;function rh(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ys(t){t.g||(t.g=new Map,t.h=0,t.i&&nz(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}B=rh.prototype;B.add=function(t,e){Ys(this),this.i=null,t=Ql(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Y1(t,e){Ys(t),e=Ql(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function J1(t,e){return Ys(t),e=Ql(t,e),t.g.has(e)}B.forEach=function(t,e){Ys(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};B.ta=function(){Ys(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};B.Z=function(t){Ys(this);let e=[];if(typeof t=="string")J1(this,t)&&(e=e.concat(this.g.get(Ql(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};B.set=function(t,e){return Ys(this),this.i=null,t=Ql(this,t),J1(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};B.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function X1(t,e,n){Y1(t,e),0<n.length&&(t.i=null,t.g.set(Ql(t,e),$E(n)),t.h+=n.length)}B.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ql(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function lz(t,e){e&&!t.j&&(Ys(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(Y1(this,r),X1(this,i,n))},t)),t.j=e}var uz=class{constructor(t,e){this.g=t,this.map=e}};function Z1(t){this.l=t||cz,ie.PerformanceNavigationTiming?(t=ie.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ie.g&&ie.g.Ka&&ie.g.Ka()&&ie.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var cz=10;function eN(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function tN(t){return t.h?1:t.g?t.g.size:0}function yv(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function tI(t,e){t.g?t.g.add(e):t.h=e}function nN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Z1.prototype.cancel=function(){if(this.i=rN(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function rN(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return $E(t.i)}var hz=class{stringify(t){return ie.JSON.stringify(t,void 0)}parse(t){return ie.JSON.parse(t,void 0)}};function dz(){this.g=new hz}function fz(t,e,n){const r=n||"";try{K1(t,function(i,s){let o=i;Kh(i)&&(o=KE(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function pz(t,e){const n=new xm;if(ie.Image){const r=new Image;r.onload=Jd(Zd,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Jd(Zd,n,r,"TestLoadImage: error",!1,e),r.onabort=Jd(Zd,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Jd(Zd,n,r,"TestLoadImage: timeout",!1,e),ie.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Zd(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Fm(t){this.l=t.ec||null,this.j=t.ob||!1}Ft(Fm,XE);Fm.prototype.g=function(){return new Um(this.l,this.j)};Fm.prototype.i=function(t){return function(){return t}}({});function Um(t,e){Mt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=nI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ft(Um,Mt);var nI=0;B=Um.prototype;B.open=function(t,e){if(this.readyState!=nI)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ih(this)};B.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ie).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};B.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ed(this)),this.readyState=nI};B.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ih(this)),this.g&&(this.readyState=3,ih(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ie.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;iN(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function iN(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}B.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ed(this):ih(this),this.readyState==3&&iN(this)}};B.Za=function(t){this.g&&(this.response=this.responseText=t,ed(this))};B.Ya=function(t){this.g&&(this.response=t,ed(this))};B.ka=function(){this.g&&ed(this)};function ed(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ih(t)}B.setRequestHeader=function(t,e){this.v.append(t,e)};B.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};B.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function ih(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Um.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var mz=ie.JSON.parse;function at(t){Mt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=sN,this.L=this.M=!1}Ft(at,Mt);var sN="",gz=/^https?$/i,_z=["POST","PUT"];B=at.prototype;B.Oa=function(t){this.M=t};B.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():pv.g(),this.C=this.u?SR(this.u):SR(pv),this.g.onreadystatechange=on(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){CR(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ie.FormData&&t instanceof ie.FormData,!(0<=E1(_z,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{lN(this),0<this.B&&((this.L=yz(this.g))?(this.g.timeout=this.B,this.g.ontimeout=on(this.ua,this)):this.A=JE(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){CR(this,s)}};function yz(t){return El&&typeof t.timeout=="number"&&t.ontimeout!==void 0}B.ua=function(){typeof BE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Yt(this,"timeout"),this.abort(8))};function CR(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,oN(t),Bm(t)}function oN(t){t.F||(t.F=!0,Yt(t,"complete"),Yt(t,"error"))}B.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Yt(this,"complete"),Yt(this,"abort"),Bm(this))};B.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Bm(this,!0)),at.$.N.call(this)};B.La=function(){this.s||(this.G||this.v||this.l?aN(this):this.kb())};B.kb=function(){aN(this)};function aN(t){if(t.h&&typeof BE<"u"&&(!t.C[1]||Hr(t)!=4||t.da()!=2)){if(t.v&&Hr(t)==4)JE(t.La,0,t);else if(Yt(t,"readystatechange"),Hr(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(Q1)[1]||null;!i&&ie.self&&ie.self.location&&(i=ie.self.location.protocol.slice(0,-1)),r=!gz.test(i?i.toLowerCase():"")}n=r}if(n)Yt(t,"complete"),Yt(t,"success");else{t.m=6;try{var s=2<Hr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",oN(t)}}finally{Bm(t)}}}}function Bm(t,e){if(t.g){lN(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Yt(t,"ready");try{n.onreadystatechange=r}catch{}}}function lN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ie.clearTimeout(t.A),t.A=null)}B.isActive=function(){return!!this.g};function Hr(t){return t.g?t.g.readyState:0}B.da=function(){try{return 2<Hr(this)?this.g.status:-1}catch{return-1}};B.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};B.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),mz(e)}};function PR(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case sN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function vz(t){const e={};t=(t.g&&2<=Hr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Jc(t[r]))continue;var n=q4(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}V4(e,function(r){return r.join(", ")})}B.Ia=function(){return this.m};B.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function uN(t){let e="";return jE(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function rI(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=uN(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):$e(t,e,n))}function Nu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function cN(t){this.Ga=0,this.j=[],this.l=new xm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Nu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Nu("baseRetryDelayMs",5e3,t),this.hb=Nu("retryDelaySeedMs",1e4,t),this.eb=Nu("forwardChannelMaxRetries",2,t),this.xa=Nu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Z1(t&&t.concurrentRequestLimit),this.Ja=new dz,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}B=cN.prototype;B.ra=8;B.H=1;function iI(t){if(hN(t),t.H==3){var e=t.W++,n=bi(t.I);if($e(n,"SID",t.K),$e(n,"RID",e),$e(n,"TYPE","terminate"),td(t,n),e=new Xh(t,t.l,e),e.L=2,e.A=Vm(bi(n)),n=!1,ie.navigator&&ie.navigator.sendBeacon)try{n=ie.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&ie.Image&&(new Image().src=e.A,n=!0),n||(e.g=vN(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Zh(e)}_N(t)}function $m(t){t.g&&(oI(t),t.g.cancel(),t.g=null)}function hN(t){$m(t),t.u&&(ie.clearTimeout(t.u),t.u=null),wp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ie.clearTimeout(t.m),t.m=null)}function zm(t){if(!eN(t.i)&&!t.m){t.m=!0;var e=t.Na;Zc||D1(),eh||(Zc(),eh=!0),QE.add(e,t),t.C=0}}function wz(t,e){return tN(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Yh(on(t.Na,t,e),gN(t,t.C)),t.C++,!0)}B.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new Xh(this,this.l,t);let s=this.s;if(this.U&&(s?(s=R1(s),A1(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=dN(this,i,e),n=bi(this.I),$e(n,"RID",t),$e(n,"CVER",22),this.F&&$e(n,"X-HTTP-Session-Id",this.F),td(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(uN(s)))+"&"+e:this.o&&rI(n,this.o,s)),tI(this.i,i),this.bb&&$e(n,"TYPE","init"),this.P?($e(n,"$req",e),$e(n,"SID","null"),i.aa=!0,gv(i,n,null)):gv(i,n,e),this.H=2}}else this.H==3&&(t?bR(this,t):this.j.length==0||eN(this.i)||bR(this))};function bR(t,e){var n;e?n=e.m:n=t.W++;const r=bi(t.I);$e(r,"SID",t.K),$e(r,"RID",n),$e(r,"AID",t.V),td(t,r),t.o&&t.s&&rI(r,t.o,t.s),n=new Xh(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=dN(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),tI(t.i,n),gv(n,r,e)}function td(t,e){t.na&&jE(t.na,function(n,r){$e(e,r,n)}),t.h&&K1({},function(n,r){$e(e,r,n)})}function dN(t,e,n){n=Math.min(t.j.length,n);var r=t.h?on(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let u=i[l].g;const c=i[l].map;if(u-=s,0>u)s=Math.max(0,i[l].g-100),a=!1;else try{fz(c,o,"req"+u+"_")}catch{r&&r(c)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function fN(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Zc||D1(),eh||(Zc(),eh=!0),QE.add(e,t),t.A=0}}function sI(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Yh(on(t.Ma,t),gN(t,t.A)),t.A++,!0)}B.Ma=function(){if(this.u=null,pN(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Yh(on(this.jb,this),t)}};B.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,pn(10),$m(this),pN(this))};function oI(t){t.B!=null&&(ie.clearTimeout(t.B),t.B=null)}function pN(t){t.g=new Xh(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=bi(t.wa);$e(e,"RID","rpc"),$e(e,"SID",t.K),$e(e,"AID",t.V),$e(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&$e(e,"TO",t.qa),$e(e,"TYPE","xmlhttp"),td(t,e),t.o&&t.s&&rI(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Vm(bi(e)),n.u=null,n.S=!0,q1(n,t)}B.ib=function(){this.v!=null&&(this.v=null,$m(this),sI(this),pn(19))};function wp(t){t.v!=null&&(ie.clearTimeout(t.v),t.v=null)}function mN(t,e){var n=null;if(t.g==e){wp(t),oI(t),t.g=null;var r=2}else if(yv(t.i,e))n=e.F,nN(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=Dm(),Yt(r,new U1(r,n)),zm(t)}else fN(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&wz(t,e)||r==2&&sI(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:So(t,5);break;case 4:So(t,10);break;case 3:So(t,6);break;default:So(t,2)}}}function gN(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function So(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=on(t.pb,t);n||(n=new No("//www.google.com/images/cleardot.gif"),ie.location&&ie.location.protocol=="http"||yp(n,"https"),Vm(n)),pz(n.toString(),r)}else pn(2);t.H=0,t.h&&t.h.za(e),_N(t),hN(t)}B.pb=function(t){t?(this.l.info("Successfully pinged google.com"),pn(2)):(this.l.info("Failed to ping google.com"),pn(1))};function _N(t){if(t.H=0,t.ma=[],t.h){const e=rN(t.i);(e.length!=0||t.j.length!=0)&&(vR(t.ma,e),vR(t.ma,t.j),t.i.i.length=0,$E(t.j),t.j.length=0),t.h.ya()}}function yN(t,e,n){var r=n instanceof No?bi(n):new No(n);if(r.g!="")e&&(r.g=e+"."+r.g),vp(r,r.m);else{var i=ie.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new No(null);r&&yp(s,r),e&&(s.g=e),i&&vp(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&$e(r,n,e),$e(r,"VER",t.ra),td(t,r),r}function vN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new at(new Fm({ob:n})):new at(t.va),e.Oa(t.J),e}B.isActive=function(){return!!this.h&&this.h.isActive(this)};function wN(){}B=wN.prototype;B.Ba=function(){};B.Aa=function(){};B.za=function(){};B.ya=function(){};B.isActive=function(){return!0};B.Va=function(){};function Ep(){if(El&&!(10<=Number(D4)))throw Error("Environmental error: no available transport.")}Ep.prototype.g=function(t,e){return new Kn(t,e)};function Kn(t,e){Mt.call(this),this.g=new cN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Jc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Jc(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Yl(this)}Ft(Kn,Mt);Kn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;pn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=yN(t,null,t.Y),zm(t)};Kn.prototype.close=function(){iI(this.g)};Kn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=KE(t),t=n);e.j.push(new uz(e.fb++,t)),e.H==3&&zm(e)};Kn.prototype.N=function(){this.g.h=null,delete this.j,iI(this.g),delete this.g,Kn.$.N.call(this)};function EN(t){ZE.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ft(EN,ZE);function IN(){eI.call(this),this.status=1}Ft(IN,eI);function Yl(t){this.g=t}Ft(Yl,wN);Yl.prototype.Ba=function(){Yt(this.g,"a")};Yl.prototype.Aa=function(t){Yt(this.g,new EN(t))};Yl.prototype.za=function(t){Yt(this.g,new IN)};Yl.prototype.ya=function(){Yt(this.g,"b")};function Ez(){this.blockSize=-1}function kr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ft(kr,Ez);kr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function L_(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}kr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)L_(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){L_(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){L_(this,r),i=0;break}}this.h=i,this.i+=e};kr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function be(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var Iz={};function aI(t){return-128<=t&&128>t?k4(t,function(e){return new be([e|0],0>e?-1:0)}):new be([t|0],0>t?-1:0)}function Gr(t){if(isNaN(t)||!isFinite(t))return il;if(0>t)return Ht(Gr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=vv;return new be(e,0)}function TN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Ht(TN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Gr(Math.pow(e,8)),r=il,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Gr(Math.pow(e,s)),r=r.R(s).add(Gr(o))):(r=r.R(n),r=r.add(Gr(o)))}return r}var vv=4294967296,il=aI(0),wv=aI(1),kR=aI(16777216);B=be.prototype;B.ea=function(){if(rr(this))return-Ht(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:vv+r)*e,e*=vv}return t};B.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(pi(this))return"0";if(rr(this))return"-"+Ht(this).toString(t);for(var e=Gr(Math.pow(t,6)),n=this,r="";;){var i=Tp(n,e).g;n=Ip(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,pi(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};B.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function pi(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function rr(t){return t.h==-1}B.X=function(t){return t=Ip(this,t),rr(t)?-1:pi(t)?0:1};function Ht(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new be(n,~t.h).add(wv)}B.abs=function(){return rr(this)?Ht(this):this};B.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new be(n,n[n.length-1]&-2147483648?-1:0)};function Ip(t,e){return t.add(Ht(e))}B.R=function(t){if(pi(this)||pi(t))return il;if(rr(this))return rr(t)?Ht(this).R(Ht(t)):Ht(Ht(this).R(t));if(rr(t))return Ht(this.R(Ht(t)));if(0>this.X(kR)&&0>t.X(kR))return Gr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=o*l,ef(n,2*r+2*i),n[2*r+2*i+1]+=s*l,ef(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,ef(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,ef(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new be(n,0)};function ef(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function xu(t,e){this.g=t,this.h=e}function Tp(t,e){if(pi(e))throw Error("division by zero");if(pi(t))return new xu(il,il);if(rr(t))return e=Tp(Ht(t),e),new xu(Ht(e.g),Ht(e.h));if(rr(e))return e=Tp(t,Ht(e)),new xu(Ht(e.g),e.h);if(30<t.g.length){if(rr(t)||rr(e))throw Error("slowDivide_ only works with positive integers.");for(var n=wv,r=e;0>=r.X(t);)n=NR(n),r=NR(r);var i=Sa(n,1),s=Sa(r,1);for(r=Sa(r,2),n=Sa(n,2);!pi(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Sa(r,1),n=Sa(n,1)}return e=Ip(t,i.R(e)),new xu(i,e)}for(i=il;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Gr(n),o=s.R(e);rr(o)||0<o.X(t);)n-=r,s=Gr(n),o=s.R(e);pi(s)&&(s=wv),i=i.add(s),t=Ip(t,o)}return new xu(i,t)}B.gb=function(t){return Tp(this,t).h};B.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new be(n,this.h&t.h)};B.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new be(n,this.h|t.h)};B.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new be(n,this.h^t.h)};function NR(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new be(n,t.h)}function Sa(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new be(i,t.h)}Ep.prototype.createWebChannel=Ep.prototype.g;Kn.prototype.send=Kn.prototype.u;Kn.prototype.open=Kn.prototype.m;Kn.prototype.close=Kn.prototype.close;Om.NO_ERROR=0;Om.TIMEOUT=8;Om.HTTP_ERROR=6;B1.COMPLETE="complete";$1.EventType=Jh;Jh.OPEN="a";Jh.CLOSE="b";Jh.ERROR="c";Jh.MESSAGE="d";Mt.prototype.listen=Mt.prototype.O;at.prototype.listenOnce=at.prototype.P;at.prototype.getLastError=at.prototype.Sa;at.prototype.getLastErrorCode=at.prototype.Ia;at.prototype.getStatus=at.prototype.da;at.prototype.getResponseJson=at.prototype.Wa;at.prototype.getResponseText=at.prototype.ja;at.prototype.send=at.prototype.ha;at.prototype.setWithCredentials=at.prototype.Oa;kr.prototype.digest=kr.prototype.l;kr.prototype.reset=kr.prototype.reset;kr.prototype.update=kr.prototype.j;be.prototype.add=be.prototype.add;be.prototype.multiply=be.prototype.R;be.prototype.modulo=be.prototype.gb;be.prototype.compare=be.prototype.X;be.prototype.toNumber=be.prototype.ea;be.prototype.toString=be.prototype.toString;be.prototype.getBits=be.prototype.D;be.fromNumber=Gr;be.fromString=TN;var Tz=function(){return new Ep},Sz=function(){return Dm()},M_=Om,Rz=B1,Az=ca,xR={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},tf=$1,Cz=at,Pz=kr,sl=be,bz={};const DR="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Nt.UNAUTHENTICATED=new Nt(null),Nt.GOOGLE_CREDENTIALS=new Nt("google-credentials-uid"),Nt.FIRST_PARTY=new Nt("first-party-uid"),Nt.MOCK_USER=new Nt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jl="10.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns=new Kl("@firebase/firestore");function Na(){return Ns.logLevel}function kz(t){Ns.setLogLevel(t)}function N(t,...e){if(Ns.logLevel<=de.DEBUG){const n=e.map(lI);Ns.debug(`Firestore (${Jl}): ${t}`,...n)}}function pt(t,...e){if(Ns.logLevel<=de.ERROR){const n=e.map(lI);Ns.error(`Firestore (${Jl}): ${t}`,...n)}}function Nr(t,...e){if(Ns.logLevel<=de.WARN){const n=e.map(lI);Ns.warn(`Firestore (${Jl}): ${t}`,...n)}}function lI(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q(t="Unexpected state"){const e=`FIRESTORE (${Jl}) INTERNAL ASSERTION FAILED: `+t;throw pt(e),new Error(e)}function Q(t,e){t||q()}function Nz(t,e){t||q()}function U(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends _n{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xz{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Nt.UNAUTHENTICATED))}shutdown(){}}class Dz{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Oz{constructor(e){this.t=e,this.currentUser=Nt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Lt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Lt,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Lt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Q(typeof r.accessToken=="string"),new SN(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Q(e===null||typeof e=="string"),new Nt(e)}}class Lz{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Nt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Mz{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Lz(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Nt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Vz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Fz{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,N("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Q(typeof n.token=="string"),this.R=n.token,new Vz(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=Uz(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function se(t,e){return t<e?-1:t>e?1:0}function Il(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function AN(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new k(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new k(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new k(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Qe.fromMillis(Date.now())}static fromDate(e){return Qe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Qe(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Y(e)}static min(){return new Y(new Qe(0,0))}static max(){return new Y(new Qe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,n,r){n===void 0?n=0:n>e.length&&q(),r===void 0?r=e.length-n:r>e.length-n&&q(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return sh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof sh?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class we extends sh{construct(e,n,r){return new we(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new k(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new we(n)}static emptyPath(){return new we([])}}const Bz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class He extends sh{construct(e,n,r){return new He(e,n,r)}static isValidIdentifier(e){return Bz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),He.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new He(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new k(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new k(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new k(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new k(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new He(n)}static emptyPath(){return new He([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.path=e}static fromPath(e){return new V(we.fromString(e))}static fromName(e){return new V(we.fromString(e).popFirst(5))}static empty(){return new V(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return we.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new V(new we(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Ev(t){return t.fields.find(e=>e.kind===2)}function uo(t){return t.fields.filter(e=>e.kind!==2)}Sp.UNKNOWN_ID=-1;class Cf{constructor(e,n){this.fieldPath=e,this.kind=n}}class oh{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new oh(0,Qn.min())}}function CN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Y.fromTimestamp(r===1e9?new Qe(n+1,0):new Qe(n,r));return new Qn(i,V.empty(),e)}function PN(t){return new Qn(t.readTime,t.key,-1)}class Qn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Qn(Y.min(),V.empty(),-1)}static max(){return new Qn(Y.max(),V.empty(),-1)}}function uI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=V.comparator(t.documentKey,e.documentKey),n!==0?n:se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class kN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Js(t){if(t.code!==R.FAILED_PRECONDITION||t.message!==bN)throw t;N("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new I((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof I?n:I.resolve(n)}catch(n){return I.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):I.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):I.reject(n)}static resolve(e){return new I((n,r)=>{n(e)})}static reject(e){return new I((n,r)=>{r(e)})}static waitFor(e){return new I((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=I.resolve(!1);for(const r of e)n=n.next(i=>i?I.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new I((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(c=>{o[u]=c,++a,a===s&&r(o)},c=>i(c))}})}static doWhile(e,n){return new I((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Lt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new fc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=cI(r.target.error);this.V.reject(new fc(e,i))}}static open(e,n,r,i){try{return new jm(n,e.transaction(i,r))}catch(s){throw new fc(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(N("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new zz(n)}}class Sr{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Sr.S(tt())===12.2&&pt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return N("SimpleDb","Removing database:",e),ho(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Gc())return!1;if(Sr.C())return!0;const e=tt(),n=Sr.S(e),r=0<n&&n<10,i=Sr.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=bz)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(N("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new fc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new k(R.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new k(R.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new fc(e,o))},i.onupgradeneeded=s=>{N("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{N("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.O(e);const a=jm.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),I.reject(u))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(N("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}class $z{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return ho(this.k.delete())}}class fc extends k{constructor(e,n){super(R.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Xs(t){return t.name==="IndexedDbTransactionError"}class zz{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(N("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(N("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ho(r)}add(e){return N("SimpleDb","ADD",this.store.name,e,e),ho(this.store.add(e))}get(e){return ho(this.store.get(e)).next(n=>(n===void 0&&(n=null),N("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return N("SimpleDb","DELETE",this.store.name,e),ho(this.store.delete(e))}count(){return N("SimpleDb","COUNT",this.store.name),ho(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new I((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new I((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){N("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Z(e){const n=this.cursor({});return new I((r,i)=>{n.onerror=s=>{const o=cI(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){const r=[];return new I((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new $z(a),u=n(a.primaryKey,a.value,l);if(u instanceof I){const c=u.catch(h=>(l.done(),I.reject(h)));r.push(c)}l.isDone?i():l.$===null?a.continue():a.continue(l.$)}}).next(()=>I.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ho(t){return new I((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=cI(r.target.error);n(i)}})}let OR=!1;function cI(t){const e=Sr.S(tt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return OR||(OR=!0,setTimeout(()=>{throw r},0)),r}}return t}class jz{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){N("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{N("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(n){Xs(n)?N("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await Js(n)}await this.ee(6e4)})}}class qz{constructor(e,n){this.localStore=e,this.persistence=n}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))}ne(e,n){const r=new Set;let i=n,s=!0;return I.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return N("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(N("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=PN(s);uI(o,r)>0&&(r=o)}),new Qn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.se(r),this.oe=r=>n.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}bn._e=-1;function nd(t){return t==null}function ah(t){return t===0&&1/t==-1/0}function NN(t){return typeof t=="number"&&Number.isInteger(t)&&!ah(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=LR(e)),e=Wz(t.get(n),e);return LR(e)}function Wz(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function LR(t){return t+""}function Kr(t){const e=t.length;if(Q(e>=2),e===2)return Q(t.charAt(0)===""&&t.charAt(1)===""),we.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&q(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:q()}s=o+2}return new we(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pf(t,e){return[t,yn(e)]}function xN(t,e,n){return[t,yn(e),n]}const Hz={},Gz=["prefixPath","collectionGroup","readTime","documentId"],Kz=["prefixPath","collectionGroup","documentId"],Qz=["collectionGroup","readTime","prefixPath","documentId"],Yz=["canonicalId","targetId"],Jz=["targetId","path"],Xz=["path","targetId"],Zz=["collectionId","parent"],ej=["indexId","uid"],tj=["uid","sequenceNumber"],nj=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rj=["indexId","uid","orderedDocumentKey"],ij=["userId","collectionPath","documentId"],sj=["userId","collectionPath","largestBatchId"],oj=["userId","collectionGroup","largestBatchId"],DN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],aj=[...DN,"documentOverlays"],ON=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],LN=ON,lj=[...LN,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv extends kN{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}}function Ut(t,e){const n=U(t);return Sr.M(n.ae,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ha(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function MN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nt=class Tv{constructor(e,n){this.comparator=e,this.root=n||Is.EMPTY}insert(e,n){return new Tv(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Is.BLACK,null,null))}remove(e){return new Tv(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Is.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nf(this.root,e,this.comparator,!1)}getReverseIterator(){return new nf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nf(this.root,e,this.comparator,!0)}},nf=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Is=class ui{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??ui.RED,this.left=i??ui.EMPTY,this.right=s??ui.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new ui(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ui.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return ui.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ui.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ui.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();const e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}};Is.EMPTY=null,Is.RED=!0,Is.BLACK=!1;Is.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Is(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.comparator=e,this.data=new nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new FR(this.data.getIterator())}getIteratorFrom(e){return new FR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ne)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ne(this.comparator);return n.data=e,n}}class FR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ra(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.fields=e,e.sort(He.comparator)}static empty(){return new kn([])}unionWith(e){let n=new Ne(He.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new kn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Il(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uj(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new VN("Invalid base64 string: "+s):s}}(e);return new Tt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Tt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const cj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xs(t){if(Q(!!t),typeof t=="string"){let e=0;const n=cj.exec(t);if(Q(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ot(t.seconds),nanos:ot(t.nanos)}}function ot(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ds(t){return typeof t=="string"?Tt.fromBase64String(t):Tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function hI(t){const e=t.mapValue.fields.__previous_value__;return qm(e)?hI(e):e}function lh(t){const e=xs(t.mapValue.fields.__local_write_time__.timestampValue);return new Qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e,n,r,i,s,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Os{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Os("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Os&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},bf={nullValue:"NULL_VALUE"};function qo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qm(t)?4:FN(t)?9007199254740991:10:q()}function ti(t,e){if(t===e)return!0;const n=qo(t);if(n!==qo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return lh(t).isEqual(lh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=xs(i.timestampValue),a=xs(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ds(i.bytesValue).isEqual(Ds(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ot(i.geoPointValue.latitude)===ot(s.geoPointValue.latitude)&&ot(i.geoPointValue.longitude)===ot(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ot(i.integerValue)===ot(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ot(i.doubleValue),a=ot(s.doubleValue);return o===a?ah(o)===ah(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Il(t.arrayValue.values||[],e.arrayValue.values||[],ti);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(VR(o)!==VR(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ti(o[l],a[l])))return!1;return!0}(t,e);default:return q()}}function uh(t,e){return(t.values||[]).find(n=>ti(n,e))!==void 0}function Ls(t,e){if(t===e)return 0;const n=qo(t),r=qo(e);if(n!==r)return se(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return se(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ot(s.integerValue||s.doubleValue),l=ot(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return UR(t.timestampValue,e.timestampValue);case 4:return UR(lh(t),lh(e));case 5:return se(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Ds(s),l=Ds(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const c=se(a[u],l[u]);if(c!==0)return c}return se(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=se(ot(s.latitude),ot(o.latitude));return a!==0?a:se(ot(s.longitude),ot(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],l=o.values||[];for(let u=0;u<a.length&&u<l.length;++u){const c=Ls(a[u],l[u]);if(c)return c}return se(a.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===ls.mapValue&&o===ls.mapValue)return 0;if(s===ls.mapValue)return 1;if(o===ls.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},c=Object.keys(u);l.sort(),c.sort();for(let h=0;h<l.length&&h<c.length;++h){const d=se(l[h],c[h]);if(d!==0)return d;const f=Ls(a[l[h]],u[c[h]]);if(f!==0)return f}return se(l.length,c.length)}(t.mapValue,e.mapValue);default:throw q()}}function UR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return se(t,e);const n=xs(t),r=xs(e),i=se(n.seconds,r.seconds);return i!==0?i:se(n.nanos,r.nanos)}function Tl(t){return Sv(t)}function Sv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=xs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ds(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return V.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Sv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Sv(n.fields[o])}`;return i+"}"}(t.mapValue):q()}function Wo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Rv(t){return!!t&&"integerValue"in t}function ch(t){return!!t&&"arrayValue"in t}function BR(t){return!!t&&"nullValue"in t}function $R(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kf(t){return!!t&&"mapValue"in t}function pc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ha(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=pc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=pc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function FN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function dj(t){return"nullValue"in t?bf:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Wo(Os.empty(),V.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:q()}function fj(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Wo(Os.empty(),V.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?ls:q()}function zR(t,e){const n=Ls(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function jR(t,e){const n=Ls(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.value=e}static empty(){return new Kt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=pc(n)}setAll(e){let n=He.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=pc(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());kf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ti(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];kf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ha(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Kt(pc(this.value))}}function UN(t){const e=[];return ha(t.fields,(n,r)=>{const i=new He([n]);if(kf(r)){const s=UN(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new kn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ze(e,0,Y.min(),Y.min(),Y.min(),Kt.empty(),0)}static newFoundDocument(e,n,r,i){return new ze(e,1,n,Y.min(),r,i,0)}static newNoDocument(e,n){return new ze(e,2,n,Y.min(),Y.min(),Kt.empty(),0)}static newUnknownDocument(e,n){return new ze(e,3,n,Y.min(),Y.min(),Kt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ze&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ze(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,n){this.position=e,this.inclusive=n}}function qR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=V.comparator(V.fromName(o.referenceValue),n.key):r=Ls(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function WR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ti(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,n="asc"){this.field=e,this.dir=n}}function pj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{}class me extends BN{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new mj(e,n,r):n==="array-contains"?new yj(e,r):n==="in"?new HN(e,r):n==="not-in"?new vj(e,r):n==="array-contains-any"?new wj(e,r):new me(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new gj(e,r):new _j(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ls(n,this.value)):n!==null&&qo(this.value)===qo(n)&&this.matchesComparison(Ls(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ce extends BN{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new Ce(e,n)}matches(e){return Sl(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Sl(t){return t.op==="and"}function Av(t){return t.op==="or"}function dI(t){return $N(t)&&Sl(t)}function $N(t){for(const e of t.filters)if(e instanceof Ce)return!1;return!0}function Cv(t){if(t instanceof me)return t.field.canonicalString()+t.op.toString()+Tl(t.value);if(dI(t))return t.filters.map(e=>Cv(e)).join(",");{const e=t.filters.map(n=>Cv(n)).join(",");return`${t.op}(${e})`}}function zN(t,e){return t instanceof me?function(r,i){return i instanceof me&&r.op===i.op&&r.field.isEqual(i.field)&&ti(r.value,i.value)}(t,e):t instanceof Ce?function(r,i){return i instanceof Ce&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&zN(o,i.filters[a]),!0):!1}(t,e):void q()}function jN(t,e){const n=t.filters.concat(e);return Ce.create(n,t.op)}function qN(t){return t instanceof me?function(n){return`${n.field.canonicalString()} ${n.op} ${Tl(n.value)}`}(t):t instanceof Ce?function(n){return n.op.toString()+" {"+n.getFilters().map(qN).join(" ,")+"}"}(t):"Filter"}class mj extends me{constructor(e,n,r){super(e,n,r),this.key=V.fromName(r.referenceValue)}matches(e){const n=V.comparator(e.key,this.key);return this.matchesComparison(n)}}class gj extends me{constructor(e,n){super(e,"in",n),this.keys=WN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class _j extends me{constructor(e,n){super(e,"not-in",n),this.keys=WN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function WN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>V.fromName(r.referenceValue))}class yj extends me{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ch(n)&&uh(n.arrayValue,this.value)}}class HN extends me{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&uh(this.value.arrayValue,n)}}class vj extends me{constructor(e,n){super(e,"not-in",n)}matches(e){if(uh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!uh(this.value.arrayValue,n)}}class wj extends me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ch(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>uh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function Pv(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Ej(t,e,n,r,i,s,o)}function Ho(t){const e=U(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Cv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),nd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Tl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Tl(r)).join(",")),e.ce=n}return e.ce}function rd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!pj(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!zN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!WR(t.startAt,e.startAt)&&WR(t.endAt,e.endAt)}function Rp(t){return V.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Ap(t,e){return t.filters.filter(n=>n instanceof me&&n.field.isEqual(e))}function HR(t,e,n){let r=bf,i=!0;for(const s of Ap(t,e)){let o=bf,a=!0;switch(s.op){case"<":case"<=":o=dj(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=bf}zR({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];zR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function GR(t,e,n){let r=ls,i=!0;for(const s of Ap(t,e)){let o=ls,a=!0;switch(s.op){case">=":case">":o=fj(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ls}jR({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];jR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function GN(t,e,n,r,i,s,o,a){return new Mi(t,e,n,r,i,s,o,a)}function Xl(t){return new Mi(t)}function KR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function fI(t){return t.collectionGroup!==null}function ol(t){const e=U(t);if(e.le===null){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ne(He.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new hh(s,r))}),n.has(He.keyField().canonicalString())||e.le.push(new hh(He.keyField(),r))}return e.le}function vn(t){const e=U(t);return e.he||(e.he=Ij(e,ol(t))),e.he}function Ij(t,e){if(t.limitType==="F")return Pv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new hh(i.field,s)});const n=t.endAt?new Ms(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ms(t.startAt.position,t.startAt.inclusive):null;return Pv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function bv(t,e){const n=t.filters.concat([e]);return new Mi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Cp(t,e,n){return new Mi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function id(t,e){return rd(vn(t),vn(e))&&t.limitType===e.limitType}function KN(t){return`${Ho(vn(t))}|lt:${t.limitType}`}function xa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>qN(i)).join(", ")}]`),nd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Tl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Tl(i)).join(",")),`Target(${r})`}(vn(t))}; limitType=${t.limitType})`}function sd(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):V.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of ol(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=qR(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,ol(r),i)||r.endAt&&!function(o,a,l){const u=qR(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,ol(r),i))}(t,e)}function QN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function YN(t){return(e,n)=>{let r=!1;for(const i of ol(t)){const s=Tj(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Tj(t,e,n){const r=t.field.isKeyField()?V.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Ls(l,u):q()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ha(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return MN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj=new nt(V.comparator);function Nn(){return Sj}const JN=new nt(V.comparator);function Xu(...t){let e=JN;for(const n of t)e=e.insert(n.key,n);return e}function XN(t){let e=JN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Qr(){return mc()}function ZN(){return mc()}function mc(){return new Zs(t=>t.toString(),(t,e)=>t.isEqual(e))}const Rj=new nt(V.comparator),Aj=new Ne(V.comparator);function ae(...t){let e=Aj;for(const n of t)e=e.add(n);return e}const Cj=new Ne(se);function pI(){return Cj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ah(e)?"-0":e}}function tx(t){return{integerValue:""+t}}function nx(t,e){return NN(e)?tx(e):ex(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(){this._=void 0}}function Pj(t,e,n){return t instanceof Rl?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&qm(s)&&(s=hI(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Go?ix(t,e):t instanceof Ko?sx(t,e):function(i,s){const o=rx(i,s),a=QR(o)+QR(i.Ie);return Rv(o)&&Rv(i.Ie)?tx(a):ex(i.serializer,a)}(t,e)}function bj(t,e,n){return t instanceof Go?ix(t,e):t instanceof Ko?sx(t,e):n}function rx(t,e){return t instanceof Al?function(r){return Rv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Rl extends Wm{}class Go extends Wm{constructor(e){super(),this.elements=e}}function ix(t,e){const n=ox(e);for(const r of t.elements)n.some(i=>ti(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ko extends Wm{constructor(e){super(),this.elements=e}}function sx(t,e){let n=ox(e);for(const r of t.elements)n=n.filter(i=>!ti(i,r));return{arrayValue:{values:n}}}class Al extends Wm{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function QR(t){return ot(t.integerValue||t.doubleValue)}function ox(t){return ch(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,n){this.field=e,this.transform=n}}function kj(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Go&&i instanceof Go||r instanceof Ko&&i instanceof Ko?Il(r.elements,i.elements,ti):r instanceof Al&&i instanceof Al?ti(r.Ie,i.Ie):r instanceof Rl&&i instanceof Rl}(t.transform,e.transform)}class Nj{constructor(e,n){this.version=e,this.transformResults=n}}class Ge{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ge}static exists(e){return new Ge(void 0,e)}static updateTime(e){return new Ge(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Hm{}function ax(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new eu(t.key,Ge.none()):new Zl(t.key,t.data,Ge.none());{const n=t.data,r=Kt.empty();let i=new Ne(He.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Vi(t.key,r,new kn(i.toArray()),Ge.none())}}function xj(t,e,n){t instanceof Zl?function(i,s,o){const a=i.value.clone(),l=JR(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Vi?function(i,s,o){if(!Nf(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=JR(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(lx(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function gc(t,e,n,r){return t instanceof Zl?function(s,o,a,l){if(!Nf(s.precondition,o))return a;const u=s.value.clone(),c=XR(s.fieldTransforms,l,o);return u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Vi?function(s,o,a,l){if(!Nf(s.precondition,o))return a;const u=XR(s.fieldTransforms,l,o),c=o.data;return c.setAll(lx(s)),c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return Nf(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function Dj(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=rx(r.transform,i||null);s!=null&&(n===null&&(n=Kt.empty()),n.set(r.field,s))}return n||null}function YR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Il(r,i,(s,o)=>kj(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Zl extends Hm{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Vi extends Hm{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function lx(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function JR(t,e,n){const r=new Map;Q(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,bj(o,a,n[i]))}return r}function XR(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,Pj(s,o,e))}return r}class eu extends Hm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mI extends Hm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&xj(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=gc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=gc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=ZN();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=ax(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Y.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ae())}isEqual(e){return this.batchId===e.batchId&&Il(this.mutations,e.mutations,(n,r)=>YR(n,r))&&Il(this.baseMutations,e.baseMutations,(n,r)=>YR(n,r))}}class _I{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Q(e.mutations.length===r.length);let i=function(){return Rj}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new _I(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt,ye;function ux(t){switch(t){default:return q();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function cx(t){if(t===void 0)return pt("GRPC error has no .code"),R.UNKNOWN;switch(t){case gt.OK:return R.OK;case gt.CANCELLED:return R.CANCELLED;case gt.UNKNOWN:return R.UNKNOWN;case gt.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case gt.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case gt.INTERNAL:return R.INTERNAL;case gt.UNAVAILABLE:return R.UNAVAILABLE;case gt.UNAUTHENTICATED:return R.UNAUTHENTICATED;case gt.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case gt.NOT_FOUND:return R.NOT_FOUND;case gt.ALREADY_EXISTS:return R.ALREADY_EXISTS;case gt.PERMISSION_DENIED:return R.PERMISSION_DENIED;case gt.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case gt.ABORTED:return R.ABORTED;case gt.OUT_OF_RANGE:return R.OUT_OF_RANGE;case gt.UNIMPLEMENTED:return R.UNIMPLEMENTED;case gt.DATA_LOSS:return R.DATA_LOSS;default:return q()}}(ye=gt||(gt={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hx(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj=new sl([4294967295,4294967295],0);function ZR(t){const e=hx().encode(t),n=new Pz;return n.update(e),new Uint8Array(n.digest())}function eA(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new sl([n,r],0),new sl([i,s],0)]}class vI{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Zu(`Invalid padding: ${n}`);if(r<0)throw new Zu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Zu(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Zu(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=sl.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(sl.fromNumber(r)));return i.compare(Lj)===1&&(i=new sl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=ZR(e),[r,i]=eA(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new vI(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const n=ZR(e),[r,i]=eA(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Zu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,ld.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ad(Y.min(),i,new nt(se),Nn(),ae())}}class ld{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ld(r,n,ae(),ae(),ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class dx{constructor(e,n){this.targetId=e,this.fe=n}}class fx{constructor(e,n,r=Tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class tA{constructor(){this.ge=0,this.pe=rA(),this.ye=Tt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ae(),n=ae(),r=ae();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:q()}}),new ld(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=rA()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,Q(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Mj{constructor(e){this.Le=e,this.ke=new Map,this.qe=Nn(),this.Qe=nA(),this.Ke=new nt(se)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if(Rp(s))if(r===0){const o=new V(s.path);this.We(n,o,ze.newNoDocument(o,Y.min()))}else Q(r===1);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Ds(r).toUint8Array()}catch(l){if(l instanceof VN)return Nr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new vI(o,i,s)}catch(l){return Nr(l instanceof Zu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Rp(a.target)){const l=new V(a.target.path);this.qe.get(l)!==null||this.st(o,l)||this.We(o,l,ze.newNoDocument(l,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=ae();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Ye(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new ad(e,n,this.Ke,this.qe,r);return this.qe=Nn(),this.Qe=nA(),this.Ke=new nt(se),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new tA,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Ne(se),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||N("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new tA),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function nA(){return new nt(V.comparator)}function rA(){return new nt(V.comparator)}const Vj={asc:"ASCENDING",desc:"DESCENDING"},Fj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Uj={and:"AND",or:"OR"};class Bj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function kv(t,e){return t.useProto3Json||nd(e)?e:{value:e}}function Cl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function px(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function $j(t,e){return Cl(t,e.toTimestamp())}function mt(t){return Q(!!t),Y.fromTimestamp(function(n){const r=xs(n);return new Qe(r.seconds,r.nanos)}(t))}function wI(t,e){return function(r){return new we(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function mx(t){const e=we.fromString(t);return Q(Sx(e)),e}function dh(t,e){return wI(t.databaseId,e.path)}function Zr(t,e){const n=mx(e);if(n.get(1)!==t.databaseId.projectId)throw new k(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new k(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new V(_x(n))}function Nv(t,e){return wI(t.databaseId,e)}function gx(t){const e=mx(t);return e.length===4?we.emptyPath():_x(e)}function fh(t){return new we(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _x(t){return Q(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function iA(t,e,n){return{name:dh(t,e),fields:n.value.mapValue.fields}}function yx(t,e,n){const r=Zr(t,e.name),i=mt(e.updateTime),s=e.createTime?mt(e.createTime):Y.min(),o=new Kt({mapValue:{fields:e.fields}}),a=ze.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function zj(t,e){return"found"in e?function(r,i){Q(!!i.found),i.found.name,i.found.updateTime;const s=Zr(r,i.found.name),o=mt(i.found.updateTime),a=i.found.createTime?mt(i.found.createTime):Y.min(),l=new Kt({mapValue:{fields:i.found.fields}});return ze.newFoundDocument(s,o,a,l)}(t,e):"missing"in e?function(r,i){Q(!!i.missing),Q(!!i.readTime);const s=Zr(r,i.missing),o=mt(i.readTime);return ze.newNoDocument(s,o)}(t,e):q()}function jj(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,c){return u.useProto3Json?(Q(c===void 0||typeof c=="string"),Tt.fromBase64String(c||"")):(Q(c===void 0||c instanceof Uint8Array),Tt.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const c=u.code===void 0?R.UNKNOWN:cx(u.code);return new k(c,u.message||"")}(o);n=new fx(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Zr(t,r.document.name),s=mt(r.document.updateTime),o=r.document.createTime?mt(r.document.createTime):Y.min(),a=new Kt({mapValue:{fields:r.document.fields}}),l=ze.newFoundDocument(i,s,o,a),u=r.targetIds||[],c=r.removedTargetIds||[];n=new xf(u,c,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Zr(t,r.document),s=r.readTime?mt(r.readTime):Y.min(),o=ze.newNoDocument(i,s),a=r.removedTargetIds||[];n=new xf([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Zr(t,r.document),s=r.removedTargetIds||[];n=new xf([],s,i,null)}else{if(!("filter"in e))return q();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new Oj(i,s),a=r.targetId;n=new dx(a,o)}}return n}function ph(t,e){let n;if(e instanceof Zl)n={update:iA(t,e.key,e.value)};else if(e instanceof eu)n={delete:dh(t,e.key)};else if(e instanceof Vi)n={update:iA(t,e.key,e.data),updateMask:Qj(e.fieldMask)};else{if(!(e instanceof mI))return q();n={verify:dh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Rl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Go)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ko)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Al)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw q()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:$j(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:q()}(t,e.precondition)),n}function xv(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Ge.updateTime(mt(s.updateTime)):s.exists!==void 0?Ge.exists(s.exists):Ge.none()}(e.currentDocument):Ge.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)Q(a.setToServerValue==="REQUEST_TIME"),l=new Rl;else if("appendMissingElements"in a){const c=a.appendMissingElements.values||[];l=new Go(c)}else if("removeAllFromArray"in a){const c=a.removeAllFromArray.values||[];l=new Ko(c)}else"increment"in a?l=new Al(o,a.increment):q();const u=He.fromServerFormat(a.fieldPath);return new od(u,l)}(t,i)):[];if(e.update){e.update.name;const i=Zr(t,e.update.name),s=new Kt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new kn(u.map(c=>He.fromServerFormat(c)))}(e.updateMask);return new Vi(i,s,o,n,r)}return new Zl(i,s,n,r)}if(e.delete){const i=Zr(t,e.delete);return new eu(i,n)}if(e.verify){const i=Zr(t,e.verify);return new mI(i,n)}return q()}function qj(t,e){return t&&t.length>0?(Q(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?mt(i.updateTime):mt(s);return o.isEqual(Y.min())&&(o=mt(s)),new Nj(o,i.transformResults||[])}(n,e))):[]}function vx(t,e){return{documents:[Nv(t,e.path)]}}function wx(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Nv(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Nv(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(l){if(l.length!==0)return Tx(Ce.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(u=>function(h){return{field:Da(h.field),direction:Hj(h.dir)}}(u))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=kv(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function Ex(t){let e=gx(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Q(r===1);const c=n.from[0];c.allDescendants?i=c.collectionId:e=e.child(c.collectionId)}let s=[];n.where&&(s=function(h){const d=Ix(h);return d instanceof Ce&&dI(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(d=>function(p){return new hh(Oa(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(d))}(n.orderBy));let a=null;n.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,nd(d)?null:d}(n.limit));let l=null;n.startAt&&(l=function(h){const d=!!h.before,f=h.values||[];return new Ms(f,d)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const d=!h.before,f=h.values||[];return new Ms(f,d)}(n.endAt)),GN(e,i,o,s,a,"F",l,u)}function Wj(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Ix(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Oa(n.unaryFilter.field);return me.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Oa(n.unaryFilter.field);return me.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Oa(n.unaryFilter.field);return me.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Oa(n.unaryFilter.field);return me.create(o,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(t):t.fieldFilter!==void 0?function(n){return me.create(Oa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ce.create(n.compositeFilter.filters.map(r=>Ix(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return q()}}(n.compositeFilter.op))}(t):q()}function Hj(t){return Vj[t]}function Gj(t){return Fj[t]}function Kj(t){return Uj[t]}function Da(t){return{fieldPath:t.canonicalString()}}function Oa(t){return He.fromServerFormat(t.fieldPath)}function Tx(t){return t instanceof me?function(n){if(n.op==="=="){if($R(n.value))return{unaryFilter:{field:Da(n.field),op:"IS_NAN"}};if(BR(n.value))return{unaryFilter:{field:Da(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if($R(n.value))return{unaryFilter:{field:Da(n.field),op:"IS_NOT_NAN"}};if(BR(n.value))return{unaryFilter:{field:Da(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Da(n.field),op:Gj(n.op),value:n.value}}}(t):t instanceof Ce?function(n){const r=n.getFilters().map(i=>Tx(i));return r.length===1?r[0]:{compositeFilter:{op:Kj(n.op),filters:r}}}(t):q()}function Qj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Sx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,n,r,i,s=Y.min(),o=Y.min(),a=Tt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new mi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx{constructor(e){this.ut=e}}function Yj(t,e){let n;if(e.document)n=yx(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=V.fromSegments(e.noDocument.path),i=Yo(e.noDocument.readTime);n=ze.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{const r=V.fromSegments(e.unknownDocument.path),i=Yo(e.unknownDocument.version);n=ze.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Qe(i[0],i[1]);return Y.fromTimestamp(s)}(e.readTime)),n}function sA(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Pp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:dh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Cl(s,o.version.toTimestamp()),createTime:Cl(s,o.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Qo(e.version)};else{if(!e.isUnknownDocument())return q();r.unknownDocument={path:n.path.toArray(),version:Qo(e.version)}}return r}function Pp(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Qo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Yo(t){const e=new Qe(t.seconds,t.nanoseconds);return Y.fromTimestamp(e)}function fo(t,e){const n=(e.baseMutations||[]).map(s=>xv(t.ut,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>xv(t.ut,s)),i=Qe.fromMillis(e.localWriteTimeMs);return new gI(e.batchId,i,n,r)}function ec(t){const e=Yo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Yo(t.lastLimboFreeSnapshotVersion):Y.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return Q(s.documents.length===1),vn(Xl(gx(s.documents[0])))}(t.query):function(s){return vn(Ex(s))}(t.query),new mi(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Tt.fromBase64String(t.resumeToken))}function Ax(t,e){const n=Qo(e.snapshotVersion),r=Qo(e.lastLimboFreeSnapshotVersion);let i;i=Rp(e.target)?vx(t.ut,e.target):wx(t.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ho(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function EI(t){const e=Ex({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Cp(e,e.limit,"L"):e}function V_(t,e){return new yI(e.largestBatchId,xv(t.ut,e.overlayMutation))}function oA(t,e){const n=e.path.lastSegment();return[t,yn(e.path.popLast()),n]}function aA(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Qo(r.readTime),documentKey:yn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{getBundleMetadata(e,n){return lA(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Yo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return lA(e).put(function(i){return{bundleId:i.id,createTime:Qo(mt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return uA(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:EI(s.bundledQuery),readTime:Yo(s.readTime)}}(r)})}saveNamedQuery(e,n){return uA(e).put(function(i){return{name:i.name,readTime:Qo(mt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function lA(t){return Ut(t,"bundles")}function uA(t){return Ut(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){const r=n.uid||"";return new Gm(e,r)}getOverlay(e,n){return Du(e).get(oA(this.userId,n)).next(r=>r?V_(this.serializer,r):null)}getOverlays(e,n){const r=Qr();return I.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new yI(n,o);i.push(this.lt(e,a))}),I.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(yn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Du(e).H("collectionPathOverlayIndex",a))}),I.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Qr(),s=yn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Du(e).W("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=V_(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Qr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Du(e).Y({index:"collectionGroupOverlayIndex",range:a},(l,u,c)=>{const h=V_(this.serializer,u);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):c.done()}).next(()=>s)}lt(e,n){return Du(e).put(function(i,s,o){const[a,l,u]=oA(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:ph(i.ut,o.mutation)}}(this.serializer,this.userId,n))}}function Du(t){return Ut(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(ot(e.integerValue));else if("doubleValue"in e){const r=ot(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),ah(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(n,20),typeof r=="string"?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(Ds(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?FN(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):q()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),V.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}po.St=new po;function Xj(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function cA(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=Xj(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class Zj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const n=this.Bt(e),r=cA(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){const n=this.Bt(e),r=cA(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){const n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class eq{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class tq{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Ou{constructor(){this.Wt=new Zj,this.Gt=new eq(this.Wt),this.zt=new tq(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new mo(this.indexId,this.documentKey,this.arrayValue,r)}}function Ki(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=hA(t.arrayValue,e.arrayValue),n!==0?n:(n=hA(t.directionalValue,e.directionalValue),n!==0?n:V.comparator(t.documentKey,e.documentKey)))}function hA(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e){this.Jt=new Ne((n,r)=>He.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(Q(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=Ev(e);if(n!==void 0&&!this.tn(n))return!1;const r=uo(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.nn(a,l)||!this.rn(this.Yt[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.Yt.length||!this.rn(this.Yt[o++],a))return!1}return!0}sn(){if(this.Xt)return null;let e=new Ne(He.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Cf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Cf(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Cf(r.field,r.dir==="asc"?0:1)));return new Sp(Sp.UNKNOWN_ID,this.collectionId,n,oh.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(t){var e,n;if(Q(t instanceof me||t instanceof Ce),t instanceof me){if(t instanceof HN){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>me.create(t.field,"==",s)))||[];return Ce.create(i,"or")}return t}const r=t.filters.map(i=>Cx(i));return Ce.create(r,t.op)}function nq(t){if(t.getFilters().length===0)return[];const e=Lv(Cx(t));return Q(Px(e)),Dv(e)||Ov(e)?[e]:e.getFilters()}function Dv(t){return t instanceof me}function Ov(t){return t instanceof Ce&&dI(t)}function Px(t){return Dv(t)||Ov(t)||function(n){if(n instanceof Ce&&Av(n)){for(const r of n.getFilters())if(!Dv(r)&&!Ov(r))return!1;return!0}return!1}(t)}function Lv(t){if(Q(t instanceof me||t instanceof Ce),t instanceof me)return t;if(t.filters.length===1)return Lv(t.filters[0]);const e=t.filters.map(r=>Lv(r));let n=Ce.create(e,t.op);return n=bp(n),Px(n)?n:(Q(n instanceof Ce),Q(Sl(n)),Q(n.filters.length>1),n.filters.reduce((r,i)=>II(r,i)))}function II(t,e){let n;return Q(t instanceof me||t instanceof Ce),Q(e instanceof me||e instanceof Ce),n=t instanceof me?e instanceof me?function(i,s){return Ce.create([i,s],"and")}(t,e):fA(t,e):e instanceof me?fA(e,t):function(i,s){if(Q(i.filters.length>0&&s.filters.length>0),Sl(i)&&Sl(s))return jN(i,s.getFilters());const o=Av(i)?i:s,a=Av(i)?s:i,l=o.filters.map(u=>II(u,a));return Ce.create(l,"or")}(t,e),bp(n)}function fA(t,e){if(Sl(e))return jN(e,t.getFilters());{const n=e.filters.map(r=>II(t,r));return Ce.create(n,"or")}}function bp(t){if(Q(t instanceof me||t instanceof Ce),t instanceof me)return t;const e=t.getFilters();if(e.length===1)return bp(e[0]);if($N(t))return t;const n=e.map(i=>bp(i)),r=[];return n.forEach(i=>{i instanceof me?r.push(i):i instanceof Ce&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ce.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rq{constructor(){this.on=new TI}addToCollectionParentIndex(e,n){return this.on.add(n),I.resolve()}getCollectionParents(e,n){return I.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return I.resolve()}deleteFieldIndex(e,n){return I.resolve()}deleteAllFieldIndexes(e){return I.resolve()}createTargetIndexes(e,n){return I.resolve()}getDocumentsMatchingTarget(e,n){return I.resolve(null)}getIndexType(e,n){return I.resolve(0)}getFieldIndexes(e,n){return I.resolve([])}getNextCollectionGroupToUpdate(e){return I.resolve(null)}getMinOffset(e,n){return I.resolve(Qn.min())}getMinOffsetFromCollectionGroup(e,n){return I.resolve(Qn.min())}updateCollectionGroup(e,n,r){return I.resolve()}updateIndexEntries(e,n){return I.resolve()}}class TI{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ne(we.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ne(we.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf=new Uint8Array(0);class iq{constructor(e,n){this.user=e,this.databaseId=n,this._n=new TI,this.an=new Zs(r=>Ho(r),(r,i)=>rd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const s={collectionId:r,parent:yn(i)};return pA(e).put(s)}return I.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[AN(n),""],!1,!0);return pA(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Kr(o.parent))}return r})}addFieldIndex(e,n){const r=Lu(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Ca(e);return s.next(a=>{o.put(aA(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Lu(e),i=Ca(e),s=Aa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Lu(e),r=Aa(e),i=Ca(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return I.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new dA(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Aa(e);let i=!0;const s=new Map;return I.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ae();const a=[];return I.forEach(s,(l,u)=>{N("IndexedDbIndexManager",`Using index ${function(y){return`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}(l)} to execute ${Ho(n)}`);const c=function(y,T){const b=Ev(T);if(b===void 0)return null;for(const w of Ap(y,b.fieldPath))switch(w.op){case"array-contains-any":return w.value.arrayValue.values||[];case"array-contains":return[w.value]}return null}(u,l),h=function(y,T){const b=new Map;for(const w of uo(T))for(const A of Ap(y,w.fieldPath))switch(A.op){case"==":case"in":b.set(w.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return b.set(w.fieldPath.canonicalString(),A.value),Array.from(b.values())}return null}(u,l),d=function(y,T){const b=[];let w=!0;for(const A of uo(T)){const x=A.kind===0?HR(y,A.fieldPath,y.startAt):GR(y,A.fieldPath,y.startAt);b.push(x.value),w&&(w=x.inclusive)}return new Ms(b,w)}(u,l),f=function(y,T){const b=[];let w=!0;for(const A of uo(T)){const x=A.kind===0?GR(y,A.fieldPath,y.endAt):HR(y,A.fieldPath,y.endAt);b.push(x.value),w&&(w=x.inclusive)}return new Ms(b,w)}(u,l),p=this.ln(l,u,d),m=this.ln(l,u,f),v=this.hn(l,u,h),g=this.Pn(l.indexId,c,p,d.inclusive,m,f.inclusive,v);return I.forEach(g,_=>r.j(_,n.limit).next(y=>{y.forEach(T=>{const b=V.fromSegments(T.documentKey);o.has(b)||(o=o.add(b),a.push(b))})}))}).next(()=>a)}return I.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=nq(Ce.create(e.filters,"and")).map(r=>Pv(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),c=[];for(let h=0;h<l;++h){const d=n?this.In(n[h/u]):rf,f=this.Tn(e,d,r[h%u],i),p=this.En(e,d,s[h%u],o),m=a.map(v=>this.Tn(e,d,v,!0));c.push(...this.createRange(f,p,m))}return c}Tn(e,n,r,i){const s=new mo(e,V.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){const s=new mo(e,V.empty(),n,r);return i?s.Ht():s}cn(e,n){const r=new dA(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.un(n);return I.forEach(i,s=>this.cn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ne(He.comparator),c=!1;for(const h of l.filters)for(const d of h.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?c=!0:u=u.add(d.field));for(const h of l.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(c?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}dn(e,n){const r=new Ou;for(const i of uo(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.jt(i.kind);po.St.ht(s,o)}return r.Ut()}In(e){const n=new Ou;return po.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new Ou;return po.St.ht(Wo(this.databaseId,n),r.jt(function(s){const o=uo(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let i=[];i.push(new Ou);let s=0;for(const o of uo(e)){const a=r[s++];for(const l of i)if(this.Rn(n,o.fieldPath)&&ch(a))i=this.Vn(i,o,a);else{const u=l.jt(o.kind);po.St.ht(a,u)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Ou;l.seed(a.Ut()),po.St.ht(o,l.jt(n.kind)),s.push(l)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Lu(e),i=Ca(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const o=[];return I.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(c,h){const d=h?new oh(h.sequenceNumber,new Qn(Yo(h.readTime),new V(Kr(h.documentKey)),h.largestBatchId)):oh.empty(),f=c.fields.map(([p,m])=>new Cf(He.fromServerFormat(p),m));return new Sp(c.indexId,c.collectionGroup,f,d)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:se(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Lu(e),s=Ca(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>I.forEach(a,l=>s.put(aA(l.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return I.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?I.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),I.forEach(a,l=>this.gn(e,i,l).next(u=>{const c=this.pn(s,l);return u.isEqual(c)?I.resolve():this.yn(e,s,l,u,c)}))))})}wn(e,n,r,i){return Aa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return Aa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const i=Aa(e);let s=new Ne(Ki);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new mo(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new Ne(Ki);const i=this.dn(n,e);if(i==null)return r;const s=Ev(n);if(s!=null){const o=e.data.field(s.fieldPath);if(ch(o))for(const a of o.arrayValue.values||[])r=r.add(new mo(n.indexId,e.key,this.In(a),i))}else r=r.add(new mo(n.indexId,e.key,rf,i));return r}yn(e,n,r,i,s){N("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,u,c,h,d){const f=l.getIterator(),p=u.getIterator();let m=Ra(f),v=Ra(p);for(;m||v;){let g=!1,_=!1;if(m&&v){const y=c(m,v);y<0?_=!0:y>0&&(g=!0)}else m!=null?_=!0:g=!0;g?(h(v),v=Ra(p)):_?(d(m),m=Ra(f)):(m=Ra(f),v=Ra(p))}}(i,s,Ki,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),I.waitFor(o)}fn(e){let n=1;return Ca(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ki(o,a)).filter((o,a,l)=>!a||Ki(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ki(o,e),l=Ki(o,n);if(a===0)i[0]=e.Ht();else if(a>0&&l<0)i.push(o),i.push(o.Ht());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,rf,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,rf,[]];s.push(IDBKeyRange.bound(a,l))}return s}bn(e,n){return Ki(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(mA)}getMinOffset(e,n){return I.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||q())).next(mA)}}function pA(t){return Ut(t,"collectionParents")}function Aa(t){return Ut(t,"indexEntries")}function Lu(t){return Ut(t,"indexConfiguration")}function Ca(t){return Ut(t,"indexState")}function mA(t){Q(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;uI(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Qn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Sn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.Y({range:o},(c,h,d)=>(a++,d.delete()));s.push(l.next(()=>{Q(a===1)}));const u=[];for(const c of n.mutations){const h=xN(e,c.key.path,n.batchId);s.push(i.delete(h)),u.push(c.key)}return I.waitFor(s).next(()=>u)}function kp(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw q();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(41943040,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);class Km{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){Q(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Km(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qi(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=La(e),o=Qi(e);return o.add({}).next(a=>{Q(typeof a=="number");const l=new gI(a,n,r,i),u=function(f,p,m){const v=m.baseMutations.map(_=>ph(f.ut,_)),g=m.mutations.map(_=>ph(f.ut,_));return{userId:p,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:v,mutations:g}}(this.serializer,this.userId,l),c=[];let h=new Ne((d,f)=>se(d.canonicalString(),f.canonicalString()));for(const d of i){const f=xN(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),c.push(o.put(u)),c.push(s.put(f,Hz))}return h.forEach(d=>{c.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Dn[a]=l.keys()}),I.waitFor(c).next(()=>l)})}lookupMutationBatch(e,n){return Qi(e).get(n).next(r=>r?(Q(r.userId===this.userId),fo(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?I.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Qi(e).Y({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(Q(a.batchId>=r),s=fo(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Qi(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Qi(e).W("userMutationsIndex",n).next(r=>r.map(i=>fo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Pf(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return La(e).Y({range:i},(o,a,l)=>{const[u,c,h]=o,d=Kr(c);if(u===this.userId&&n.path.isEqual(d))return Qi(e).get(h).next(f=>{if(!f)throw q();Q(f.userId===this.userId),s.push(fo(this.serializer,f))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ne(se);const i=[];return n.forEach(s=>{const o=Pf(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=La(e).Y({range:a},(u,c,h)=>{const[d,f,p]=u,m=Kr(f);d===this.userId&&s.path.isEqual(m)?r=r.add(p):h.done()});i.push(l)}),I.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Pf(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ne(se);return La(e).Y({range:o},(l,u,c)=>{const[h,d,f]=l,p=Kr(d);h===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):c.done()}).next(()=>this.vn(e,a))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Qi(e).get(s).next(o=>{if(o===null)throw q();Q(o.userId===this.userId),r.push(fo(this.serializer,o))}))}),I.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return bx(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),I.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return I.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return La(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Kr(s[1]);i.push(l)}else a.done()}).next(()=>{Q(i.length===0)})})}containsKey(e,n){return kx(e,this.userId,n)}Mn(e){return Nx(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function kx(t,e,n){const r=Pf(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return La(t).Y({range:s,J:!0},(a,l,u)=>{const[c,h,d]=a;c===e&&h===i&&(o=!0),u.done()}).next(()=>o)}function Qi(t){return Ut(t,"mutations")}function La(t){return Ut(t,"documentMutations")}function Nx(t){return Ut(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Jo(0)}static Nn(){return new Jo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sq{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{const r=new Jo(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>Y.fromTimestamp(new Qe(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Pa(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(Q(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Pa(e).Y((o,a)=>{const l=ec(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>I.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Pa(e).Y((r,i)=>{const s=ec(i);n(s)})}Bn(e){return _A(e).get("targetGlobalKey").next(n=>(Q(n!==null),n))}Ln(e,n){return _A(e).put("targetGlobalKey",n)}kn(e,n){return Pa(e).put(Ax(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ho(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Pa(e).Y({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const u=ec(a);rd(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=is(e);return n.forEach(o=>{const a=yn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),I.waitFor(i)}removeMatchingKeys(e,n,r){const i=is(e);return I.forEach(n,s=>{const o=yn(s.path);return I.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=is(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=is(e);let s=ae();return i.Y({range:r,J:!0},(o,a,l)=>{const u=Kr(o[1]),c=new V(u);s=s.add(c)}).next(()=>s)}containsKey(e,n){const r=yn(n.path),i=IDBKeyRange.bound([r],[AN(r)],!1,!0);let s=0;return is(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}_t(e,n){return Pa(e).get(n).next(r=>r?ec(r):null)}}function Pa(t){return Ut(t,"targets")}function _A(t){return Ut(t,"targetGlobal")}function is(t){return Ut(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA([t,e],[n,r]){const i=se(t,n);return i===0?se(e,r):i}class oq{constructor(e){this.Qn=e,this.buffer=new Ne(yA),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();yA(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class aq{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){N("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Xs(n)?N("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Js(n)}await this.Gn(3e5)})}}class lq{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return I.resolve(bn._e);const r=new oq(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),I.resolve(gA)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gA):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,l,u;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),Na()<=de.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-c}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(u-l)+`ms
Total Duration: ${u-c}ms`),I.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function uq(t,e){return new lq(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cq{constructor(e,n){this.db=e,this.garbageCollector=uq(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return sf(e,r)}removeReference(e,n,r){return sf(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return sf(e,n)}Xn(e,n){return function(i,s){let o=!1;return Nx(i).Z(a=>kx(i,a,s).next(l=>(l&&(o=!0),I.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=n){const l=this.Xn(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Y.min()),is(e).delete(function(h){return[0,yn(h.path)]}(o))))});i.push(l)}}).next(()=>I.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return sf(e,n)}Zn(e,n){const r=is(e);let i,s=bn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==bn._e&&n(new V(Kr(i)),s),s=u,i=l):s=bn._e}).next(()=>{s!==bn._e&&n(new V(Kr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sf(t,e){return is(t).put(function(r,i){return{targetId:0,path:yn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(){this.changes=new Zs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ze.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?I.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hq{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return so(e).put(r)}removeEntry(e,n,r){return so(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Pp(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=ze.newInvalidDocument(n);return so(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Mu(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:ze.newInvalidDocument(n)};return so(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Mu(n))},(i,s)=>{r={document:this.tr(n,s),size:kp(s)}}).next(()=>r)}getEntries(e,n){let r=Nn();return this.rr(e,n,(i,s)=>{const o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=Nn(),i=new nt(V.comparator);return this.rr(e,n,(s,o)=>{const a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,kp(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return I.resolve();let i=new Ne(EA);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Mu(i.first()),Mu(i.last())),o=i.getIterator();let a=o.getNext();return so(e).Y({index:"documentKeyIndex",range:s},(l,u,c)=>{const h=V.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&EA(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?c.U(Mu(a)):c.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Pp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return so(e).W(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let c=Nn();for(const h of u){const d=this.tr(V.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);d.isFoundDocument()&&(sd(n,d)||i.has(d.key))&&(c=c.insert(d.key,d))}return c})}getAllFromCollectionGroup(e,n,r,i){let s=Nn();const o=wA(n,r),a=wA(n,Qn.max());return so(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,c)=>{const h=this.tr(V.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(h.key,h),s.size===i&&c.done()}).next(()=>s)}newChangeBuffer(e){return new dq(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return vA(e).get("remoteDocumentGlobalKey").next(n=>(Q(!!n),n))}er(e,n){return vA(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=Yj(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Y.min())))return r}return ze.newInvalidDocument(e)}}function Dx(t){return new hq(t)}class dq extends xx{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Zs(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ne((s,o)=>se(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=sA(this._r.serializer,o);i=i.add(s.path.popLast());const u=kp(l);r+=u-a.size,n.push(this._r.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=sA(this._r.serializer,o.convertToNoDocument(Y.min()));n.push(this._r.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),I.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function vA(t){return Ut(t,"remoteDocumentGlobal")}function so(t){return Ut(t,"remoteDocumentsV14")}function Mu(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function wA(t,e){const n=e.documentKey.path.toArray();return[t,Pp(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function EA(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=se(n[s],r[s]),i)return i;return i=se(n.length,r.length),i||(i=se(n[n.length-2],r[r.length-2]),i||se(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fq{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&gc(r.mutation,i,kn.empty(),Qe.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ae()){const i=Qr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Xu();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Qr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ae()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Nn();const o=mc(),a=function(){return mc()}();return n.forEach((l,u)=>{const c=r.get(u.key);i.has(u.key)&&(c===void 0||c.mutation instanceof Vi)?s=s.insert(u.key,u):c!==void 0?(o.set(u.key,c.mutation.getFieldMask()),gc(c.mutation,u,c.mutation.getFieldMask(),Qe.now())):o.set(u.key,kn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,c)=>o.set(u,c)),n.forEach((u,c)=>{var h;return a.set(u,new fq(c,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=mc();let i=new nt((o,a)=>o-a),s=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let c=r.get(l)||kn.empty();c=a.applyToLocalView(u,c),r.set(l,c);const h=(i.get(a.batchId)||ae()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,c=l.value,h=ZN();c.forEach(d=>{if(!s.has(d)){const f=ax(n.get(d),r.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return I.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return V.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):fI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):I.resolve(Qr());let a=-1,l=s;return o.next(u=>I.forEach(u,(c,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(c)?I.resolve():this.remoteDocumentCache.getEntry(e,c).next(d=>{l=l.insert(c,d)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ae())).next(c=>({batchId:a,changes:XN(c)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new V(n)).next(r=>{let i=Xu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Xu();return this.indexManager.getCollectionParents(e,s).next(a=>I.forEach(a,l=>{const u=function(h,d){return new Mi(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(c=>{c.forEach((h,d)=>{o=o.insert(h,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const c=u.getKey();o.get(c)===null&&(o=o.insert(c,ze.newInvalidDocument(c)))});let a=Xu();return o.forEach((l,u)=>{const c=s.get(l);c!==void 0&&gc(c.mutation,u,kn.empty(),Qe.now()),sd(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pq{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return I.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:mt(i.createTime)}}(n)),I.resolve()}getNamedQuery(e,n){return I.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:EI(i.bundledQuery),readTime:mt(i.readTime)}}(n)),I.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mq{constructor(){this.overlays=new nt(V.comparator),this.lr=new Map}getOverlay(e,n){return I.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Qr();return I.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),I.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),I.resolve()}getOverlaysForCollection(e,n,r){const i=Qr(),s=n.length+1,o=new V(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return I.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new nt((u,c)=>u-c);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let c=s.get(u.largestBatchId);c===null&&(c=Qr(),s=s.insert(u.largestBatchId,c)),c.set(u.getKey(),u)}}const a=Qr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,c)=>a.set(u,c)),!(a.size()>=i)););return I.resolve(a)}lt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new yI(n,r));let s=this.lr.get(n);s===void 0&&(s=ae(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(){this.hr=new Ne(Pt.Pr),this.Ir=new Ne(Pt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new Pt(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new Pt(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new V(new we([])),r=new Pt(n,e),i=new Pt(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new V(new we([])),r=new Pt(n,e),i=new Pt(n,e+1);let s=ae();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Pt(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Pt{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return V.comparator(e.key,n.key)||se(e.gr,n.gr)}static Tr(e,n){return se(e.gr,n.gr)||V.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gq{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Ne(Pt.Pr)}checkEmpty(e){return I.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new gI(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new Pt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return I.resolve(o)}lookupMutationBatch(e,n){return I.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Sr(r),s=i<0?0:i;return I.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return I.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return I.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Pt(n,0),i=new Pt(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),I.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ne(se);return n.forEach(i=>{const s=new Pt(i,0),o=new Pt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),I.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;V.isDocumentKey(s)||(s=s.child(""));const o=new Pt(new V(s),0);let a=new Ne(se);return this.yr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.gr)),!0)},o),I.resolve(this.br(a))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Q(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return I.forEach(n.mutations,i=>{const s=new Pt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new Pt(n,0),i=this.yr.firstAfterOrEqual(r);return I.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,I.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _q{constructor(e){this.Cr=e,this.docs=function(){return new nt(V.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return I.resolve(r?r.document.mutableCopy():ze.newInvalidDocument(n))}getEntries(e,n){let r=Nn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ze.newInvalidDocument(i))}),I.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Nn();const o=n.path,a=new V(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:c}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||uI(PN(c),r)<=0||(i.has(c.key)||sd(n,c))&&(s=s.insert(c.key,c.mutableCopy()))}return I.resolve(s)}getAllFromCollectionGroup(e,n,r,i){q()}vr(e,n){return I.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new yq(this)}getSize(e){return I.resolve(this.size)}}class yq extends xx{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),I.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vq{constructor(e){this.persistence=e,this.Fr=new Zs(n=>Ho(n),rd),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.Mr=0,this.Or=new SI,this.targetCount=0,this.Nr=Jo.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),I.resolve()}getLastRemoteSnapshotVersion(e){return I.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return I.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),I.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),I.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new Jo(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,I.resolve()}updateTargetData(e,n){return this.kn(n),I.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,I.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),I.waitFor(s).next(()=>i)}getTargetCount(e){return I.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return I.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),I.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),I.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),I.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return I.resolve(r)}containsKey(e,n){return I.resolve(this.Or.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e,n){this.Br={},this.overlays={},this.Lr=new bn(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new vq(this),this.indexManager=new rq,this.remoteDocumentCache=function(i){return new _q(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new Rx(n),this.Kr=new pq(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new mq,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new gq(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){N("MemoryPersistence","Starting transaction:",e);const i=new wq(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return I.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class wq extends kN{constructor(e){super(),this.currentSequenceNumber=e}}class Qm{constructor(e){this.persistence=e,this.Gr=new SI,this.zr=null}static jr(e){return new Qm(e)}get Hr(){if(this.zr)return this.zr;throw q()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),I.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),I.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),I.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return I.forEach(this.Hr,r=>{const i=V.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,Y.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return I.or([()=>I.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eq{constructor(e){this.serializer=e}N(e,n,r,i){const s=new jm("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",MR,{unique:!0}),l.createObjectStore("documentMutations")}(e),IA(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=I.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),IA(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Y.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",c)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").W().next(c=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",MR,{unique:!0});const h=u.store("mutations"),d=c.map(f=>h.put(f));return I.waitFor(d)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore("documentOverlays",{keyPath:ij});u.createIndex("collectionPathOverlayIndex",sj,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",oj,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:Gz});u.createIndex("documentKeyIndex",Kz),u.createIndex("collectionGroupIndex",Qz)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:ej}).createIndex("sequenceNumberIndex",tj,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:nj}).createIndex("documentKeyIndex",rj,{unique:!1})}(e))),o}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=kp(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>I.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>I.forEach(a,l=>{Q(l.userId===s.userId);const u=fo(this.serializer,l);return bx(e,s.userId,u).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((o,a)=>{const l=new we(o),u=function(h){return[0,yn(h)]}(l);s.push(n.get(u).next(c=>c?I.resolve():(h=>n.put({targetId:0,path:yn(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>I.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:Zz});const r=n.store("collectionParents"),i=new TI,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:yn(l)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{const l=new we(o);return s(l.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,l],u)=>{const c=Kr(a);return s(c.popLast())}))}ni(e){const n=e.store("targets");return n.Y((r,i)=>{const s=ec(i),o=Ax(this.serializer,s);return n.put(o)})}ri(e,n){const r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(h){return h.document?new V(we.fromString(h.document.name).popFirst(5)):h.noDocument?V.fromSegments(h.noDocument.path):h.unknownDocument?V.fromSegments(h.unknownDocument.path):q()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>I.waitFor(i))}ii(e,n){const r=n.store("mutations"),i=Dx(this.serializer),s=new Lx(Qm.jr,this.serializer.ut);return r.W().next(o=>{const a=new Map;return o.forEach(l=>{var u;let c=(u=a.get(l.userId))!==null&&u!==void 0?u:ae();fo(this.serializer,l).keys().forEach(h=>c=c.add(h)),a.set(l.userId,c)}),I.forEach(a,(l,u)=>{const c=new Nt(u),h=Gm.ct(this.serializer,c),d=s.getIndexManager(c),f=Km.ct(c,this.serializer,d,s.referenceDelegate);return new Ox(i,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Iv(n,bn._e),l).next()})})}}function IA(t){t.createObjectStore("targetDocuments",{keyPath:Jz}).createIndex("documentTargetsIndex",Xz,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Yz,{unique:!0}),t.createObjectStore("targetGlobal")}const F_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class RI{constructor(e,n,r,i,s,o,a,l,u,c,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=u,this._i=c,this.ai=h,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=d=>Promise.resolve(),!RI.D())throw new k(R.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new cq(this,i),this.Ii=n+"main",this.serializer=new Rx(l),this.Ti=new Sr(this.Ii,this.ai,new Eq(this.serializer)),this.qr=new sq(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Dx(this.serializer),this.Kr=new Jj,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,c===!1&&pt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(R.FAILED_PRECONDITION,F_);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new bn(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>of(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Xs(e))return N("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Vu(e).get("owner").next(n=>I.resolve(this.wi(n)))}Si(e){return of(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Ut(n,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return I.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ei)for(const n of e)this.Ei.removeItem(this.vi(n.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?I.resolve(!0):Vu(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new k(R.FAILED_PRECONDITION,F_);return!1}}return!(!this.networkEnabled||!this.inForeground)||of(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&N("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Iv(e,bn._e);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>of(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return Km.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new iq(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Gm.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){N("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===15?lj:l===14?LN:l===13?ON:l===12?aj:l===11?DN:void q()}(this.ai);let o;return this.Ti.runTransaction(e,i,s,a=>(o=new Iv(a,this.Lr?this.Lr.next():bn._e),n==="readwrite-primary"?this.fi(o).next(l=>!!l||this.gi(o)).next(l=>{if(!l)throw pt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new k(R.FAILED_PRECONDITION,bN);return r(o)}).next(l=>this.yi(o).next(()=>l)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return Vu(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new k(R.FAILED_PRECONDITION,F_)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Vu(e).put("owner",n)}static D(){return Sr.D()}pi(e){const n=Vu(e);return n.get("owner").next(r=>this.wi(r)?(N("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):I.resolve())}Di(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(pt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;Q2()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return N("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return pt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){pt("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Vu(t){return Ut(t,"owner")}function of(t){return Ut(t,"clientMetadata")}function AI(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=ae(),i=ae();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new CI(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iq{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new Iq;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(Na()<=de.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",xa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),I.resolve()):(Na()<=de.DEBUG&&N("QueryEngine","Query:",xa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Na()<=de.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",xa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vn(n))):I.resolve())}zi(e,n){if(KR(n))return I.resolve(null);let r=vn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Cp(n,null,"F"),r=vn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ae(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Yi(n,a);return this.Zi(n,u,o,l.readTime)?this.zi(e,Cp(n,null,"F")):this.Xi(e,u,n,l)}))})))}ji(e,n,r,i){return KR(n)||i.isEqual(Y.min())?I.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(n,s);return this.Zi(n,o,r,i)?I.resolve(null):(Na()<=de.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xa(n)),this.Xi(e,o,n,CN(i,-1)).next(a=>a))})}Yi(e,n){let r=new Ne(YN(e));return n.forEach((i,s)=>{sd(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return Na()<=de.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",xa(n)),this.Gi.getDocumentsMatchingQuery(e,n,Qn.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tq{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new nt(se),this.ns=new Zs(s=>Ho(s),rd),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ox(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function Vx(t,e,n,r){return new Tq(t,e,n,r)}async function Fx(t,e){const n=U(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ae();for(const u of i){o.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}for(const u of s){a.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}return n.localDocuments.getDocuments(r,l).next(u=>({_s:u,removedBatchIds:o,addedBatchIds:a}))})})}function Sq(t,e){const n=U(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,l,u,c){const h=u.batch,d=h.keys();let f=I.resolve();return d.forEach(p=>{f=f.next(()=>c.getEntry(l,p)).next(m=>{const v=u.docVersions.get(p);Q(v!==null),m.version.compareTo(v)<0&&(h.applyToRemoteDocument(m,u),m.isValidDocument()&&(m.setReadTime(u.commitVersion),c.addEntry(m)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ae();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Ux(t){const e=U(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function Rq(t,e){const n=U(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const a=[];e.targetChanges.forEach((c,h)=>{const d=i.get(h);if(!d)return;a.push(n.qr.removeMatchingKeys(s,c.removedDocuments,h).next(()=>n.qr.addMatchingKeys(s,c.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(Tt.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):c.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(c.resumeToken,r)),i=i.insert(h,f),function(m,v,g){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:g.addedDocuments.size+g.modifiedDocuments.size+g.removedDocuments.size>0}(d,f,c)&&a.push(n.qr.updateTargetData(s,f))});let l=Nn(),u=ae();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,c))}),a.push(Bx(s,o,e.documentUpdates).next(c=>{l=c.us,u=c.cs})),!r.isEqual(Y.min())){const c=n.qr.getLastRemoteSnapshotVersion(s).next(h=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(c)}return I.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.ts=i,s))}function Bx(t,e,n){let r=ae(),i=ae();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Nn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(Y.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):N("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{us:o,cs:i}})}function Aq(t,e){const n=U(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Pl(t,e){const n=U(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,I.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new mi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}async function bl(t,e,n){const r=U(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Xs(o))throw o;N("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function Np(t,e,n){const r=U(t);let i=Y.min(),s=ae();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,c){const h=U(l),d=h.ns.get(c);return d!==void 0?I.resolve(h.ts.get(d)):h.qr.getTargetData(u,c)}(r,o,vn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:Y.min(),n?s:ae())).next(a=>(jx(r,QN(e),a),{documents:a,ls:s})))}function $x(t,e){const n=U(t),r=U(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function zx(t,e){const n=U(t),r=n.rs.get(e)||Y.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,CN(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(jx(n,e,i),i))}function jx(t,e,n){let r=t.rs.get(e)||Y.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}async function Cq(t,e,n,r){const i=U(t);let s=ae(),o=Nn();for(const u of n){const c=e.hs(u.metadata.name);u.document&&(s=s.add(c));const h=e.Ps(u);h.setReadTime(e.Is(u.metadata.readTime)),o=o.insert(c,h)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),l=await Pl(i,function(c){return vn(Xl(we.fromString(`__bundle__/docs/${c}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>Bx(u,a,o).next(c=>(a.apply(u),c)).next(c=>i.qr.removeMatchingKeysForTargetId(u,l.targetId).next(()=>i.qr.addMatchingKeys(u,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,c.us,c.cs)).next(()=>c.us)))}async function Pq(t,e,n=ae()){const r=await Pl(t,vn(EI(e.bundledQuery))),i=U(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=mt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Kr.saveNamedQuery(s,e);const a=r.withResumeToken(Tt.EMPTY_BYTE_STRING,o);return i.ts=i.ts.insert(a.targetId,a),i.qr.updateTargetData(s,a).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function TA(t,e){return`firestore_clients_${t}_${e}`}function SA(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function U_(t,e){return`firestore_targets_${t}_${e}`}class xp{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new k(i.error.code,i.error.message))),o?new xp(e,n,i.state,s):(pt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class _c{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new k(r.error.code,r.error.message))),s?new _c(e,r.state,i):(pt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Dp{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=pI();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=NN(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Dp(e,s):(pt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class PI{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new PI(n.clientId,n.onlineState):(pt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Mv{constructor(){this.activeTargetIds=pI()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class B_{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new nt(se),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=TA(this.persistenceKey,this.Rs),this.ws=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new Mv),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.vs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(TA(this.persistenceKey,r));if(i){const s=Dp.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const n=this.storage.getItem(this.Cs);if(n){const r=this.Ms(n);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(U_(this.persistenceKey,e));if(r){const i=_c.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(U_(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return N("SharedClientState","READ",e,n),n}setItem(e,n){N("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){N("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const n=e;if(n.storageArea===this.storage){if(N("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void pt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){const r=this.Ks(n.key);return this.$s(r,null)}{const r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){const r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){const r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){const r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){const r=function(s){let o=bn._e;if(s!=null)try{const a=JSON.parse(s);Q(typeof a=="number"),o=a}catch(a){pt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==bn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){const r=this.Hs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(n)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){const i=new xp(this.currentUser,e,n,r),s=SA(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const n=SA(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){const n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){const i=U_(this.persistenceKey,e),s=new _c(e,n,r);this.setItem(i,s.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return Dp.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return xp.Ts(new Nt(s),i,n)}zs(e,n){const r=this.Ds.exec(e),i=Number(r[1]);return _c.Ts(i,n)}Ms(e){return PI.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);N("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=pI();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class qx{constructor(){this.eo=new Mv,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new Mv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bq{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let af=null;function $_(){return af===null?af=function(){return 268435456+Math.round(2147483648*Math.random())}():af++,"0x"+af.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nq{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn="WebChannelConnection";class xq extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){const a=$_(),l=this.So(n,r);N("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(u,s,o),this.Do(n,l,u,i).then(c=>(N("RestConnection",`Received RPC '${n}' ${a}: `,c),c),c=>{throw Nr("RestConnection",`RPC '${n}' ${a} failed with error: `,c,"url: ",l,"request:",i),c})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){const i=kq[n];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=$_();return new Promise((o,a)=>{const l=new Cz;l.setWithCredentials(!0),l.listenOnce(Rz.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case M_.NO_ERROR:const c=l.getResponseJson();N(nn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(c)),o(c);break;case M_.TIMEOUT:N(nn,`RPC '${e}' ${s} timed out`),a(new k(R.DEADLINE_EXCEEDED,"Request time out"));break;case M_.HTTP_ERROR:const h=l.getStatus();if(N(nn,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const p=function(v){const g=v.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(g)>=0?g:R.UNKNOWN}(f.status);a(new k(p,f.message))}else a(new k(R.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new k(R.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{N(nn,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);N(nn,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}vo(e,n,r){const i=$_(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Tz(),a=Sz(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.bo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const c=s.join("");N(nn,`Creating RPC '${e}' stream ${i}: ${c}`,l);const h=o.createWebChannel(c,l);let d=!1,f=!1;const p=new Nq({co:v=>{f?N(nn,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(d||(N(nn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),N(nn,`RPC '${e}' stream ${i} sending:`,v),h.send(v))},lo:()=>h.close()}),m=(v,g,_)=>{v.listen(g,y=>{try{_(y)}catch(T){setTimeout(()=>{throw T},0)}})};return m(h,tf.EventType.OPEN,()=>{f||N(nn,`RPC '${e}' stream ${i} transport opened.`)}),m(h,tf.EventType.CLOSE,()=>{f||(f=!0,N(nn,`RPC '${e}' stream ${i} transport closed`),p.Ro())}),m(h,tf.EventType.ERROR,v=>{f||(f=!0,Nr(nn,`RPC '${e}' stream ${i} transport errored:`,v),p.Ro(new k(R.UNAVAILABLE,"The operation could not be completed")))}),m(h,tf.EventType.MESSAGE,v=>{var g;if(!f){const _=v.data[0];Q(!!_);const y=_,T=y.error||((g=y[0])===null||g===void 0?void 0:g.error);if(T){N(nn,`RPC '${e}' stream ${i} received error:`,T);const b=T.status;let w=function($){const G=gt[$];if(G!==void 0)return cx(G)}(b),A=T.message;w===void 0&&(w=R.INTERNAL,A="Unknown error status: "+b+" with message "+T.message),f=!0,p.Ro(new k(w,A)),h.close()}else N(nn,`RPC '${e}' stream ${i} received:`,_),p.Vo(_)}}),m(a,Az.STAT_EVENT,v=>{v.stat===xR.PROXY?N(nn,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===xR.NOPROXY&&N(nn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ao()},0),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(){return typeof window<"u"?window:null}function Df(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(t){return new Bj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(e,n,r,i,s,o,a,l){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new bI(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,n){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===R.RESOURCE_EXHAUSTED?(pt(n.toString()),pt("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(n)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new k(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Dq extends Hx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=jj(this.serializer,e),r=function(s){if(!("targetChange"in s))return Y.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Y.min():o.readTime?mt(o.readTime):Y.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=fh(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Rp(l)?{documents:vx(s,l)}:{query:wx(s,l)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=px(s,o.resumeToken);const u=kv(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(Y.min())>0){a.readTime=Cl(s,o.snapshotVersion.toTimestamp());const u=kv(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=Wj(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=fh(this.serializer),n.removeTarget=e,this.e_(n)}}class Oq extends Hx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(Q(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=qj(e.writeResults,e.commitTime),r=mt(e.commitTime);return this.listener.I_(r,n)}return Q(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=fh(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>ph(this.serializer,r))};this.e_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lq extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new k(R.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new k(R.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(R.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class Mq{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(pt(n),this.f_=!1):N("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vq{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(o=>{r.enqueueAndForget(async()=>{eo(this)&&(N("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=U(l);u.C_.add(4),await tu(u),u.M_.set("Unknown"),u.C_.delete(4),await cd(u)}(this))})}),this.M_=new Mq(r,i)}}async function cd(t){if(eo(t))for(const e of t.v_)await e(!0)}async function tu(t){for(const e of t.v_)await e(!1)}function Ym(t,e){const n=U(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),xI(n)?NI(n):ru(n).Ho()&&kI(n,e))}function mh(t,e){const n=U(t),r=ru(n);n.D_.delete(e),r.Ho()&&Gx(n,e),n.D_.size===0&&(r.Ho()?r.Zo():eo(n)&&n.M_.set("Unknown"))}function kI(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ru(t).u_(e)}function Gx(t,e){t.x_.Oe(e),ru(t).c_(e)}function NI(t){t.x_=new Mj({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),ru(t).start(),t.M_.g_()}function xI(t){return eo(t)&&!ru(t).jo()&&t.D_.size>0}function eo(t){return U(t).C_.size===0}function Kx(t){t.x_=void 0}async function Fq(t){t.D_.forEach((e,n)=>{kI(t,e)})}async function Uq(t,e){Kx(t),xI(t)?(t.M_.w_(e),NI(t)):t.M_.set("Unknown")}async function Bq(t,e,n){if(t.M_.set("Online"),e instanceof fx&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.D_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.D_.delete(a),i.x_.removeTarget(a))}(t,e)}catch(r){N("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Op(t,r)}else if(e instanceof xf?t.x_.$e(e):e instanceof dx?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(Y.min()))try{const r=await Ux(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const c=s.D_.get(u);c&&s.D_.set(u,c.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const c=s.D_.get(l);if(!c)return;s.D_.set(l,c.withResumeToken(Tt.EMPTY_BYTE_STRING,c.snapshotVersion)),Gx(s,l);const h=new mi(c.target,l,u,c.sequenceNumber);kI(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){N("RemoteStore","Failed to raise snapshot:",r),await Op(t,r)}}async function Op(t,e,n){if(!Xs(e))throw e;t.C_.add(1),await tu(t),t.M_.set("Offline"),n||(n=()=>Ux(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{N("RemoteStore","Retrying IndexedDB access"),await n(),t.C_.delete(1),await cd(t)})}function Qx(t,e){return e().catch(n=>Op(t,n,e))}async function nu(t){const e=U(t),n=Vs(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;$q(e);)try{const i=await Aq(e.localStore,r);if(i===null){e.b_.length===0&&n.Zo();break}r=i.batchId,zq(e,i)}catch(i){await Op(e,i)}Yx(e)&&Jx(e)}function $q(t){return eo(t)&&t.b_.length<10}function zq(t,e){t.b_.push(e);const n=Vs(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function Yx(t){return eo(t)&&!Vs(t).jo()&&t.b_.length>0}function Jx(t){Vs(t).start()}async function jq(t){Vs(t).E_()}async function qq(t){const e=Vs(t);for(const n of t.b_)e.P_(n.mutations)}async function Wq(t,e,n){const r=t.b_.shift(),i=_I.from(r,e,n);await Qx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await nu(t)}async function Hq(t,e){e&&Vs(t).h_&&await async function(r,i){if(function(o){return ux(o)&&o!==R.ABORTED}(i.code)){const s=r.b_.shift();Vs(r).Yo(),await Qx(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await nu(r)}}(t,e),Yx(t)&&Jx(t)}async function AA(t,e){const n=U(t);n.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");const r=eo(n);n.C_.add(3),await tu(n),r&&n.M_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),await cd(n)}async function Vv(t,e){const n=U(t);e?(n.C_.delete(2),await cd(n)):e||(n.C_.add(2),await tu(n),n.M_.set("Unknown"))}function ru(t){return t.O_||(t.O_=function(n,r,i){const s=U(n);return s.A_(),new Dq(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Fq.bind(null,t),Io:Uq.bind(null,t),a_:Bq.bind(null,t)}),t.v_.push(async e=>{e?(t.O_.Yo(),xI(t)?NI(t):t.M_.set("Unknown")):(await t.O_.stop(),Kx(t))})),t.O_}function Vs(t){return t.N_||(t.N_=function(n,r,i){const s=U(n);return s.A_(),new Oq(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:jq.bind(null,t),Io:Hq.bind(null,t),T_:qq.bind(null,t),I_:Wq.bind(null,t)}),t.v_.push(async e=>{e?(t.N_.Yo(),await nu(t)):(await t.N_.stop(),t.b_.length>0&&(N("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))})),t.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Lt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new DI(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function iu(t,e){if(pt("AsyncQueue",`${e}: ${t}`),Xs(t))return new k(R.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.comparator=e?(n,r)=>e(n,r)||V.comparator(n.key,r.key):(n,r)=>V.comparator(n.key,r.key),this.keyedMap=Xu(),this.sortedSet=new nt(this.comparator)}static emptySet(e){return new al(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof al)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new al;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(){this.B_=new nt(V.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):q():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class kl{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new kl(e,n,al.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&id(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gq{constructor(){this.k_=void 0,this.listeners=[]}}class Kq{constructor(){this.queries=new Zs(e=>KN(e),id),this.onlineState="Unknown",this.q_=new Set}}async function OI(t,e){const n=U(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Gq),i)try{s.k_=await n.onListen(r)}catch(o){const a=iu(o,`Initialization of query '${xa(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&MI(n)}async function LI(t,e){const n=U(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function Qq(t,e){const n=U(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&MI(n)}function Yq(t,e,n){const r=U(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function MI(t){t.q_.forEach(e=>{e.next()})}class VI{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new kl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=kl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jq{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e){this.serializer=e}hs(e){return Zr(this.serializer,e)}Ps(e){return e.metadata.exists?yx(this.serializer,e.document,!1):ze.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return mt(e)}}class Xq{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Xx(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;const r=we.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){const n=new Map,r=new PA(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||ae()).add(s);n.set(o,a)}}return n}async complete(){const e=await Cq(this.localStore,new PA(this.serializer),this.documents,this.X_.id),n=this.ta(this.documents);for(const r of this.queries)await Pq(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function Xx(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(e){this.key=e}}class eD{constructor(e){this.key=e}}class tD{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=ae(),this.mutatedKeys=ae(),this._a=YN(e),this.aa=new al(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new CA,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((c,h)=>{const d=i.get(c),f=sd(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let v=!1;d&&f?d.data.isEqual(f.data)?p!==m&&(r.track({type:3,doc:f}),v=!0):this.ha(d,f)||(r.track({type:2,doc:f}),v=!0,(l&&this._a(f,l)>0||u&&this._a(f,u)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),v=!0):d&&!f&&(r.track({type:1,doc:d}),v=!0,(l||u)&&(a=!0)),v&&(f?(o=o.add(f),s=m?s.add(c):s.delete(c)):(o=o.delete(c),s=s.delete(c)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const c=this.query.limitType==="F"?o.last():o.first();o=o.delete(c.key),s=s.delete(c.key),r.track({type:1,doc:c})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const o=e.la.L_();o.sort((c,h)=>function(f,p){const m=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return m(f)-m(p)}(c.type,h.type)||this._a(c.doc,h.doc)),this.Pa(r),i=i!=null&&i;const a=n&&!i?this.Ia():[],l=this.oa.size===0&&this.current&&!i?1:0,u=l!==this.sa;return this.sa=l,o.length!==0||u?{snapshot:new kl(this.query,e.aa,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new CA,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=ae(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new eD(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new Zx(r))}),n}da(e){this.ia=e.ls,this.oa=ae();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return kl.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class Zq{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class eW{constructor(e){this.key=e,this.Ra=!1}}class tW{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Zs(a=>KN(a),id),this.fa=new Map,this.ga=new Set,this.pa=new nt(V.comparator),this.ya=new Map,this.wa=new SI,this.Sa={},this.ba=new Map,this.Da=Jo.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function nW(t,e){const n=zI(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=await Pl(n.localStore,vn(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await FI(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Ym(n.remoteStore,o)}return i}async function FI(t,e,n,r,i){t.va=(h,d,f)=>async function(m,v,g,_){let y=v.view.ca(g);y.Zi&&(y=await Np(m.localStore,v.query,!1).then(({documents:A})=>v.view.ca(A,y)));const T=_&&_.targetChanges.get(v.targetId),b=_&&_.targetMismatches.get(v.targetId)!=null,w=v.view.applyChanges(y,m.isPrimaryClient,T,b);return Fv(m,v.targetId,w.Ta),w.snapshot}(t,h,d,f);const s=await Np(t.localStore,e,!0),o=new tD(e,s.ls),a=o.ca(s.documents),l=ld.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);Fv(t,n,u.Ta);const c=new Zq(e,n,o);return t.ma.set(e,c),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),u.snapshot}async function rW(t,e){const n=U(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!id(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await bl(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),mh(n.remoteStore,r.targetId),Nl(n,r.targetId)}).catch(Js)):(Nl(n,r.targetId),await bl(n.localStore,r.targetId,!0))}async function iW(t,e,n){const r=jI(t);try{const i=await function(o,a){const l=U(o),u=Qe.now(),c=a.reduce((f,p)=>f.add(p.key),ae());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=Nn(),m=ae();return l.ss.getEntries(f,c).next(v=>{p=v,p.forEach((g,_)=>{_.isValidDocument()||(m=m.add(g))})}).next(()=>l.localDocuments.getOverlayedDocuments(f,p)).next(v=>{h=v;const g=[];for(const _ of a){const y=Dj(_,h.get(_.key).overlayedDocument);y!=null&&g.push(new Vi(_.key,y,UN(y.value.mapValue),Ge.exists(!0)))}return l.mutationQueue.addMutationBatch(f,u,g,a)}).next(v=>{d=v;const g=v.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(f,v.batchId,g)})}).then(()=>({batchId:d.batchId,changes:XN(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Sa[o.currentUser.toKey()];u||(u=new nt(se)),u=u.insert(a,l),o.Sa[o.currentUser.toKey()]=u}(r,i.batchId,n),await Fi(r,i.changes),await nu(r.remoteStore)}catch(i){const s=iu(i,"Failed to persist write");n.reject(s)}}async function nD(t,e){const n=U(t);try{const r=await Rq(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.ya.get(s);o&&(Q(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?Q(o.Ra):i.removedDocuments.size>0&&(Q(o.Ra),o.Ra=!1))}),await Fi(n,r,e)}catch(r){await Js(r)}}function bA(t,e,n){const r=U(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=U(o);l.onlineState=a;let u=!1;l.queries.forEach((c,h)=>{for(const d of h.listeners)d.Q_(a)&&(u=!0)}),u&&MI(l)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function sW(t,e,n){const r=U(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new nt(V.comparator);o=o.insert(s,ze.newNoDocument(s,Y.min()));const a=ae().add(s),l=new ad(Y.min(),new Map,new nt(se),o,a);await nD(r,l),r.pa=r.pa.remove(s),r.ya.delete(e),$I(r)}else await bl(r.localStore,e,!1).then(()=>Nl(r,e,n)).catch(Js)}async function oW(t,e){const n=U(t),r=e.batch.batchId;try{const i=await Sq(n.localStore,e);BI(n,r,null),UI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Fi(n,i)}catch(i){await Js(i)}}async function aW(t,e,n){const r=U(t);try{const i=await function(o,a){const l=U(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return l.mutationQueue.lookupMutationBatch(u,a).next(h=>(Q(h!==null),c=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,c,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>l.localDocuments.getDocuments(u,c))})}(r.localStore,e);BI(r,e,n),UI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Fi(r,i)}catch(i){await Js(i)}}async function lW(t,e){const n=U(t);eo(n.remoteStore)||N("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=U(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){const i=iu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function UI(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function BI(t,e,n){const r=U(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Nl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||rD(t,r)})}function rD(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);n!==null&&(mh(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),$I(t))}function Fv(t,e,n){for(const r of n)r instanceof Zx?(t.wa.addReference(r.key,e),uW(t,r)):r instanceof eD?(N("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||rD(t,r.key)):q()}function uW(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(N("SyncEngine","New document in limbo: "+n),t.ga.add(r),$I(t))}function $I(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new V(we.fromString(e)),r=t.Da.next();t.ya.set(r,new eW(n)),t.pa=t.pa.insert(n,r),Ym(t.remoteStore,new mi(vn(Xl(n.path)),r,"TargetPurposeLimboResolution",bn._e))}}async function Fi(t,e,n){const r=U(t),i=[],s=[],o=[];r.ma.isEmpty()||(r.ma.forEach((a,l)=>{o.push(r.va(l,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,u!=null&&u.fromCache?"not-current":"current"),u){i.push(u);const c=CI.Qi(l.targetId,u);s.push(c)}}))}),await Promise.all(o),r.Va.a_(i),await async function(l,u){const c=U(l);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>I.forEach(u,d=>I.forEach(d.ki,f=>c.persistence.referenceDelegate.addReference(h,d.targetId,f)).next(()=>I.forEach(d.qi,f=>c.persistence.referenceDelegate.removeReference(h,d.targetId,f)))))}catch(h){if(!Xs(h))throw h;N("LocalStore","Failed to update sequence numbers: "+h)}for(const h of u){const d=h.targetId;if(!h.fromCache){const f=c.ts.get(d),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);c.ts=c.ts.insert(d,m)}}}(r.localStore,s))}async function cW(t,e){const n=U(t);if(!n.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());const r=await Fx(n.localStore,e);n.currentUser=e,function(s,o){s.ba.forEach(a=>{a.forEach(l=>{l.reject(new k(R.CANCELLED,o))})}),s.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Fi(n,r._s)}}function hW(t,e){const n=U(t),r=n.ya.get(e);if(r&&r.Ra)return ae().add(r.key);{let i=ae();const s=n.fa.get(e);if(!s)return i;for(const o of s){const a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}async function dW(t,e){const n=U(t),r=await Np(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&Fv(n,e.targetId,i.Ta),i}async function fW(t,e){const n=U(t);return zx(n.localStore,e).then(r=>Fi(n,r))}async function pW(t,e,n,r){const i=U(t),s=await function(a,l){const u=U(a),c=U(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",h=>c.Cn(h,l).next(d=>d?u.localDocuments.getDocuments(h,d):I.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await nu(i.remoteStore):n==="acknowledged"||n==="rejected"?(BI(i,e,r||null),UI(i,e),function(a,l){U(U(a).mutationQueue).Fn(l)}(i.localStore,e)):q(),await Fi(i,s)):N("SyncEngine","Cannot apply mutation batch with id: "+e)}async function mW(t,e){const n=U(t);if(zI(n),jI(n),e===!0&&n.Ca!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await kA(n,r.toArray());n.Ca=!0,await Vv(n.remoteStore,!0);for(const s of i)Ym(n.remoteStore,s)}else if(e===!1&&n.Ca!==!1){const r=[];let i=Promise.resolve();n.fa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Nl(n,o),bl(n.localStore,o,!0))),mh(n.remoteStore,o)}),await i,await kA(n,r),function(o){const a=U(o);a.ya.forEach((l,u)=>{mh(a.remoteStore,u)}),a.wa.Vr(),a.ya=new Map,a.pa=new nt(V.comparator)}(n),n.Ca=!1,await Vv(n.remoteStore,!1)}}async function kA(t,e,n){const r=U(t),i=[],s=[];for(const o of e){let a;const l=r.fa.get(o);if(l&&l.length!==0){a=await Pl(r.localStore,vn(l[0]));for(const u of l){const c=r.ma.get(u),h=await dW(r,c);h.snapshot&&s.push(h.snapshot)}}else{const u=await $x(r.localStore,o);a=await Pl(r.localStore,u),await FI(r,iD(u),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i}function iD(t){return GN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function gW(t){return function(n){return U(U(n).persistence).Bi()}(U(t).localStore)}async function _W(t,e,n,r){const i=U(t);if(i.Ca)return void N("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await zx(i.localStore,QN(s[0])),a=ad.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Tt.EMPTY_BYTE_STRING);await Fi(i,o,a);break}case"rejected":await bl(i.localStore,e,!0),Nl(i,e,r);break;default:q()}}async function yW(t,e,n){const r=zI(t);if(r.Ca){for(const i of e){if(r.fa.has(i)){N("SyncEngine","Adding an already active target "+i);continue}const s=await $x(r.localStore,i),o=await Pl(r.localStore,s);await FI(r,iD(s),o.targetId,!1,o.resumeToken),Ym(r.remoteStore,o)}for(const i of n)r.fa.has(i)&&await bl(r.localStore,i,!1).then(()=>{mh(r.remoteStore,i),Nl(r,i)}).catch(Js)}}function zI(t){const e=U(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=nD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hW.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sW.bind(null,e),e.Va.a_=Qq.bind(null,e.eventManager),e.Va.Fa=Yq.bind(null,e.eventManager),e}function jI(t){const e=U(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=oW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aW.bind(null,e),e}function vW(t,e,n){const r=U(t);(async function(s,o,a){try{const l=await o.getMetadata();if(await function(f,p){const m=U(f),v=mt(p.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",g=>m.Kr.getBundleMetadata(g,p.id)).then(g=>!!g&&g.createTime.compareTo(v)>=0)}(s.localStore,l))return await o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(Xx(l));const u=new Xq(l,s.localStore,o.serializer);let c=await o.Ma();for(;c;){const d=await u.ea(c);d&&a._updateProgress(d),c=await o.Ma()}const h=await u.complete();return await Fi(s,h.ra,void 0),await function(f,p){const m=U(f);return m.persistence.runTransaction("Save bundle","readwrite",v=>m.Kr.saveBundleMetadata(v,p))}(s.localStore,l),a._completeWith(h.progress),Promise.resolve(h.na)}catch(l){return Nr("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Uv{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=ud(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Vx(this.persistence,new Mx,e.initialUser,this.serializer)}createPersistence(e){return new Lx(Qm.jr,this.serializer)}createSharedClientState(e){return new qx}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class sD extends Uv{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await jI(this.xa.syncEngine),await nu(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return Vx(this.persistence,new Mx,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new aq(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new qz(n,this.persistence);return new jz(e.asyncQueue,r)}createPersistence(e){const n=AI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new RI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Wx(),Df(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new qx}}class wW extends sD{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xa.syncEngine;this.sharedClientState instanceof B_&&(this.sharedClientState.syncEngine={Ys:pW.bind(null,n),Zs:_W.bind(null,n),Xs:yW.bind(null,n),Bi:gW.bind(null,n),Js:fW.bind(null,n)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await mW(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=Wx();if(!B_.D(n))throw new k(R.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=AI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new B_(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class qI{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>bA(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=cW.bind(null,this.syncEngine),await Vv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Kq}()}createDatastore(e){const n=ud(e.databaseInfo.databaseId),r=function(s){return new xq(s)}(e.databaseInfo);return function(s,o,a,l){return new Lq(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Vq(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>bA(this.syncEngine,n,0),function(){return RA.D()?new RA:new bq}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,c){const h=new tW(i,s,o,a,l,u);return c&&(h.Ca=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=U(n);N("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await tu(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):pt("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EW{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new Lt,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const n=this.La.decode(e),r=Number(n);isNaN(r)&&this.Qa(`length string (${n}) is not valid number`);const i=await this.Ka(r);return new Jq(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e===123)}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const n=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IW{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(R.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(i,s){const o=U(i),a=fh(o.serializer)+"/documents",l={documents:s.map(d=>dh(o.serializer,d))},u=await o.Co("BatchGetDocuments",a,l,s.length),c=new Map;u.forEach(d=>{const f=zj(o.serializer,d);c.set(f.key.toString(),f)});const h=[];return s.forEach(d=>{const f=c.get(d.toString());Q(!!f),h.push(f)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new eu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=V.fromPath(r);this.mutations.push(new mI(i,this.precondition(i)))}),await async function(r,i){const s=U(r),o=fh(s.serializer)+"/documents",a={writes:i.map(l=>ph(s.serializer,l))};await s.wo("Commit",o,a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw q();n=Y.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new k(R.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Y.min())?Ge.exists(!1):Ge.updateTime(n):Ge.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Y.min()))throw new k(R.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ge.updateTime(n)}return Ge.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TW{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new bI(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new IW(this.datastore),n=this.za(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const n=this.updateFunction(e);return!nd(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!ux(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SW{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Nt.UNAUTHENTICATED,this.clientId=RN.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{N("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(N("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Lt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=iu(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Of(t,e){t.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Fx(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Bv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await WI(t);N("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>AA(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>AA(e.remoteStore,s)),t._onlineComponents=e}function oD(t){return t.name==="FirebaseError"?t.code===R.FAILED_PRECONDITION||t.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function WI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{await Of(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!oD(n))throw n;Nr("Error using user provided cache. Falling back to memory cache: "+n),await Of(t,new Uv)}}else N("FirestoreClient","Using default OfflineComponentProvider"),await Of(t,new Uv);return t._offlineComponents}async function Xm(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),await Bv(t,t._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),await Bv(t,new qI))),t._onlineComponents}function aD(t){return WI(t).then(e=>e.persistence)}function HI(t){return WI(t).then(e=>e.localStore)}function lD(t){return Xm(t).then(e=>e.remoteStore)}function GI(t){return Xm(t).then(e=>e.syncEngine)}function RW(t){return Xm(t).then(e=>e.datastore)}async function xl(t){const e=await Xm(t),n=e.eventManager;return n.onListen=nW.bind(null,e.syncEngine),n.onUnlisten=rW.bind(null,e.syncEngine),n}function AW(t){return t.asyncQueue.enqueue(async()=>{const e=await aD(t),n=await lD(t);return e.setNetworkEnabled(!0),function(i){const s=U(i);return s.C_.delete(0),cd(s)}(n)})}function CW(t){return t.asyncQueue.enqueue(async()=>{const e=await aD(t),n=await lD(t);return e.setNetworkEnabled(!1),async function(i){const s=U(i);s.C_.add(0),await tu(s),s.M_.set("Offline")}(n)})}function PW(t,e){const n=new Lt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await function(u,c){const h=U(u);return h.persistence.runTransaction("read document","readonly",d=>h.localDocuments.getDocument(d,c))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new k(R.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=iu(a,`Failed to get document '${s} from cache`);o.reject(l)}}(await HI(t),e,n)),n.promise}function uD(t,e,n={}){const r=new Lt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const c=new Jm({next:d=>{o.enqueueAndForget(()=>LI(s,h));const f=d.docs.has(a);!f&&d.fromCache?u.reject(new k(R.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&l&&l.source==="server"?u.reject(new k(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new VI(Xl(a.path),c,{includeMetadataChanges:!0,J_:!0});return OI(s,h)}(await xl(t),t.asyncQueue,e,n,r)),r.promise}function bW(t,e){const n=new Lt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await Np(i,s,!0),l=new tD(s,a.ls),u=l.ca(a.documents),c=l.applyChanges(u,!1);o.resolve(c.snapshot)}catch(a){const l=iu(a,`Failed to execute query '${s} against cache`);o.reject(l)}}(await HI(t),e,n)),n.promise}function cD(t,e,n={}){const r=new Lt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const c=new Jm({next:d=>{o.enqueueAndForget(()=>LI(s,h)),d.fromCache&&l.source==="server"?u.reject(new k(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new VI(a,c,{includeMetadataChanges:!0,J_:!0});return OI(s,h)}(await xl(t),t.asyncQueue,e,n,r)),r.promise}function kW(t,e){const n=new Jm(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){U(i).q_.add(s),s.next()}(await xl(t),n)),()=>{n.Na(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){U(i).q_.delete(s)}(await xl(t),n))}}function NW(t,e,n,r){const i=function(o,a){let l;return l=typeof o=="string"?hx().encode(o):o,function(c,h){return new EW(c,h)}(function(c,h){if(c instanceof Uint8Array)return NA(c,h);if(c instanceof ArrayBuffer)return NA(new Uint8Array(c),h);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,ud(e));t.asyncQueue.enqueueAndForget(async()=>{vW(await GI(t),i,r)})}function xW(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=U(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(await HI(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hD(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(t,e,n){if(!n)throw new k(R.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dD(t,e,n,r){if(e===!0&&r===!0)throw new k(R.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function DA(t){if(!V.isDocumentKey(t))throw new k(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function OA(t){if(V.isDocumentKey(t))throw new k(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Zm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":q()}function Ie(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new k(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Zm(t);throw new k(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function fD(t,e){if(e<=0)throw new k(R.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hD((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new k(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new k(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new k(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hd{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new LA({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new k(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new LA(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new xz;switch(r.type){case"firstParty":return new Mz(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=xA.get(n);r&&(N("ComponentProvider","Removing Datastore"),xA.delete(n),r.terminate())}(this),Promise.resolve()}}function DW(t,e,n,r={}){var i;const s=(t=Ie(t,hd))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Nr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Nt.MOCK_USER;else{a=r1(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new k(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Nt(u)}t._authCredentials=new Dz(new SN(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wn=class pD{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pD(this.firestore,e,this._query)}},Ze=class mD{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ts(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mD(this.firestore,e,this._key)}},Ts=class gD extends wn{constructor(e,n,r){super(e,n,Xl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new V(e))}withConverter(e){return new gD(this.firestore,e,this._path)}};function _D(t,e,...n){if(t=H(t),KI("collection","path",e),t instanceof hd){const r=we.fromString(e,...n);return OA(r),new Ts(t,null,r)}{if(!(t instanceof Ze||t instanceof Ts))throw new k(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return OA(r),new Ts(t.firestore,null,r)}}function OW(t,e){if(t=Ie(t,hd),KI("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(R.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new wn(t,null,function(r){return new Mi(we.emptyPath(),r)}(e))}function Lp(t,e,...n){if(t=H(t),arguments.length===1&&(e=RN.newId()),KI("doc","path",e),t instanceof hd){const r=we.fromString(e,...n);return DA(r),new Ze(t,null,new V(r))}{if(!(t instanceof Ze||t instanceof Ts))throw new k(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return DA(r),new Ze(t.firestore,t instanceof Ts?t.converter:null,new V(r))}}function yD(t,e){return t=H(t),e=H(e),(t instanceof Ze||t instanceof Ts)&&(e instanceof Ze||e instanceof Ts)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function vD(t,e){return t=H(t),e=H(e),t instanceof wn&&e instanceof wn&&t.firestore===e.firestore&&id(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LW{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new bI(this,"async_queue_retry"),this.iu=()=>{const n=Df();n&&N("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=Df();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=Df();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new Lt;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!Xs(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw pt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=DI.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&q()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}function $v(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class MW{constructor(){this._progressObserver={},this._taskCompletionResolver=new Lt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VW=-1;let lt=class extends hd{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new LW}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||wD(this),this._firestoreClient.terminate()}};function Bt(t){return t._firestoreClient||wD(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function wD(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,u,c){return new hj(a,l,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,hD(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new SW(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function FW(t,e){ID(t=Ie(t,lt));const n=Bt(t);if(n._uninitializedComponentsProvider)throw new k(R.FAILED_PRECONDITION,"SDK cache is already specified.");Nr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new qI;return ED(n,i,new sD(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function UW(t){ID(t=Ie(t,lt));const e=Bt(t);if(e._uninitializedComponentsProvider)throw new k(R.FAILED_PRECONDITION,"SDK cache is already specified.");Nr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new qI;return ED(e,r,new wW(r,n.cacheSizeBytes))}function ED(t,e,n){const r=new Lt;return t.asyncQueue.enqueue(async()=>{try{await Of(t,n),await Bv(t,e),r.resolve()}catch(i){const s=i;if(!oD(s))throw s;Nr("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function BW(t){if(t._initialized&&!t._terminated)throw new k(R.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Lt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Sr.D())return Promise.resolve();const i=r+"main";await Sr.delete(i)}(AI(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function $W(t){return function(n){const r=new Lt;return n.asyncQueue.enqueueAndForget(async()=>lW(await GI(n),r)),r.promise}(Bt(t=Ie(t,lt)))}function zW(t){return AW(Bt(t=Ie(t,lt)))}function jW(t){return CW(Bt(t=Ie(t,lt)))}function qW(t,e){const n=Bt(t=Ie(t,lt)),r=new MW;return NW(n,t._databaseId,e,r),r}function WW(t,e){return xW(Bt(t=Ie(t,lt)),e).then(n=>n?new wn(t,null,n.query):null)}function ID(t){if(t._initialized||t._terminated)throw new k(R.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ni(Tt.fromBase64String(e))}catch(n){throw new k(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ni(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fs=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new k(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new He(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let da=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new k(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new k(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HW=/^__.*__$/;class GW{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Vi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Zl(e,this.data,n,this.fieldTransforms)}}class TD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Vi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function SD(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}class tg{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new tg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return Mp(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(SD(this.Iu)&&HW.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class KW{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ud(e)}pu(e,n,r,i=!1){return new tg({Iu:e,methodName:n,gu:r,path:He.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fa(t){const e=t._freezeSettings(),n=ud(t._databaseId);return new KW(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ng(t,e,n,r,i,s={}){const o=t.pu(s.merge||s.mergeFields?2:0,e,n,i);XI("Data must be an object, but it was:",o,r);const a=CD(r,o);let l,u;if(s.merge)l=new kn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const c=[];for(const h of s.mergeFields){const d=zv(e,h,n);if(!o.contains(d))throw new k(R.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);bD(c,d)||c.push(d)}l=new kn(c),u=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=o.fieldTransforms;return new GW(new Kt(a),l,u)}class dd extends da{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof dd}}function RD(t,e,n){return new tg({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class QI extends da{_toFieldTransform(e){return new od(e.path,new Rl)}isEqual(e){return e instanceof QI}}class QW extends da{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=RD(this,e,!0),r=this.yu.map(s=>pa(s,n)),i=new Go(r);return new od(e.path,i)}isEqual(e){return this===e}}class YW extends da{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=RD(this,e,!0),r=this.yu.map(s=>pa(s,n)),i=new Ko(r);return new od(e.path,i)}isEqual(e){return this===e}}class JW extends da{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){const n=new Al(e.serializer,nx(e.serializer,this.wu));return new od(e.path,n)}isEqual(e){return this===e}}function YI(t,e,n,r){const i=t.pu(1,e,n);XI("Data must be an object, but it was:",i,r);const s=[],o=Kt.empty();ha(r,(l,u)=>{const c=ZI(e,l,n);u=H(u);const h=i.Ru(c);if(u instanceof dd)s.push(c);else{const d=pa(u,h);d!=null&&(s.push(c),o.set(c,d))}});const a=new kn(s);return new TD(o,a,i.fieldTransforms)}function JI(t,e,n,r,i,s){const o=t.pu(1,e,n),a=[zv(e,r,n)],l=[i];if(s.length%2!=0)throw new k(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(zv(e,s[d])),l.push(s[d+1]);const u=[],c=Kt.empty();for(let d=a.length-1;d>=0;--d)if(!bD(u,a[d])){const f=a[d];let p=l[d];p=H(p);const m=o.Ru(f);if(p instanceof dd)u.push(f);else{const v=pa(p,m);v!=null&&(u.push(f),c.set(f,v))}}const h=new kn(u);return new TD(c,h,o.fieldTransforms)}function AD(t,e,n,r=!1){return pa(n,t.pu(r?4:3,e))}function pa(t,e){if(PD(t=H(t)))return XI("Unsupported field value:",e,t),CD(t,e);if(t instanceof da)return function(r,i){if(!SD(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=pa(a,i.Vu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=H(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return nx(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Qe.fromDate(r);return{timestampValue:Cl(i.serializer,s)}}if(r instanceof Qe){const s=new Qe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Cl(i.serializer,s)}}if(r instanceof eg)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ni)return{bytesValue:px(i.serializer,r._byteString)};if(r instanceof Ze){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wI(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${Zm(r)}`)}(t,e)}function CD(t,e){const n={};return MN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ha(t,(r,i)=>{const s=pa(i,e.Eu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function PD(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Qe||t instanceof eg||t instanceof ni||t instanceof Ze||t instanceof da)}function XI(t,e,n){if(!PD(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Zm(n);throw r==="an object"?e.mu(t+" a custom object"):e.mu(t+" "+r)}}function zv(t,e,n){if((e=H(e))instanceof Fs)return e._internalPath;if(typeof e=="string")return ZI(t,e);throw Mp("Field path arguments must be of type string or ",t,!1,void 0,n)}const XW=new RegExp("[~\\*/\\[\\]]");function ZI(t,e,n){if(e.search(XW)>=0)throw Mp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Fs(...e.split("."))._internalPath}catch{throw Mp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Mp(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new k(R.INVALID_ARGUMENT,a+t+l)}function bD(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(rg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ZW extends gh{data(){return super.data()}}function rg(t,e){return typeof e=="string"?ZI(t,e):e instanceof Fs?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kD(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new k(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eT{}let fd=class extends eT{};function Yi(t,e,...n){let r=[];e instanceof eT&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof tT).length,a=s.filter(l=>l instanceof ig).length;if(o>1||o>0&&a>0)throw new k(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class ig extends fd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ig(e,n,r)}_apply(e){const n=this._parse(e);return MD(e._query,n),new wn(e.firestore,e.converter,bv(e._query,n))}_parse(e){const n=fa(e.firestore);return function(s,o,a,l,u,c,h){let d;if(u.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new k(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){VA(h,c);const f=[];for(const p of h)f.push(MA(l,s,p));d={arrayValue:{values:f}}}else d=MA(l,s,h)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||VA(h,c),d=AD(a,o,h,c==="in"||c==="not-in");return me.create(u,c,d)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function e3(t,e,n){const r=e,i=rg("where",t);return ig._create(i,r,n)}class tT extends eT{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new tT(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ce.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)MD(o,l),o=bv(o,l)}(e._query,n),new wn(e.firestore,e.converter,bv(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class nT extends fd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new nT(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new k(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new hh(s,o)}(e._query,this._field,this._direction);return new wn(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Mi(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function t3(t,e="asc"){const n=e,r=rg("orderBy",t);return nT._create(r,n)}class sg extends fd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new sg(e,n,r)}_apply(e){return new wn(e.firestore,e.converter,Cp(e._query,this._limit,this._limitType))}}function n3(t){return fD("limit",t),sg._create("limit",t,"F")}function r3(t){return fD("limitToLast",t),sg._create("limitToLast",t,"L")}let ND=class xD extends fd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new xD(e,n,r)}_apply(e){const n=LD(e,this.type,this._docOrFields,this._inclusive);return new wn(e.firestore,e.converter,function(i,s){return new Mi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function i3(...t){return ND._create("startAt",t,!0)}function s3(...t){return ND._create("startAfter",t,!1)}let DD=class OD extends fd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new OD(e,n,r)}_apply(e){const n=LD(e,this.type,this._docOrFields,this._inclusive);return new wn(e.firestore,e.converter,function(i,s){return new Mi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function o3(...t){return DD._create("endBefore",t,!1)}function a3(...t){return DD._create("endAt",t,!0)}function LD(t,e,n,r){if(n[0]=H(n[0]),n[0]instanceof gh)return function(s,o,a,l,u){if(!l)throw new k(R.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const c=[];for(const h of ol(s))if(h.field.isKeyField())c.push(Wo(o,l.key));else{const d=l.data.field(h.field);if(qm(d))throw new k(R.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){const f=h.field.canonicalString();throw new k(R.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}c.push(d)}return new Ms(c,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=fa(t.firestore);return function(o,a,l,u,c,h){const d=o.explicitOrderBy;if(c.length>d.length)throw new k(R.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let p=0;p<c.length;p++){const m=c[p];if(d[p].field.isKeyField()){if(typeof m!="string")throw new k(R.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof m}`);if(!fI(o)&&m.indexOf("/")!==-1)throw new k(R.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${m}' contains a slash.`);const v=o.path.child(we.fromString(m));if(!V.isDocumentKey(v))throw new k(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);const g=new V(v);f.push(Wo(a,g))}else{const v=AD(l,u,m);f.push(v)}}return new Ms(f,h)}(t._query,t.firestore._databaseId,i,e,n,r)}}function MA(t,e,n){if(typeof(n=H(n))=="string"){if(n==="")throw new k(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fI(e)&&n.indexOf("/")!==-1)throw new k(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(we.fromString(n));if(!V.isDocumentKey(r))throw new k(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wo(t,new V(r))}if(n instanceof Ze)return Wo(t,n._key);throw new k(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zm(n)}.`)}function VA(t,e){if(!Array.isArray(t)||t.length===0)throw new k(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function MD(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new k(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class rT{convertValue(e,n="none"){switch(qo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ds(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw q()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ha(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new eg(ot(e.latitude),ot(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=hI(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(lh(e));default:return null}}convertTimestamp(e){const n=xs(e);return new Qe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=we.fromString(e);Q(Sx(r));const i=new Os(r.get(1),r.get(3)),s=new V(r.popFirst(5));return i.isEqual(n)||pt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class l3 extends rT{constructor(e){super(),this.firestore=e}convertBytes(e){return new ni(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let ki=class extends gh{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(rg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},yc=class extends ki{data(e={}){return super.data(e)}},Us=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ro(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new yc(this._firestore,this._userDataWriter,r.key,r,new Ro(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new k(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new yc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ro(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new yc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ro(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,c=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),c=o.indexOf(a.doc.key)),{type:u3(a.type),doc:l,oldIndex:u,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function u3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function VD(t,e){return t instanceof ki&&e instanceof ki?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Us&&e instanceof Us&&t._firestore===e._firestore&&vD(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c3(t){t=Ie(t,Ze);const e=Ie(t.firestore,lt);return uD(Bt(e),t._key).then(n=>iT(e,t,n))}class ma extends rT{constructor(e){super(),this.firestore=e}convertBytes(e){return new ni(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,n)}}function h3(t){t=Ie(t,Ze);const e=Ie(t.firestore,lt),n=Bt(e),r=new ma(e);return PW(n,t._key).then(i=>new ki(e,r,t._key,i,new Ro(i!==null&&i.hasLocalMutations,!0),t.converter))}function d3(t){t=Ie(t,Ze);const e=Ie(t.firestore,lt);return uD(Bt(e),t._key,{source:"server"}).then(n=>iT(e,t,n))}function f3(t){t=Ie(t,wn);const e=Ie(t.firestore,lt),n=Bt(e),r=new ma(e);return kD(t._query),cD(n,t._query).then(i=>new Us(e,r,t,i))}function p3(t){t=Ie(t,wn);const e=Ie(t.firestore,lt),n=Bt(e),r=new ma(e);return bW(n,t._query).then(i=>new Us(e,r,t,i))}function m3(t){t=Ie(t,wn);const e=Ie(t.firestore,lt),n=Bt(e),r=new ma(e);return cD(n,t._query,{source:"server"}).then(i=>new Us(e,r,t,i))}function FA(t,e,n){t=Ie(t,Ze);const r=Ie(t.firestore,lt),i=og(t.converter,e,n);return pd(r,[ng(fa(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ge.none())])}function UA(t,e,n,...r){t=Ie(t,Ze);const i=Ie(t.firestore,lt),s=fa(i);let o;return o=typeof(e=H(e))=="string"||e instanceof Fs?JI(s,"updateDoc",t._key,e,n,r):YI(s,"updateDoc",t._key,e),pd(i,[o.toMutation(t._key,Ge.exists(!0))])}function g3(t){return pd(Ie(t.firestore,lt),[new eu(t._key,Ge.none())])}function _3(t,e){const n=Ie(t.firestore,lt),r=Lp(t),i=og(t.converter,e);return pd(n,[ng(fa(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Ge.exists(!1))]).then(()=>r)}function FD(t,...e){var n,r,i;t=H(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||$v(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if($v(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,u,c;if(t instanceof Ze)u=Ie(t.firestore,lt),c=Xl(t._key.path),l={next:h=>{e[o]&&e[o](iT(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Ie(t,wn);u=Ie(h.firestore,lt),c=h._query;const d=new ma(u);l={next:f=>{e[o]&&e[o](new Us(u,d,h,f))},error:e[o+1],complete:e[o+2]},kD(t._query)}return function(d,f,p,m){const v=new Jm(m),g=new VI(f,v,p);return d.asyncQueue.enqueueAndForget(async()=>OI(await xl(d),g)),()=>{v.Na(),d.asyncQueue.enqueueAndForget(async()=>LI(await xl(d),g))}}(Bt(u),c,a,l)}function y3(t,e){return kW(Bt(t=Ie(t,lt)),$v(e)?e:{next:e})}function pd(t,e){return function(r,i){const s=new Lt;return r.asyncQueue.enqueueAndForget(async()=>iW(await GI(r),i,s)),s.promise}(Bt(t),e)}function iT(t,e,n){const r=n.docs.get(e._key),i=new ma(t);return new ki(t,i,e._key,r,new Ro(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let w3=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=fa(e)}set(e,n,r){this._verifyNotCommitted();const i=ss(e,this._firestore),s=og(i.converter,n,r),o=ng(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ge.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=ss(e,this._firestore);let o;return o=typeof(n=H(n))=="string"||n instanceof Fs?JI(this._dataReader,"WriteBatch.update",s._key,n,r,i):YI(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Ge.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=ss(e,this._firestore);return this._mutations=this._mutations.concat(new eu(n._key,Ge.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ss(t,e){if((t=H(t)).firestore!==e)throw new k(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E3=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=fa(n)}get(n){const r=ss(n,this._firestore),i=new l3(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return q();const o=s[0];if(o.isFoundDocument())return new gh(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new gh(this._firestore,i,r._key,null,r.converter);throw q()})}set(n,r,i){const s=ss(n,this._firestore),o=og(s.converter,r,i),a=ng(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=ss(n,this._firestore);let a;return a=typeof(r=H(r))=="string"||r instanceof Fs?JI(this._dataReader,"Transaction.update",o._key,r,i,s):YI(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=ss(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=ss(e,this._firestore),r=new ma(this._firestore);return super.get(e).then(i=>new ki(this._firestore,r,n._key,i._document,new Ro(!1,!1),n.converter))}};function I3(t,e,n){t=Ie(t,lt);const r=Object.assign(Object.assign({},v3),n);return function(s){if(s.maxAttempts<1)throw new k(R.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new Lt;return s.asyncQueue.enqueueAndForget(async()=>{const u=await RW(s);new TW(s.asyncQueue,u,a,o,l).run()}),l.promise}(Bt(t),i=>e(new E3(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T3(){return new dd("deleteField")}function S3(){return new QI("serverTimestamp")}function R3(...t){return new QW("arrayUnion",t)}function A3(...t){return new YW("arrayRemove",t)}function C3(t){return new JW("increment",t)}(function(e,n=!0){(function(i){Jl=i})(Li),Pi(new Vn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new lt(new Oz(r.getProvider("auth-internal")),new Fz(r.getProvider("app-check-internal")),function(u,c){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new k(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Os(u.options.projectId,c)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),hr(DR,"4.4.0",e),hr(DR,"4.4.0","esm2017")})();const P3="@firebase/firestore-compat",b3="0.3.23";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BA(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function $A(){if(!uj())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}let UD=class jv{constructor(e){this._delegate=e}static fromBase64String(e){return $A(),new jv(ni.fromBase64String(e))}static fromUint8Array(e){return BA(),new jv(ni.fromUint8Array(e))}toBase64(){return $A(),this._delegate.toBase64()}toUint8Array(){return BA(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(t){return k3(t,["next","error","complete"])}function k3(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{enableIndexedDbPersistence(e,n){return FW(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return UW(e._delegate)}clearIndexedDbPersistence(e){return BW(e._delegate)}}class BD{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Os||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Nr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){DW(this._delegate,e,n,r)}enableNetwork(){return zW(this._delegate)}disableNetwork(){return jW(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,dD("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return $W(this._delegate)}onSnapshotsInSync(e){return y3(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Dl(this,_D(this._delegate,e))}catch(n){throw fn(n,"collection()","Firestore.collection()")}}doc(e){try{return new or(this,Lp(this._delegate,e))}catch(n){throw fn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new vh(this,OW(this._delegate,e))}catch(n){throw fn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return I3(this._delegate,n=>e(new $D(this,n)))}batch(){return Bt(this._delegate),new zD(new w3(this._delegate,e=>pd(this._delegate,e)))}loadBundle(e){return qW(this._delegate,e)}namedQuery(e){return WW(this._delegate,e).then(n=>n?new vh(this,n):null)}}class ag extends rT{constructor(e){super(),this.firestore=e}convertBytes(e){return new UD(new ni(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return or.forKey(n,this.firestore,null)}}function x3(t){kz(t)}class $D{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new ag(e)}get(e){const n=Ao(e);return this._delegate.get(n).then(r=>new _h(this._firestore,new ki(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Ao(e);return r?(sT("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Ao(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Ao(e);return this._delegate.delete(n),this}}class zD{constructor(e){this._delegate=e}set(e,n,r){const i=Ao(e);return r?(sT("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Ao(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Ao(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Xo{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new yc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new yh(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Xo.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new Xo(e,new ag(e),n),i.set(n,s)),s}}Xo.INSTANCES=new WeakMap;class or{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new ag(e)}static forPath(e,n,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new or(n,new Ze(n._delegate,r,new V(e)))}static forKey(e,n,r){return new or(n,new Ze(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Dl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Dl(this.firestore,_D(this._delegate,e))}catch(n){throw fn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=H(e),e instanceof Ze?yD(this._delegate,e):!1}set(e,n){n=sT("DocumentReference.set",n);try{return n?FA(this._delegate,e,n):FA(this._delegate,e)}catch(r){throw fn(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?UA(this._delegate,e):UA(this._delegate,e,n,...r)}catch(i){throw fn(i,"updateDoc()","DocumentReference.update()")}}delete(){return g3(this._delegate)}onSnapshot(...e){const n=jD(e),r=qD(e,i=>new _h(this.firestore,new ki(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return FD(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=h3(this._delegate):(e==null?void 0:e.source)==="server"?n=d3(this._delegate):n=c3(this._delegate),n.then(r=>new _h(this.firestore,new ki(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new or(this.firestore,e?this._delegate.withConverter(Xo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function fn(t,e,n){return t.message=t.message.replace(e,n),t}function jD(t){for(const e of t)if(typeof e=="object"&&!qv(e))return e;return{}}function qD(t,e){var n,r;let i;return qv(t[0])?i=t[0]:qv(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class _h{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new or(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return VD(this._delegate,e._delegate)}}class yh extends _h{data(e){const n=this._delegate.data(e);return this._delegate._converter||Nz(n!==void 0),n}}let vh=class Vr{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new ag(e)}where(e,n,r){try{return new Vr(this.firestore,Yi(this._delegate,e3(e,n,r)))}catch(i){throw fn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Vr(this.firestore,Yi(this._delegate,t3(e,n)))}catch(r){throw fn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Vr(this.firestore,Yi(this._delegate,n3(e)))}catch(n){throw fn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Vr(this.firestore,Yi(this._delegate,r3(e)))}catch(n){throw fn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Vr(this.firestore,Yi(this._delegate,i3(...e)))}catch(n){throw fn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Vr(this.firestore,Yi(this._delegate,s3(...e)))}catch(n){throw fn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Vr(this.firestore,Yi(this._delegate,o3(...e)))}catch(n){throw fn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Vr(this.firestore,Yi(this._delegate,a3(...e)))}catch(n){throw fn(n,"endAt()","Query.endAt()")}}isEqual(e){return vD(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=p3(this._delegate):(e==null?void 0:e.source)==="server"?n=m3(this._delegate):n=f3(this._delegate),n.then(r=>new Wv(this.firestore,new Us(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=jD(e),r=qD(e,i=>new Wv(this.firestore,new Us(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return FD(this._delegate,n,r)}withConverter(e){return new Vr(this.firestore,e?this._delegate.withConverter(Xo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};class D3{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new yh(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Wv{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new vh(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new yh(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new D3(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new yh(this._firestore,r))})}isEqual(e){return VD(this._delegate,e._delegate)}}class Dl extends vh{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new or(this.firestore,e):null}doc(e){try{return e===void 0?new or(this.firestore,Lp(this._delegate)):new or(this.firestore,Lp(this._delegate,e))}catch(n){throw fn(n,"doc()","CollectionReference.doc()")}}add(e){return _3(this._delegate,e).then(n=>new or(this.firestore,n))}isEqual(e){return yD(this._delegate,e._delegate)}withConverter(e){return new Dl(this.firestore,e?this._delegate.withConverter(Xo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ao(t){return Ie(t,Ze)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(...e){this._delegate=new Fs(...e)}static documentId(){return new oT(He.keyField().canonicalString())}isEqual(e){return e=H(e),e instanceof Fs?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this._delegate=e}static serverTimestamp(){const e=S3();return e._methodName="FieldValue.serverTimestamp",new go(e)}static delete(){const e=T3();return e._methodName="FieldValue.delete",new go(e)}static arrayUnion(...e){const n=R3(...e);return n._methodName="FieldValue.arrayUnion",new go(n)}static arrayRemove(...e){const n=A3(...e);return n._methodName="FieldValue.arrayRemove",new go(n)}static increment(e){const n=C3(e);return n._methodName="FieldValue.increment",new go(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3={Firestore:BD,GeoPoint:eg,Timestamp:Qe,Blob:UD,Transaction:$D,WriteBatch:zD,DocumentReference:or,DocumentSnapshot:_h,Query:vh,QueryDocumentSnapshot:yh,QuerySnapshot:Wv,CollectionReference:Dl,FieldPath:oT,FieldValue:go,setLogLevel:x3,CACHE_SIZE_UNLIMITED:VW};function L3(t,e){t.INTERNAL.registerComponent(new Vn("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},O3)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M3(t){L3(t,(e,n)=>new BD(e,n,new N3)),t.registerVersion(P3,b3)}M3(Ks);function aT(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}const Fu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ba={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V3(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function WD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const F3=V3,U3=WD,HD=new la("auth","Firebase",WD());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp=new Kl("@firebase/auth");function B3(t,...e){Vp.logLevel<=de.WARN&&Vp.warn(`Auth (${Li}): ${t}`,...e)}function Lf(t,...e){Vp.logLevel<=de.ERROR&&Vp.error(`Auth (${Li}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(t,...e){throw lT(t,...e)}function Jt(t,...e){return lT(t,...e)}function GD(t,e,n){const r=Object.assign(Object.assign({},U3()),{[e]:n});return new la("auth","Firebase",r).create(e,{appName:t.name})}function su(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Zt(t,"argument-error"),GD(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function lT(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return HD.create(t,...e)}function O(t,e,...n){if(!t)throw lT(e,...n)}function Yr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Lf(e),new Error(e)}function xr(t,e){t||Yr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function uT(){return zA()==="http:"||zA()==="https:"}function zA(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uT()||i1()||"connection"in navigator)?navigator.onLine:!0}function z3(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,n){this.shortDelay=e,this.longDelay=n,xr(n>e,"Short delay should be less than long delay!"),this.isMobile=LE()||Rm()}get(){return $3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT(t,e){xr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=new md(3e4,6e4);function ct(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ht(t,e,n,r,i={}){return QD(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=ua(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),KD.fetch()(YD(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function QD(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},j3),e);try{const i=new H3(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw tc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw tc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw tc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw tc(t,"user-disabled",o);const c=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw GD(t,c,u);Zt(t,c)}}catch(i){if(i instanceof _n)throw i;Zt(t,"network-request-failed",{message:String(i)})}}async function Ui(t,e,n,r,i={}){const s=await ht(t,e,n,r,i);return"mfaPendingCredential"in s&&Zt(t,"multi-factor-auth-required",{_serverResponse:s}),s}function YD(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?cT(t.config,i):`${t.config.apiScheme}://${i}`}function W3(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class H3{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Jt(this.auth,"network-request-failed")),q3.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function tc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Jt(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jA(t){return t!==void 0&&t.getResponse!==void 0}function qA(t){return t!==void 0&&t.enterprise!==void 0}class G3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return W3(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K3(t){return(await ht(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Q3(t,e){return ht(t,"GET","/v2/recaptchaConfig",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y3(t,e){return ht(t,"POST","/v1/accounts:delete",e)}async function J3(t,e){return ht(t,"POST","/v1/accounts:update",e)}async function X3(t,e){return ht(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Z3(t,e=!1){const n=H(t),r=await n.getIdToken(e),i=lg(r);O(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:vc(z_(i.auth_time)),issuedAtTime:vc(z_(i.iat)),expirationTime:vc(z_(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function z_(t){return Number(t)*1e3}function lg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Lf("JWT malformed, contained fewer than 3 sections"),null;try{const i=pp(n);return i?JSON.parse(i):(Lf("Failed to decode base64 JWT payload"),null)}catch(i){return Lf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function e9(t){const e=lg(t);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ni(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof _n&&t9(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function t9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=vc(this.lastLoginAt),this.creationTime=vc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ni(t,X3(n,{idToken:r}));O(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?s9(s.providerUserInfo):[],a=i9(t.providerData,o),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),c=l?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new JD(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,h)}async function r9(t){const e=H(t);await Eh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function i9(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function s9(t){return t.map(e=>{var{providerId:n}=e,r=aT(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o9(t,e){const n=await QD(t,{},async()=>{const r=ua({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=YD(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",KD.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function a9(t,e){return ht(t,"POST","/v2/accounts:revokeToken",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):e9(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return O(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await o9(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ih;return r&&(O(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(O(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ih,this.toJSON())}_performRefresh(){return Yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(t,e){O(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class xo{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=aT(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new n9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new JD(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ni(this,this.stsTokenManager.getToken(this.auth,e));return O(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Z3(this,e)}reload(){return r9(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new xo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Eh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Ni(this,Y3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,u,c;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,d=(i=n.email)!==null&&i!==void 0?i:void 0,f=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,m=(a=n.tenantId)!==null&&a!==void 0?a:void 0,v=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,g=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(c=n.lastLoginAt)!==null&&c!==void 0?c:void 0,{uid:y,emailVerified:T,isAnonymous:b,providerData:w,stsTokenManager:A}=n;O(y&&A,e,"internal-error");const x=Ih.fromJSON(this.name,A);O(typeof y=="string",e,"internal-error"),Ji(h,e.name),Ji(d,e.name),O(typeof T=="boolean",e,"internal-error"),O(typeof b=="boolean",e,"internal-error"),Ji(f,e.name),Ji(p,e.name),Ji(m,e.name),Ji(v,e.name),Ji(g,e.name),Ji(_,e.name);const $=new xo({uid:y,auth:e,email:d,emailVerified:T,displayName:h,isAnonymous:b,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:x,createdAt:g,lastLoginAt:_});return w&&Array.isArray(w)&&($.providerData=w.map(G=>Object.assign({},G))),v&&($._redirectEventId=v),$}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ih;i.updateFromServerResponse(n);const s=new xo({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Eh(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WA=new Map;function qn(t){xr(t instanceof Function,"Expected a class definition");let e=WA.get(t);return e?(xr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,WA.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}XD.type="NONE";const Ol=XD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(t,e,n){return`firebase:${t}:${e}:${n}`}class ll{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Do(this.userKey,i.apiKey,s),this.fullPersistenceKey=Do("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?xo._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ll(qn(Ol),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||qn(Ol);const o=Do(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const c=await u._get(o);if(c){const h=xo._fromJSON(e,c);u!==s&&(a=h),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new ll(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ll(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ZD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nO(e))return"Blackberry";if(rO(e))return"Webos";if(hT(e))return"Safari";if((e.includes("chrome/")||eO(e))&&!e.includes("edge/"))return"Chrome";if(gd(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ZD(t=tt()){return/firefox\//i.test(t)}function hT(t=tt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function eO(t=tt()){return/crios\//i.test(t)}function tO(t=tt()){return/iemobile/i.test(t)}function gd(t=tt()){return/android/i.test(t)}function nO(t=tt()){return/blackberry/i.test(t)}function rO(t=tt()){return/webos/i.test(t)}function ou(t=tt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function l9(t=tt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function u9(t=tt()){var e;return ou(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function c9(){return s1()&&document.documentMode===10}function iO(t=tt()){return ou(t)||gd(t)||rO(t)||nO(t)||/windows phone/i.test(t)||tO(t)}function h9(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sO(t,e=[]){let n;switch(t){case"Browser":n=HA(tt());break;case"Worker":n=`${HA(tt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Li}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f9(t,e={}){return ht(t,"GET","/v2/passwordPolicy",ct(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p9=6;class m9{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:p9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new GA(this),this.idTokenSubscription=new GA(this),this.beforeStateQueue=new d9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=HD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=qn(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ll.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Eh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=z3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?H(e):null;return n&&O(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(qn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await f9(this),n=new m9(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new la("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await a9(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&qn(e)||this._popupRedirectResolver;O(n,this,"argument-error"),this.redirectPersistenceManager=await ll.create(this,[qn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=sO(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&B3(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ut(t){return H(t)}class GA{constructor(e){this.auth=e,this.observer=null,this.addObserver=l1(n=>this.observer=n)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function dT(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Jt("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",_9().appendChild(r)})}function oO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const y9="https://www.google.com/recaptcha/enterprise.js?render=",v9="recaptcha-enterprise",w9="NO_RECAPTCHA";class E9{constructor(e){this.type=v9,this.auth=ut(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{Q3(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new G3(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;qA(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(w9)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&qA(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}dT(y9+a).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})}}async function KA(t,e,n,r=!1){const i=new E9(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Th(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await KA(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await KA(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}function I9(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(qn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function T9(t,e,n){const r=ut(t);O(r._canInitEmulator,r,"emulator-config-failed"),O(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=aO(e),{host:o,port:a}=S9(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||R9()}function aO(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function S9(t){const e=aO(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:QA(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:QA(o)}}}function QA(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function R9(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Yr("not implemented")}_getIdTokenResponse(e){return Yr("not implemented")}_linkToIdToken(e,n){return Yr("not implemented")}_getReauthenticationResolver(e){return Yr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lO(t,e){return ht(t,"POST","/v1/accounts:resetPassword",ct(t,e))}async function A9(t,e){return ht(t,"POST","/v1/accounts:update",e)}async function C9(t,e){return ht(t,"POST","/v1/accounts:signUp",e)}async function P9(t,e){return ht(t,"POST","/v1/accounts:update",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b9(t,e){return Ui(t,"POST","/v1/accounts:signInWithPassword",ct(t,e))}async function ug(t,e){return ht(t,"POST","/v1/accounts:sendOobCode",ct(t,e))}async function k9(t,e){return ug(t,e)}async function N9(t,e){return ug(t,e)}async function x9(t,e){return ug(t,e)}async function D9(t,e){return ug(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O9(t,e){return Ui(t,"POST","/v1/accounts:signInWithEmailLink",ct(t,e))}async function L9(t,e){return Ui(t,"POST","/v1/accounts:signInWithEmailLink",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh extends au{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Sh(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Sh(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Th(e,n,"signInWithPassword",b9);case"emailLink":return O9(e,{email:this._email,oobCode:this._password});default:Zt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Th(e,r,"signUpPassword",C9);case"emailLink":return L9(e,{idToken:n,email:this._email,oobCode:this._password});default:Zt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ii(t,e){return Ui(t,"POST","/v1/accounts:signInWithIdp",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9="http://localhost";class ri extends au{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ri(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=aT(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new ri(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ii(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ii(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ii(e,n)}buildRequest(){const e={requestUri:M9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ua(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V9(t,e){return ht(t,"POST","/v1/accounts:sendVerificationCode",ct(t,e))}async function F9(t,e){return Ui(t,"POST","/v1/accounts:signInWithPhoneNumber",ct(t,e))}async function U9(t,e){const n=await Ui(t,"POST","/v1/accounts:signInWithPhoneNumber",ct(t,e));if(n.temporaryProof)throw tc(t,"account-exists-with-different-credential",n);return n}const B9={USER_NOT_FOUND:"user-not-found"};async function $9(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Ui(t,"POST","/v1/accounts:signInWithPhoneNumber",ct(t,n),B9)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo extends au{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Oo({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Oo({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return F9(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return U9(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return $9(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new Oo({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z9(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function j9(t){const e=Ya(Qu(t)).link,n=e?Ya(Qu(e)).deep_link_id:null,r=Ya(Qu(t)).deep_link_id;return(r?Ya(Qu(r)).link:null)||r||n||e||t}class cg{constructor(e){var n,r,i,s,o,a;const l=Ya(Qu(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,c=(r=l.oobCode)!==null&&r!==void 0?r:null,h=z9((i=l.mode)!==null&&i!==void 0?i:null);O(u&&c&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=c,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=j9(e);try{return new cg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){this.providerId=to.PROVIDER_ID}static credential(e,n){return Sh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=cg.parseLink(n);return O(r,"argument-error"),Sh._fromEmailAndCode(e,r.code,r.tenantId)}}to.PROVIDER_ID="password";to.EMAIL_PASSWORD_SIGN_IN_METHOD="password";to.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu extends Bi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ul extends lu{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return O("providerId"in n&&"signInMethod"in n,"argument-error"),ri._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return O(e.idToken||e.accessToken,"argument-error"),ri._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ul.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ul.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!n&&!s||!a)return null;try{return new ul(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r extends lu{constructor(){super("facebook.com")}static credential(e){return ri._fromParams({providerId:$r.PROVIDER_ID,signInMethod:$r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $r.credentialFromTaggedObject(e)}static credentialFromError(e){return $r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $r.credential(e.oauthAccessToken)}catch{return null}}}$r.FACEBOOK_SIGN_IN_METHOD="facebook.com";$r.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr extends lu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ri._fromParams({providerId:zr.PROVIDER_ID,signInMethod:zr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return zr.credentialFromTaggedObject(e)}static credentialFromError(e){return zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return zr.credential(n,r)}catch{return null}}}zr.GOOGLE_SIGN_IN_METHOD="google.com";zr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr extends lu{constructor(){super("github.com")}static credential(e){return ri._fromParams({providerId:jr.PROVIDER_ID,signInMethod:jr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jr.credentialFromTaggedObject(e)}static credentialFromError(e){return jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jr.credential(e.oauthAccessToken)}catch{return null}}}jr.GITHUB_SIGN_IN_METHOD="github.com";jr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q9="http://localhost";class Ll extends au{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return Ii(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ii(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ii(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new Ll(r,s)}static _create(e,n){return new Ll(e,n)}buildRequest(){return{requestUri:q9,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W9="saml.";class Fp extends Bi{constructor(e){O(e.startsWith(W9),"argument-error"),super(e)}static credentialFromResult(e){return Fp.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Fp.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=Ll.fromJSON(e);return O(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return Ll._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr extends lu{constructor(){super("twitter.com")}static credential(e,n){return ri._fromParams({providerId:qr.PROVIDER_ID,signInMethod:qr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return qr.credentialFromTaggedObject(e)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return qr.credential(n,r)}catch{return null}}}qr.TWITTER_SIGN_IN_METHOD="twitter.com";qr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uO(t,e){return Ui(t,"POST","/v1/accounts:signUp",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await xo._fromIdTokenResponse(e,r,i),o=YA(r);return new pr({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=YA(r);return new pr({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function YA(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H9(t){var e;const n=ut(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new pr({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await uO(n,{returnSecureToken:!0}),i=await pr._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up extends _n{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Up.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Up(e,n,r,i)}}function cO(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Up._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hO(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G9(t,e){const n=H(t);await hg(!0,n,e);const{providerUserInfo:r}=await J3(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=hO(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function fT(t,e,n=!1){const r=await Ni(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return pr._forOperation(t,"link",r)}async function hg(t,e,n){await Eh(e);const r=hO(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";O(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dO(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await Ni(t,cO(r,i,e,t),n);O(s.idToken,r,"internal-error");const o=lg(s.idToken);O(o,r,"internal-error");const{sub:a}=o;return O(t.uid===a,r,"user-mismatch"),pr._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Zt(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fO(t,e,n=!1){const r="signIn",i=await cO(t,r,e),s=await pr._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function dg(t,e){return fO(ut(t),e)}async function pO(t,e){const n=H(t);return await hg(!1,n,e.providerId),fT(n,e)}async function mO(t,e){return dO(H(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K9(t,e){return Ui(t,"POST","/v1/accounts:signInWithCustomToken",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q9(t,e){const n=ut(t),r=await K9(n,{token:e,returnSecureToken:!0}),i=await pr._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?pT._fromServerResponse(e,n):"totpInfo"in n?mT._fromServerResponse(e,n):Zt(e,"internal-error")}}class pT extends _d{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new pT(n)}}class mT extends _d{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new mT(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t,e,n){var r;O(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),O(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(O(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(O(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gT(t){const e=ut(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Y9(t,e,n){const r=ut(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&fg(r,i,n),await Th(r,i,"getOobCode",N9)}async function J9(t,e,n){await lO(H(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&gT(t),r})}async function X9(t,e){await P9(H(t),{oobCode:e})}async function gO(t,e){const n=H(t),r=await lO(n,{oobCode:e}),i=r.requestType;switch(O(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":O(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":O(r.mfaInfo,n,"internal-error");default:O(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=_d._fromServerResponse(ut(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function Z9(t,e){const{data:n}=await gO(H(t),e);return n.email}async function e5(t,e,n){const r=ut(t),o=await Th(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uO).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&gT(t),l}),a=await pr._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function t5(t,e,n){return dg(H(t),to.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&gT(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n5(t,e,n){const r=ut(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){O(a.handleCodeInApp,r,"argument-error"),a&&fg(r,o,a)}s(i,n),await Th(r,i,"getOobCode",x9)}function r5(t,e){const n=cg.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function i5(t,e,n){const r=H(t),i=to.credentialWithLink(e,n||wh());return O(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),dg(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s5(t,e){return ht(t,"POST","/v1/accounts:createAuthUri",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o5(t,e){const n=uT()?wh():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await s5(H(t),r);return i||[]}async function a5(t,e){const n=H(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&fg(n.auth,i,e);const{email:s}=await k9(n.auth,i);s!==t.email&&await t.reload()}async function l5(t,e,n){const r=H(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&fg(r.auth,s,n);const{email:o}=await D9(r.auth,s);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u5(t,e){return ht(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c5(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=H(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Ni(r,u5(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function h5(t,e){return _O(H(t),e,null)}function d5(t,e){return _O(H(t),null,e)}async function _O(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const o=await Ni(t,A9(r,s));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f5(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const o=(n=(e=lg(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new cl(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new p5(s,i);case"github.com":return new m5(s,i);case"google.com":return new g5(s,i);case"twitter.com":return new _5(s,i,t.screenName||null);case"custom":case"anonymous":return new cl(s,null);default:return new cl(s,r,i)}}class cl{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class yO extends cl{constructor(e,n,r,i){super(e,n,r),this.username=i}}class p5 extends cl{constructor(e,n){super(e,"facebook.com",n)}}class m5 extends yO{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class g5 extends cl{constructor(e,n){super(e,"google.com",n)}}class _5 extends yO{constructor(e,n,r){super(e,"twitter.com",n,r)}}function y5(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:f5(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new Co("enroll",e,n)}static _fromMfaPendingCredential(e){return new Co("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Co._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Co._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=ut(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>_d._fromServerResponse(r,a));O(i.mfaPendingCredential,r,"internal-error");const o=Co._fromMfaPendingCredential(i.mfaPendingCredential);return new _T(o,s,async a=>{const l=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const u=Object.assign(Object.assign({},i),{idToken:l.idToken,refreshToken:l.refreshToken});switch(n.operationType){case"signIn":const c=await pr._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(c.user),c;case"reauthenticate":return O(n.user,r,"internal-error"),pr._forOperation(n.user,n.operationType,u);default:Zt(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function v5(t,e){var n;const r=H(t),i=e;return O(e.customData.operationType,r,"argument-error"),O((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),_T._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w5(t,e){return ht(t,"POST","/v2/accounts/mfaEnrollment:start",ct(t,e))}function E5(t,e){return ht(t,"POST","/v2/accounts/mfaEnrollment:finalize",ct(t,e))}function I5(t,e){return ht(t,"POST","/v2/accounts/mfaEnrollment:withdraw",ct(t,e))}class yT{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>_d._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new yT(e)}async getSession(){return Co._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),s=await Ni(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Ni(this.user,I5(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const j_=new WeakMap;function T5(t){const e=H(t);return j_.has(e)||j_.set(e,yT._fromUser(e)),j_.get(e)}const Bp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Bp,"1"),this.storage.removeItem(Bp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S5(){const t=tt();return hT(t)||ou(t)}const R5=1e3,A5=10;class wO extends vO{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=S5()&&h9(),this.fallbackToPolling=iO(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);c9()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,A5):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},R5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}wO.type="LOCAL";const vT=wO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO extends vO{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}EO.type="SESSION";const Zo=EO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C5(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new pg(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await C5(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=yd("",20);i.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===u)switch(d.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(d.data.response);break;default:clearTimeout(c),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(){return window}function b5(t){_t().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){return typeof _t().WorkerGlobalScope<"u"&&typeof _t().importScripts=="function"}async function k5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function N5(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function x5(){return wT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO="firebaseLocalStorageDb",D5=1,$p="firebaseLocalStorage",TO="fbase_key";class vd{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function mg(t,e){return t.transaction([$p],e?"readwrite":"readonly").objectStore($p)}function O5(){const t=indexedDB.deleteDatabase(IO);return new vd(t).toPromise()}function Hv(){const t=indexedDB.open(IO,D5);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore($p,{keyPath:TO})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains($p)?e(r):(r.close(),await O5(),e(await Hv()))})})}async function JA(t,e,n){const r=mg(t,!0).put({[TO]:e,value:n});return new vd(r).toPromise()}async function L5(t,e){const n=mg(t,!1).get(e),r=await new vd(n).toPromise();return r===void 0?null:r.value}function XA(t,e){const n=mg(t,!0).delete(e);return new vd(n).toPromise()}const M5=800,V5=3;class SO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>V5)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pg._getInstance(x5()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await k5(),!this.activeServiceWorker)return;this.sender=new P5(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||N5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hv();return await JA(e,Bp,"1"),await XA(e,Bp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>JA(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>L5(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>XA(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=mg(i,!1).getAll();return new vd(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),M5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}SO.type="LOCAL";const Rh=SO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(t,e){return ht(t,"POST","/v2/accounts/mfaSignIn:start",ct(t,e))}function U5(t,e){return ht(t,"POST","/v2/accounts/mfaSignIn:finalize",ct(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B5=500,$5=6e4,lf=1e12;class z5{constructor(e){this.auth=e,this.counter=lf,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new j5(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||lf;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||lf;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||lf;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class j5{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;O(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=q5(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},$5)},B5))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function q5(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=oO("rcb"),W5=new md(3e4,6e4),H5="https://www.google.com/recaptcha/api.js?";class G5{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=_t().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return O(K5(n),e,"argument-error"),this.shouldResolveImmediately(n)&&jA(_t().grecaptcha)?Promise.resolve(_t().grecaptcha):new Promise((r,i)=>{const s=_t().setTimeout(()=>{i(Jt(e,"network-request-failed"))},W5.get());_t()[q_]=()=>{_t().clearTimeout(s),delete _t()[q_];const a=_t().grecaptcha;if(!a||!jA(a)){i(Jt(e,"internal-error"));return}const l=a.render;a.render=(u,c)=>{const h=l(u,c);return this.counter++,h},this.hostLanguage=n,r(a)};const o=`${H5}?${ua({onload:q_,render:"explicit",hl:n})}`;dT(o).catch(()=>{clearTimeout(s),i(Jt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=_t().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function K5(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class Q5{async load(e){return new z5(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO="recaptcha",Y5={theme:"light",type:"image"};let J5=class{constructor(e,n,r=Object.assign({},Y5)){this.parameters=r,this.type=RO,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ut(e),this.isInvisible=this.parameters.size==="invisible",O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;O(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Q5:new G5,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){O(!this.parameters.sitekey,this.auth,"argument-error"),O(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=_t()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){O(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){O(uT()&&!wT(),this.auth,"internal-error"),await X5(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await K3(this.auth);O(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return O(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function X5(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Oo._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function Z5(t,e,n){const r=ut(t),i=await gg(r,e,H(n));return new ET(i,s=>dg(r,s))}async function e6(t,e,n){const r=H(t);await hg(!1,r,"phone");const i=await gg(r.auth,e,H(n));return new ET(i,s=>pO(r,s))}async function t6(t,e,n){const r=H(t),i=await gg(r.auth,e,H(n));return new ET(i,s=>mO(r,s))}async function gg(t,e,n){var r;const i=await n.verify();try{O(typeof i=="string",t,"argument-error"),O(n.type===RO,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const o=s.session;if("phoneNumber"in s)return O(o.type==="enroll",t,"internal-error"),(await w5(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{O(o.type==="signin",t,"internal-error");const a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return O(a,t,"missing-multi-factor-info"),(await F5(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await V9(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{n._reset()}}async function n6(t,e){await fT(H(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea=class Mf{constructor(e){this.providerId=Mf.PROVIDER_ID,this.auth=ut(e)}verifyPhoneNumber(e,n){return gg(this.auth,e,H(n))}static credential(e,n){return Oo._fromVerification(e,n)}static credentialFromResult(e){const n=e;return Mf.credentialFromTaggedObject(n)}static credentialFromError(e){return Mf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Oo._fromTokenResponse(n,r):null}};ea.PROVIDER_ID="phone";ea.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(t,e){return e?qn(e):(O(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT extends au{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ii(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ii(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ii(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function r6(t){return fO(t.auth,new IT(t),t.bypassAuthState)}function i6(t){const{auth:e,user:n}=t;return O(n,e,"internal-error"),dO(n,new IT(t),t.bypassAuthState)}async function s6(t){const{auth:e,user:n}=t;return O(n,e,"internal-error"),fT(n,new IT(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return r6;case"linkViaPopup":case"linkViaRedirect":return s6;case"reauthViaPopup":case"reauthViaRedirect":return i6;default:Zt(this.auth,"internal-error")}}resolve(e){xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o6=new md(2e3,1e4);async function a6(t,e,n){const r=ut(t);su(t,e,Bi);const i=ga(r,n);return new gi(r,"signInViaPopup",e,i).executeNotNull()}async function l6(t,e,n){const r=H(t);su(r.auth,e,Bi);const i=ga(r.auth,n);return new gi(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function u6(t,e,n){const r=H(t);su(r.auth,e,Bi);const i=ga(r.auth,n);return new gi(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class gi extends AO{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,gi.currentPopupAction&&gi.currentPopupAction.cancel(),gi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return O(e,this.auth,"internal-error"),e}async onExecution(){xr(this.filter.length===1,"Popup operations only handle one event");const e=yd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Jt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Jt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,o6.get())};e()}}gi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c6="pendingRedirect",wc=new Map;class h6 extends AO{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=wc.get(this.auth._key());if(!e){try{const r=await d6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}wc.set(this.auth._key(),e)}return this.bypassAuthState||wc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function d6(t,e){const n=PO(e),r=CO(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function TT(t,e){return CO(t)._set(PO(e),"true")}function f6(){wc.clear()}function ST(t,e){wc.set(t._key(),e)}function CO(t){return qn(t._redirectPersistence)}function PO(t){return Do(c6,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p6(t,e,n){return m6(t,e,n)}async function m6(t,e,n){const r=ut(t);su(t,e,Bi),await r._initializationPromise;const i=ga(r,n);return await TT(i,r),i._openRedirect(r,e,"signInViaRedirect")}function g6(t,e,n){return _6(t,e,n)}async function _6(t,e,n){const r=H(t);su(r.auth,e,Bi),await r.auth._initializationPromise;const i=ga(r.auth,n);await TT(i,r.auth);const s=await bO(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function y6(t,e,n){return v6(t,e,n)}async function v6(t,e,n){const r=H(t);su(r.auth,e,Bi),await r.auth._initializationPromise;const i=ga(r.auth,n);await hg(!1,r,e.providerId),await TT(i,r.auth);const s=await bO(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function w6(t,e){return await ut(t)._initializationPromise,_g(t,e,!1)}async function _g(t,e,n=!1){const r=ut(t),i=ga(r,e),o=await new h6(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function bO(t){const e=yd(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E6=10*60*1e3;class kO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!I6(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!NO(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Jt(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=E6&&this.cachedEventUids.clear(),this.cachedEventUids.has(ZA(e))}saveEventToCache(e){this.cachedEventUids.add(ZA(e)),this.lastProcessedEventTime=Date.now()}}function ZA(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function NO({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function I6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return NO(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xO(t,e={}){return ht(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,S6=/^https?/;async function R6(t){if(t.config.emulator)return;const{authorizedDomains:e}=await xO(t);for(const n of e)try{if(A6(n))return}catch{}Zt(t,"unauthorized-domain")}function A6(t){const e=wh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!S6.test(n))return!1;if(T6.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=new md(3e4,6e4);function eC(){const t=_t().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function P6(t){return new Promise((e,n)=>{var r,i,s;function o(){eC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{eC(),n(Jt(t,"network-request-failed"))},timeout:C6.get()})}if(!((i=(r=_t().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=_t().gapi)===null||s===void 0)&&s.load)o();else{const a=oO("iframefcb");return _t()[a]=()=>{gapi.load?o():n(Jt(t,"network-request-failed"))},dT(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Vf=null,e})}let Vf=null;function b6(t){return Vf=Vf||P6(t),Vf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k6=new md(5e3,15e3),N6="__/auth/iframe",x6="emulator/auth/iframe",D6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},O6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function L6(t){const e=t.config;O(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?cT(e,x6):`https://${t.config.authDomain}/${N6}`,r={apiKey:e.apiKey,appName:t.name,v:Li},i=O6.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${ua(r).slice(1)}`}async function M6(t){const e=await b6(t),n=_t().gapi;return O(n,t,"internal-error"),e.open({where:document.body,url:L6(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:D6,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Jt(t,"network-request-failed"),a=_t().setTimeout(()=>{s(o)},k6.get());function l(){_t().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},F6=500,U6=600,B6="_blank",$6="http://localhost";class tC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function z6(t,e,n,r=F6,i=U6){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},V6),{width:r.toString(),height:i.toString(),top:s,left:o}),u=tt().toLowerCase();n&&(a=eO(u)?B6:n),ZD(u)&&(e=e||$6,l.scrollbars="yes");const c=Object.entries(l).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(u9(u)&&a!=="_self")return j6(e||"",a),new tC(null);const h=window.open(e||"",a,c);O(h,t,"popup-blocked");try{h.focus()}catch{}return new tC(h)}function j6(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q6="__/auth/handler",W6="emulator/auth/handler",H6=encodeURIComponent("fac");async function Gv(t,e,n,r,i,s){O(t.config.authDomain,t,"auth-domain-config-required"),O(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Li,eventId:i};if(e instanceof Bi){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",mp(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,h]of Object.entries(s||{}))o[c]=h}if(e instanceof lu){const c=e.getScopes().filter(h=>h!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];const l=await t._getAppCheckToken(),u=l?`#${H6}=${encodeURIComponent(l)}`:"";return`${G6(t)}?${ua(a).slice(1)}${u}`}function G6({config:t}){return t.emulator?cT(t,W6):`https://${t.authDomain}/${q6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W_="webStorageSupport";class K6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zo,this._completeRedirectFn=_g,this._overrideRedirectResult=ST}async _openPopup(e,n,r,i){var s;xr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await Gv(e,n,r,wh(),i);return z6(e,o,yd())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Gv(e,n,r,wh(),i);return b5(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(xr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await M6(e),r=new kO(e);return n.register("authEvent",i=>(O(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(W_,{type:W_},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[W_];o!==void 0&&n(!!o),Zt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=R6(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return iO()||hT()||ou()}}const Q6=K6;class Y6{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Yr("unexpected MultiFactorSessionType")}}}class RT extends Y6{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new RT(e)}_finalizeEnroll(e,n,r){return E5(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return U5(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class DO{constructor(){}static assertion(e){return RT._fromCredential(e)}}DO.FACTOR_ID="phone";var nC="@firebase/auth",rC="1.5.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X6(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function Z6(t){Pi(new Vn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;O(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sO(t)},u=new g9(r,i,s,l);return I9(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Pi(new Vn("auth-internal",e=>{const n=ut(e.getProvider("auth").getImmediate());return(r=>new J6(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),hr(nC,rC,X6(t)),hr(nC,rC,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eH=5*60;G2("authIdTokenMaxAge");Z6("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ta(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tH=2e3;async function nH(t,e,n){var r;const{BuildInfo:i}=ta();xr(e.sessionId,"AuthEvent did not contain a session ID");const s=await aH(e.sessionId),o={};return ou()?o.ibi=i.packageName:gd()?o.apn=i.packageName:Zt(t,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Gv(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function rH(t){const{BuildInfo:e}=ta(),n={};ou()?n.iosBundleId=e.packageName:gd()?n.androidPackageName=e.packageName:Zt(t,"operation-not-supported-in-this-environment"),await xO(t,n)}function iH(t){const{cordova:e}=ta();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,l9()?"_blank":"_system","location=yes"),n(i)})})}async function sH(t,e,n){const{cordova:r}=ta();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function l(){var h;s();const d=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function u(){a||(a=window.setTimeout(()=>{o(Jt(t,"redirect-cancelled-by-user"))},tH))}function c(){(document==null?void 0:document.visibilityState)==="visible"&&u()}e.addPassiveListener(l),document.addEventListener("resume",u,!1),gd()&&document.addEventListener("visibilitychange",c,!1),i=()=>{e.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",c,!1),a&&window.clearTimeout(a)}})}finally{i()}}function oH(t){var e,n,r,i,s,o,a,l,u,c;const h=ta();O(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),O(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),O(typeof((s=(i=(r=h==null?void 0:h.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((l=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||l===void 0?void 0:l.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((c=(u=h==null?void 0:h.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||c===void 0?void 0:c.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function aH(t){const e=lH(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function lH(t){if(xr(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uH=20;class cH extends kO{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function hH(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:pH(),postBody:null,tenantId:t.tenantId,error:Jt(t,"no-auth-event")}}function dH(t,e){return Kv()._set(Qv(t),e)}async function iC(t){const e=await Kv()._get(Qv(t));return e&&await Kv()._remove(Qv(t)),e}function fH(t,e){var n,r;const i=gH(e);if(i.includes("/__/auth/callback")){const s=Ff(i),o=s.firebaseError?mH(decodeURIComponent(s.firebaseError)):null,a=(r=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],l=a?Jt(a):null;return l?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function pH(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<uH;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function Kv(){return qn(vT)}function Qv(t){return Do("authEvent",t.config.apiKey,t.name)}function mH(t){try{return JSON.parse(t)}catch{return null}}function gH(t){const e=Ff(t),n=e.link?decodeURIComponent(e.link):void 0,r=Ff(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Ff(i).link||i||r||n||t}function Ff(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Ya(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _H=500;class yH{constructor(){this._redirectPersistence=Zo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=_g,this._overrideRedirectResult=ST}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new cH(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Zt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){oH(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),f6(),await this._originValidation(e);const o=hH(e,r,i);await dH(e,o);const a=await nH(e,o,n),l=await iH(a);return sH(e,s,l)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=rH(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=ta(),o=setTimeout(async()=>{await iC(e),n.onEvent(sC())},_H),a=async c=>{clearTimeout(o);const h=await iC(e);let d=null;h&&(c!=null&&c.url)&&(d=fH(h,c.url)),n.onEvent(d||sC())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const l=i,u=`${s.packageName.toLowerCase()}://`;ta().handleOpenURL=async c=>{if(c.toLowerCase().startsWith(u)&&a({url:c}),typeof l=="function")try{l(c)}catch(h){console.error(h)}}}}const vH=yH;function sC(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Jt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wH(t,e){ut(t)._logFramework(e)}var EH="@firebase/auth-compat",IH="0.5.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TH=1e3;function Ec(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function SH(){return Ec()==="http:"||Ec()==="https:"}function OO(t=tt()){return!!((Ec()==="file:"||Ec()==="ionic:"||Ec()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function RH(){return Rm()||ME()}function AH(){return s1()&&(document==null?void 0:document.documentMode)===11}function CH(t=tt()){return/Edge\/\d+/.test(t)}function PH(t=tt()){return AH()||CH(t)}function LO(){try{const t=self.localStorage,e=yd();if(t)return t.setItem(e,"1"),t.removeItem(e),PH()?Gc():!0}catch{return AT()&&Gc()}return!1}function AT(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function H_(){return(SH()||i1()||OO())&&!RH()&&LO()&&!AT()}function MO(){return OO()&&typeof document<"u"}async function bH(){return MO()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},TH);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function kH(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n={LOCAL:"local",NONE:"none",SESSION:"session"},Uu=O,VO="persistence";function NH(t,e){if(Uu(Object.values($n).includes(e),t,"invalid-persistence-type"),Rm()){Uu(e!==$n.SESSION,t,"unsupported-persistence-type");return}if(ME()){Uu(e===$n.NONE,t,"unsupported-persistence-type");return}if(AT()){Uu(e===$n.NONE||e===$n.LOCAL&&Gc(),t,"unsupported-persistence-type");return}Uu(e===$n.NONE||LO(),t,"unsupported-persistence-type")}async function Yv(t){await t._initializationPromise;const e=FO(),n=Do(VO,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function xH(t,e){const n=FO();if(!n)return[];const r=Do(VO,t,e);switch(n.getItem(r)){case $n.NONE:return[Ol];case $n.LOCAL:return[Rh,Zo];case $n.SESSION:return[Zo];default:return[]}}function FO(){var t;try{return((t=kH())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DH=O;class us{constructor(){this.browserResolver=qn(Q6),this.cordovaResolver=qn(vH),this.underlyingResolver=null,this._redirectPersistence=Zo,this._completeRedirectFn=_g,this._overrideRedirectResult=ST}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return MO()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return DH(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await bH();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UO(t){return t.unwrap()}function OH(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LH(t){return BO(t)}function MH(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new VH(t,v5(t,e))}else if(r){const i=BO(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function BO(t){const{_tokenResponse:e}=t instanceof _n?t.customData:t;if(!e)return null;if(!(t instanceof _n)&&"temporaryProof"in e&&"phoneNumber"in e)return ea.credentialFromResult(t);const n=e.providerId;if(!n||n===Fu.PASSWORD)return null;let r;switch(n){case Fu.GOOGLE:r=zr;break;case Fu.FACEBOOK:r=$r;break;case Fu.GITHUB:r=jr;break;case Fu.TWITTER:r=qr;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:l}=e;return!s&&!o&&!i&&!a?null:a?n.startsWith("saml.")?Ll._create(n,a):ri._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:i,accessToken:s}):new ul(n).credential({idToken:i,accessToken:s,rawNonce:l})}return t instanceof _n?r.credentialFromError(t):r.credentialFromResult(t)}function Rn(t,e){return e.catch(n=>{throw n instanceof _n&&MH(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:LH(n),additionalUserInfo:y5(n),user:_i.getOrCreate(i)}})}async function Jv(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>Rn(t,n.confirm(r))}}class VH{constructor(e,n){this.resolver=n,this.auth=OH(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Rn(UO(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this._delegate=e,this.multiFactor=T5(e)}static getOrCreate(e){return _i.USER_MAP.has(e)||_i.USER_MAP.set(e,new _i(e)),_i.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Rn(this.auth,pO(this._delegate,e))}async linkWithPhoneNumber(e,n){return Jv(this.auth,e6(this._delegate,e,n))}async linkWithPopup(e){return Rn(this.auth,u6(this._delegate,e,us))}async linkWithRedirect(e){return await Yv(ut(this.auth)),y6(this._delegate,e,us)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Rn(this.auth,mO(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return Jv(this.auth,t6(this._delegate,e,n))}reauthenticateWithPopup(e){return Rn(this.auth,l6(this._delegate,e,us))}async reauthenticateWithRedirect(e){return await Yv(ut(this.auth)),g6(this._delegate,e,us)}sendEmailVerification(e){return a5(this._delegate,e)}async unlink(e){return await G9(this._delegate,e),this}updateEmail(e){return h5(this._delegate,e)}updatePassword(e){return d5(this._delegate,e)}updatePhoneNumber(e){return n6(this._delegate,e)}updateProfile(e){return c5(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return l5(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}_i.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu=O;class Xv{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Bu(r,"invalid-api-key",{appName:e.name}),Bu(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?us:void 0;this._delegate=n.initialize({options:{persistence:FH(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(F3),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?_i.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){T9(this._delegate,e,n)}applyActionCode(e){return X9(this._delegate,e)}checkActionCode(e){return gO(this._delegate,e)}confirmPasswordReset(e,n){return J9(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return Rn(this._delegate,e5(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return o5(this._delegate,e)}isSignInWithEmailLink(e){return r5(this._delegate,e)}async getRedirectResult(){Bu(H_(),this._delegate,"operation-not-supported-in-this-environment");const e=await w6(this._delegate,us);return e?Rn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){wH(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:s,complete:o}=oC(e,n,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,n,r){const{next:i,error:s,complete:o}=oC(e,n,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,n){return n5(this._delegate,e,n)}sendPasswordResetEmail(e,n){return Y9(this._delegate,e,n||void 0)}async setPersistence(e){NH(this._delegate,e);let n;switch(e){case $n.SESSION:n=Zo;break;case $n.LOCAL:n=await qn(Rh)._isAvailable()?Rh:vT;break;case $n.NONE:n=Ol;break;default:return Zt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Rn(this._delegate,H9(this._delegate))}signInWithCredential(e){return Rn(this._delegate,dg(this._delegate,e))}signInWithCustomToken(e){return Rn(this._delegate,Q9(this._delegate,e))}signInWithEmailAndPassword(e,n){return Rn(this._delegate,t5(this._delegate,e,n))}signInWithEmailLink(e,n){return Rn(this._delegate,i5(this._delegate,e,n))}signInWithPhoneNumber(e,n){return Jv(this._delegate,Z5(this._delegate,e,n))}async signInWithPopup(e){return Bu(H_(),this._delegate,"operation-not-supported-in-this-environment"),Rn(this._delegate,a6(this._delegate,e,us))}async signInWithRedirect(e){return Bu(H_(),this._delegate,"operation-not-supported-in-this-environment"),await Yv(this._delegate),p6(this._delegate,e,us)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return Z9(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Xv.Persistence=$n;function oC(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:o=>i(o&&_i.getOrCreate(o)),error:e,complete:n}}function FH(t,e){const n=xH(t,e);if(typeof self<"u"&&!n.includes(Rh)&&n.push(Rh),typeof window<"u")for(const r of[vT,Zo])n.includes(r)||n.push(r);return n.includes(Ol)||n.push(Ol),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(){this.providerId="phone",this._delegate=new ea(UO(Ks.auth()))}static credential(e,n){return ea.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}CT.PHONE_SIGN_IN_METHOD=ea.PHONE_SIGN_IN_METHOD;CT.PROVIDER_ID=ea.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UH=O;class BH{constructor(e,n,r=Ks.app()){var i;UH((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new J5(r.auth(),e,n),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $H="auth-compat";function zH(t){t.INTERNAL.registerComponent(new Vn($H,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Xv(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ba.EMAIL_SIGNIN,PASSWORD_RESET:ba.PASSWORD_RESET,RECOVER_EMAIL:ba.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:ba.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:ba.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:ba.VERIFY_EMAIL}},EmailAuthProvider:to,FacebookAuthProvider:$r,GithubAuthProvider:jr,GoogleAuthProvider:zr,OAuthProvider:ul,SAMLAuthProvider:Fp,PhoneAuthProvider:CT,PhoneMultiFactorGenerator:DO,RecaptchaVerifier:BH,TwitterAuthProvider:qr,Auth:Xv,AuthCredential:au,Error:_n}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(EH,IH)}zH(Ks);var aC={};const lC="@firebase/database",uC="1.0.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $O="";function zO(t){$O=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jH{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Et(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Kc(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qH{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Gn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new jH(e)}}catch{}return new qH},Po=jO("localStorage"),Zv=jO("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hl=new Kl("@firebase/database"),qO=function(){let t=1;return function(){return t++}}(),WO=function(t){const e=s$(t),n=new n$;n.update(e);const r=n.digest();return DE.encodeByteArray(r)},wd=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=wd.apply(null,r):typeof r=="object"?e+=Et(r):e+=r,e+=" "}return e};let Lo=null,cC=!0;const HO=function(t,e){L(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(hl.logLevel=de.VERBOSE,Lo=hl.log.bind(hl),e&&Zv.set("logging_enabled",!0)):typeof t=="function"?Lo=t:(Lo=null,Zv.remove("logging_enabled"))},Dt=function(...t){if(cC===!0&&(cC=!1,Lo===null&&Zv.get("logging_enabled")===!0&&HO(!0)),Lo){const e=wd.apply(null,t);Lo(e)}},Ed=function(t){return function(...e){Dt(t,...e)}},ew=function(...t){const e="FIREBASE INTERNAL ERROR: "+wd(...t);hl.error(e)},ii=function(...t){const e=`FIREBASE FATAL ERROR: ${wd(...t)}`;throw hl.error(e),new Error(e)},ln=function(...t){const e="FIREBASE WARNING: "+wd(...t);hl.warn(e)},WH=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ln("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},yg=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},HH=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Bs="[MIN_NAME]",xi="[MAX_NAME]",_a=function(t,e){if(t===e)return 0;if(t===Bs||e===xi)return-1;if(e===Bs||t===xi)return 1;{const n=hC(t),r=hC(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},GH=function(t,e){return t===e?0:t<e?-1:1},$u=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Et(e))},PT=function(t){if(typeof t!="object"||t===null)return Et(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Et(e[r]),n+=":",n+=PT(t[e[r]]);return n+="}",n},GO=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Vt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const KO=function(t){L(!yg(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,s,o,a,l;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(l=n;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const c=u.join("");let h="";for(l=0;l<64;l+=8){let d=parseInt(c.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},KH=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},QH=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function YH(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const JH=new RegExp("^-?(0*)\\d{1,10}$"),XH=-2147483648,ZH=2147483647,hC=function(t){if(JH.test(t)){const e=Number(t);if(e>=XH&&e<=ZH)return e}return null},uu=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw ln("Exception was thrown by user callback.",n),e},Math.floor(0))}},eG=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ic=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tG{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ln(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nG{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Dt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ln(e)}}class dl{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}dl.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="5",QO="v",YO="s",JO="r",XO="f",ZO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,eL="ls",tL="p",tw="ac",nL="websocket",rL="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e,n,r,i,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Po.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Po.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function rG(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function sL(t,e,n){L(typeof e=="string","typeof type must == string"),L(typeof n=="object","typeof params must == object");let r;if(e===nL)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===rL)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);rG(t)&&(n.ns=t.namespace);const i=[];return Vt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iG{constructor(){this.counters_={}}incrementCounter(e,n=1){Gn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return $2(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_={},K_={};function kT(t){const e=t.toString();return G_[e]||(G_[e]=new iG),G_[e]}function sG(t,e){const n=t.toString();return K_[n]||(K_[n]=e()),K_[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oG{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&uu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC="start",aG="close",lG="pLPCommand",uG="pRTLPCB",oL="id",aL="pw",lL="ser",cG="cb",hG="seg",dG="ts",fG="d",pG="dframe",uL=1870,cL=30,mG=uL-cL,gG=25e3,_G=3e4;class cs{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ed(e),this.stats_=kT(n),this.urlFn=l=>(this.appCheckToken&&(l[tw]=this.appCheckToken),sL(n,rL,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new oG(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(_G)),HH(()=>{if(this.isClosed_)return;this.scriptTagHolder=new NT((...s)=>{const[o,a,l,u,c]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===dC)this.id=a,this.password=l;else if(o===aG)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[dC]="t",r[lL]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[cG]=this.scriptTagHolder.uniqueCallbackIdentifier),r[QO]=bT,this.transportSessionId&&(r[YO]=this.transportSessionId),this.lastSessionId&&(r[eL]=this.lastSessionId),this.applicationId&&(r[tL]=this.applicationId),this.appCheckToken&&(r[tw]=this.appCheckToken),typeof location<"u"&&location.hostname&&ZO.test(location.hostname)&&(r[JO]=XO);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){cs.forceAllow_=!0}static forceDisallow(){cs.forceDisallow_=!0}static isAvailable(){return cs.forceAllow_?!0:!cs.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!KH()&&!QH()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Et(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=t1(n),i=GO(r,mG);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[pG]="t",r[oL]=e,r[aL]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Et(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class NT{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=qO(),window[lG+this.uniqueCallbackIdentifier]=e,window[uG+this.uniqueCallbackIdentifier]=n,this.myIFrame=NT.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Dt("frame writing exception"),a.stack&&Dt(a.stack),Dt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Dt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[oL]=this.myID,e[aL]=this.myPW,e[lL]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+cL+r.length<=uL;){const o=this.pendingSegs.shift();r=r+"&"+hG+i+"="+o.seg+"&"+dG+i+"="+o.ts+"&"+fG+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(gG)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Dt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yG=16384,vG=45e3;let zp=null;typeof MozWebSocket<"u"?zp=MozWebSocket:typeof WebSocket<"u"&&(zp=WebSocket);class ir{constructor(e,n,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ed(this.connId),this.stats_=kT(n),this.connURL=ir.connectionURL_(n,o,a,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,s){const o={};return o[QO]=bT,typeof location<"u"&&location.hostname&&ZO.test(location.hostname)&&(o[JO]=XO),n&&(o[YO]=n),r&&(o[eL]=r),i&&(o[tw]=i),s&&(o[tL]=s),sL(e,nL,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Po.set("previous_websocket_failure",!0);try{let r;o1(),this.mySock=new zp(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){ir.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&zp!==null&&!ir.forceDisallow_}static previouslyFailed(){return Po.isInMemoryStorage||Po.get("previous_websocket_failure")===!0}markConnectionHealthy(){Po.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Kc(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(L(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=Et(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=GO(n,yG);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(vG))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ir.responsesRequiredToBeHealthy=2;ir.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[cs,ir]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=ir&&ir.isAvailable();let r=n&&!ir.previouslyFailed();if(e.webSocketOnly&&(n||ln("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ir];else{const i=this.transports_=[];for(const s of Ml.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Ml.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ml.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wG=6e4,EG=5e3,IG=10*1024,TG=100*1024,Q_="t",fC="d",SG="s",pC="r",RG="e",mC="o",gC="a",_C="n",yC="p",AG="h";class CG{constructor(e,n,r,i,s,o,a,l,u,c){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ed("c:"+this.id+":"),this.transportManager_=new Ml(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ic(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>TG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>IG?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Q_ in e){const n=e[Q_];n===gC?this.upgradeIfSecondaryHealthy_():n===pC?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===mC&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=$u("t",e),r=$u("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:yC,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:gC,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:_C,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=$u("t",e),r=$u("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=$u(Q_,e);if(fC in e){const r=e[fC];if(n===AG){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===_C){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===SG?this.onConnectionShutdown_(r):n===pC?this.onReset_(r):n===RG?ew("Server Error: "+r):n===mC?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ew("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),bT!==r&&ln("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Ic(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(wG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ic(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(EG))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:yC,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Po.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.allowedEvents_=e,this.listeners_={},L(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){L(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp extends dL{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!LE()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new jp}getInitialEvent(e){return L(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC=32,wC=768;class Ae{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Te(){return new Ae("")}function ue(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function $s(t){return t.pieces_.length-t.pieceNum_}function De(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ae(t.pieces_,e)}function xT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function PG(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ah(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function fL(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ae(e,0)}function Ke(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ae)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Ae(n,0)}function ce(t){return t.pieceNum_>=t.pieces_.length}function mn(t,e){const n=ue(t),r=ue(e);if(n===null)return e;if(n===r)return mn(De(t),De(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function bG(t,e){const n=Ah(t,0),r=Ah(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=_a(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function DT(t,e){if($s(t)!==$s(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function ar(t,e){let n=t.pieceNum_,r=e.pieceNum_;if($s(t)>$s(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class kG{constructor(e,n){this.errorPrefix_=n,this.parts_=Ah(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Am(this.parts_[r]);pL(this)}}function NG(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Am(e),pL(t)}function xG(t){const e=t.parts_.pop();t.byteLength_-=Am(e),t.parts_.length>0&&(t.byteLength_-=1)}function pL(t){if(t.byteLength_>wC)throw new Error(t.errorPrefix_+"has a key path longer than "+wC+" bytes ("+t.byteLength_+").");if(t.parts_.length>vC)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+vC+") or object contains a cycle "+co(t))}function co(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT extends dL{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new OT}getInitialEvent(e){return L(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zu=1e3,DG=60*5*1e3,EC=30*1e3,OG=1.3,LG=3e4,MG="server_kill",IC=3;class Ti extends hL{constructor(e,n,r,i,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Ti.nextPersistentConnectionId_++,this.log_=Ed("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=zu,this.maxReconnectDelay_=DG,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!o1())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");OT.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&jp.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,s={r:i,a:e,b:n};this.log_(Et(s)),L(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new Cn,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),L(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),L(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,u=a.s;Ti.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Gn(e,"w")){const r=zo(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();ln(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||t$(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=EC)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=e$(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),L(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Et(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):ew("Unrecognized action received from server: "+Et(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){L(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=zu,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=zu,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>LG&&(this.reconnectDelay_=zu),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*OG)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Ti.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},u=function(h){L(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:u};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);o?Dt("getToken() completed but was canceled"):(Dt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new CG(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,f=>{ln(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(MG)},s))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&ln(h),l())}}}interrupt(e){Dt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Dt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],mp(this.interruptReasons_)&&(this.reconnectDelay_=zu,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(s=>PT(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new Ae(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){Dt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=IC&&(this.reconnectDelay_=EC,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Dt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=IC&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+$O.replace(/\./g,"-")]=1,LE()?e["framework.cordova"]=1:Rm()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=jp.getInstance().currentlyOnline();return mp(this.interruptReasons_)&&e}}Ti.nextPersistentConnectionId_=0;Ti.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new fe(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new fe(Bs,e),i=new fe(Bs,n);return this.compare(r,i)!==0}minPost(){return fe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uf;class mL extends vg{static get __EMPTY_NODE(){return uf}static set __EMPTY_NODE(e){uf=e}compare(e,n){return _a(e.name,n.name)}isDefinedOn(e){throw Gl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return fe.MIN}maxPost(){return new fe(xi,uf)}makePost(e,n){return L(typeof e=="string","KeyIndex indexValue must always be a string."),new fe(e,uf)}toString(){return".key"}}const ei=new mL;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class xt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??xt.RED,this.left=i??xn.EMPTY_NODE,this.right=s??xn.EMPTY_NODE}copy(e,n,r,i,s){return new xt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return xn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return xn.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}xt.RED=!0;xt.BLACK=!1;class VG{copy(e,n,r,i,s){return this}insert(e,n,r){return new xt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class xn{constructor(e,n=xn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new xn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,xt.BLACK,null,null))}remove(e){return new xn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,xt.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new cf(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new cf(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new cf(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new cf(this.root_,null,this.comparator_,!0,e)}}xn.EMPTY_NODE=new VG;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FG(t,e){return _a(t.name,e.name)}function LT(t,e){return _a(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nw;function UG(t){nw=t}const gL=function(t){return typeof t=="number"?"number:"+KO(t):"string:"+t},_L=function(t){if(t.isLeafNode()){const e=t.val();L(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Gn(e,".sv"),"Priority must be a string or number.")}else L(t===nw||t.isEmpty(),"priority of unexpected type.");L(t===nw||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TC;class Ct{constructor(e,n=Ct.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,L(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),_L(this.priorityNode_)}static set __childrenNodeConstructor(e){TC=e}static get __childrenNodeConstructor(){return TC}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ct(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Ct.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ce(e)?this:ue(e)===".priority"?this.priorityNode_:Ct.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Ct.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=ue(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(L(r!==".priority"||$s(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Ct.__childrenNodeConstructor.EMPTY_NODE.updateChild(De(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+gL(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=KO(this.value_):e+=this.value_,this.lazyHash_=WO(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ct.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ct.__childrenNodeConstructor?-1:(L(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=Ct.VALUE_TYPE_ORDER.indexOf(n),s=Ct.VALUE_TYPE_ORDER.indexOf(r);return L(i>=0,"Unknown leaf type: "+n),L(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Ct.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yL,vL;function BG(t){yL=t}function $G(t){vL=t}class zG extends vg{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?_a(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return fe.MIN}maxPost(){return new fe(xi,new Ct("[PRIORITY-POST]",vL))}makePost(e,n){const r=yL(e);return new fe(n,new Ct("[PRIORITY-POST]",r))}toString(){return".priority"}}const Fe=new zG;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jG=Math.log(2);class qG{constructor(e){const n=s=>parseInt(Math.log(s)/jG,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const qp=function(t,e,n,r){t.sort(e);const i=function(l,u){const c=u-l;let h,d;if(c===0)return null;if(c===1)return h=t[l],d=n?n(h):h,new xt(d,h.node,xt.BLACK,null,null);{const f=parseInt(c/2,10)+l,p=i(l,f),m=i(f+1,u);return h=t[f],d=n?n(h):h,new xt(d,h.node,xt.BLACK,p,m)}},s=function(l){let u=null,c=null,h=t.length;const d=function(p,m){const v=h-p,g=h;h-=p;const _=i(v+1,g),y=t[v],T=n?n(y):y;f(new xt(T,y.node,m,null,_))},f=function(p){u?(u.left=p,u=p):(c=p,u=p)};for(let p=0;p<l.count;++p){const m=l.nextBitIsOne(),v=Math.pow(2,l.count-(p+1));m?d(v,xt.BLACK):(d(v,xt.BLACK),d(v,xt.RED))}return c},o=new qG(t.length),a=s(o);return new xn(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Y_;const ka={};class yi{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return L(ka&&Fe,"ChildrenNode.ts has not been loaded"),Y_=Y_||new yi({".priority":ka},{".priority":Fe}),Y_}get(e){const n=zo(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof xn?n:null}hasIndex(e){return Gn(this.indexSet_,e.toString())}addIndex(e,n){L(e!==ei,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(fe.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=qp(r,e.getCompare()):a=ka;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const c=Object.assign({},this.indexes_);return c[l]=a,new yi(c,u)}addToIndexes(e,n){const r=gp(this.indexes_,(i,s)=>{const o=zo(this.indexSet_,s);if(L(o,"Missing index implementation for "+s),i===ka)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(fe.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),qp(a,o.getCompare())}else return ka;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new fe(e.name,a))),l.insert(e,e.node)}});return new yi(r,this.indexSet_)}removeFromIndexes(e,n){const r=gp(this.indexes_,i=>{if(i===ka)return i;{const s=n.get(e.name);return s?i.remove(new fe(e.name,s)):i}});return new yi(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ju;class X{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&_L(this.priorityNode_),this.children_.isEmpty()&&L(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ju||(ju=new X(new xn(LT),null,yi.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ju}updatePriority(e){return this.children_.isEmpty()?this:new X(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?ju:n}}getChild(e){const n=ue(e);return n===null?this:this.getImmediateChild(n).getChild(De(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(L(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new fe(e,n);let i,s;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?ju:this.priorityNode_;return new X(i,o,s)}}updateChild(e,n){const r=ue(e);if(r===null)return n;{L(ue(e)!==".priority"||$s(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(De(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(Fe,(o,a)=>{n[o]=a.val(e),r++,s&&X.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+gL(this.getPriority().val())+":"),this.forEachChild(Fe,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":WO(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new fe(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new fe(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new fe(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,fe.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,fe.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Id?-1:0}withIndex(e){if(e===ei||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new X(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===ei||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Fe),i=n.getIterator(Fe);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===ei?null:this.indexMap_.get(e.toString())}}X.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class WG extends X{constructor(){super(new xn(LT),X.EMPTY_NODE,yi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return X.EMPTY_NODE}isEmpty(){return!1}}const Id=new WG;Object.defineProperties(fe,{MIN:{value:new fe(Bs,X.EMPTY_NODE)},MAX:{value:new fe(xi,Id)}});mL.__EMPTY_NODE=X.EMPTY_NODE;Ct.__childrenNodeConstructor=X;UG(Id);$G(Id);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HG=!0;function Je(t,e=null){if(t===null)return X.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),L(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Ct(n,Je(e))}if(!(t instanceof Array)&&HG){const n=[];let r=!1;if(Vt(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=Je(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new fe(o,l)))}}),n.length===0)return X.EMPTY_NODE;const s=qp(n,FG,o=>o.name,LT);if(r){const o=qp(n,Fe.getCompare());return new X(s,Je(e),new yi({".priority":o},{".priority":Fe}))}else return new X(s,Je(e),yi.Default)}else{let n=X.EMPTY_NODE;return Vt(t,(r,i)=>{if(Gn(t,r)&&r.substring(0,1)!=="."){const s=Je(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Je(e))}}BG(Je);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT extends vg{constructor(e){super(),this.indexPath_=e,L(!ce(e)&&ue(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?_a(e.name,n.name):s}makePost(e,n){const r=Je(e),i=X.EMPTY_NODE.updateChild(this.indexPath_,r);return new fe(n,i)}maxPost(){const e=X.EMPTY_NODE.updateChild(this.indexPath_,Id);return new fe(xi,e)}toString(){return Ah(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GG extends vg{compare(e,n){const r=e.node.compareTo(n.node);return r===0?_a(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return fe.MIN}maxPost(){return fe.MAX}makePost(e,n){const r=Je(e);return new fe(n,r)}toString(){return".value"}}const VT=new GG;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wL(t){return{type:"value",snapshotNode:t}}function Vl(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ch(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ph(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function KG(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){L(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Ch(n,a)):L(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Vl(n,r)):o.trackChildChange(Ph(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Fe,(i,s)=>{n.hasChild(i)||r.trackChildChange(Ch(i,s))}),n.isLeafNode()||n.forEachChild(Fe,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Ph(i,s,o))}else r.trackChildChange(Vl(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?X.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e){this.indexedFilter_=new FT(e.getIndex()),this.index_=e.getIndex(),this.startPost_=bh.getStartPost_(e),this.endPost_=bh.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new fe(n,r))||(r=X.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=X.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(X.EMPTY_NODE);const s=this;return n.forEachChild(Fe,(o,a)=>{s.matches(new fe(o,a))||(i=i.updateImmediateChild(o,X.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QG{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new bh(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new fe(n,r))||(r=X.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=X.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=X.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(X.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,X.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;L(a.numChildren()===this.limit_,"");const l=new fe(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),c=this.rangedFilter_.matches(l);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,u,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,l);if(c&&!r.isEmpty()&&f>=0)return s!=null&&s.trackChildChange(Ph(n,r,h)),a.updateImmediateChild(n,r);{s!=null&&s.trackChildChange(Ch(n,h));const m=a.updateImmediateChild(n,X.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s!=null&&s.trackChildChange(Vl(d.name,d.node)),m.updateImmediateChild(d.name,d.node)):m}}else return r.isEmpty()?e:c&&o(u,l)>=0?(s!=null&&(s.trackChildChange(Ch(u.name,u.node)),s.trackChildChange(Vl(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,X.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Fe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return L(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return L(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Bs}hasEnd(){return this.endSet_}getIndexEndValue(){return L(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return L(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return L(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Fe}copy(){const e=new wg;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function YG(t){return t.loadsAllData()?new FT(t.getIndex()):t.hasLimit()?new QG(t):new bh(t)}function JG(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function XG(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function rw(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function ZG(t,e,n){let r;return t.index_===ei||n?r=rw(t,e,n):r=rw(t,e,xi),r.startAfterSet_=!0,r}function iw(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function eK(t,e,n){let r;return t.index_===ei||n?r=iw(t,e,n):r=iw(t,e,Bs),r.endBeforeSet_=!0,r}function Eg(t,e){const n=t.copy();return n.index_=e,n}function SC(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Fe?n="$priority":t.index_===VT?n="$value":t.index_===ei?n="$key":(L(t.index_ instanceof MT,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Et(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=Et(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Et(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Et(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Et(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function RC(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Fe&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp extends hL{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Ed("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(L(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=Wp.getListenId_(e,r),a={};this.listens_[o]=a;const l=SC(e._queryParams);this.restRequest_(s+".json",l,(u,c)=>{let h=c;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(s,h,!1,r),zo(this.listens_,o)===a){let d;u?u===401?d="permission_denied":d="rest_error:"+u:d="ok",i(d,null)}})}unlisten(e,n){const r=Wp.getListenId_(e,n);delete this.listens_[r]}get(e){const n=SC(e._queryParams),r=e._path.toString(),i=new Cn;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ua(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Kc(a.responseText)}catch{ln("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&ln("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tK{constructor(){this.rootNode_=X.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(){return{value:null,children:new Map}}function cu(t,e,n){if(ce(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=ue(e);t.children.has(r)||t.children.set(r,Hp());const i=t.children.get(r);e=De(e),cu(i,e,n)}}function sw(t,e){if(ce(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Fe,(r,i)=>{cu(t,new Ae(r),i)}),sw(t,e)}}else if(t.children.size>0){const n=ue(e);return e=De(e),t.children.has(n)&&sw(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function ow(t,e,n){t.value!==null?n(e,t.value):nK(t,(r,i)=>{const s=new Ae(e.toString()+"/"+r);ow(i,s,n)})}function nK(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rK{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Vt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC=10*1e3,iK=30*1e3,sK=5*60*1e3;class oK{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new rK(e);const r=AC+(iK-AC)*Math.random();Ic(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Vt(e,(i,s)=>{s>0&&Gn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Ic(this.reportStats_.bind(this),Math.floor(Math.random()*2*sK))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rr;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Rr||(Rr={}));function UT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function BT(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function $T(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Rr.ACK_USER_WRITE,this.source=UT()}operationForChild(e){if(ce(this.path)){if(this.affectedTree.value!=null)return L(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ae(e));return new Gp(Te(),n,this.revert)}}else return L(ue(this.path)===e,"operationForChild called for unrelated child."),new Gp(De(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n){this.source=e,this.path=n,this.type=Rr.LISTEN_COMPLETE}operationForChild(e){return ce(this.path)?new kh(this.source,Te()):new kh(this.source,De(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Rr.OVERWRITE}operationForChild(e){return ce(this.path)?new na(this.source,Te(),this.snap.getImmediateChild(e)):new na(this.source,De(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Rr.MERGE}operationForChild(e){if(ce(this.path)){const n=this.children.subtree(new Ae(e));return n.isEmpty()?null:n.value?new na(this.source,Te(),n.value):new Fl(this.source,Te(),n)}else return L(ue(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Fl(this.source,De(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ce(e))return this.isFullyInitialized()&&!this.filtered_;const n=ue(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aK{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function lK(t,e,n,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(KG(o.childName,o.snapshotNode))}),qu(t,i,"child_removed",e,r,n),qu(t,i,"child_added",e,r,n),qu(t,i,"child_moved",s,r,n),qu(t,i,"child_changed",e,r,n),qu(t,i,"value",e,r,n),i}function qu(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,l)=>cK(t,a,l)),o.forEach(a=>{const l=uK(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function uK(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function cK(t,e,n){if(e.childName==null||n.childName==null)throw Gl("Should only compare child_ events.");const r=new fe(e.childName,e.snapshotNode),i=new fe(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(t,e){return{eventCache:t,serverCache:e}}function Tc(t,e,n,r){return Ig(new zs(e,n,r),t.serverCache)}function EL(t,e,n,r){return Ig(t.eventCache,new zs(e,n,r))}function Kp(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ra(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let J_;const hK=()=>(J_||(J_=new xn(GH)),J_);class Me{constructor(e,n=hK()){this.value=e,this.children=n}static fromObject(e){let n=new Me(null);return Vt(e,(r,i)=>{n=n.set(new Ae(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Te(),value:this.value};if(ce(e))return null;{const r=ue(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(De(e),n);return s!=null?{path:Ke(new Ae(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ce(e))return this;{const n=ue(e),r=this.children.get(n);return r!==null?r.subtree(De(e)):new Me(null)}}set(e,n){if(ce(e))return new Me(n,this.children);{const r=ue(e),s=(this.children.get(r)||new Me(null)).set(De(e),n),o=this.children.insert(r,s);return new Me(this.value,o)}}remove(e){if(ce(e))return this.children.isEmpty()?new Me(null):new Me(null,this.children);{const n=ue(e),r=this.children.get(n);if(r){const i=r.remove(De(e));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new Me(null):new Me(this.value,s)}else return this}}get(e){if(ce(e))return this.value;{const n=ue(e),r=this.children.get(n);return r?r.get(De(e)):null}}setTree(e,n){if(ce(e))return n;{const r=ue(e),s=(this.children.get(r)||new Me(null)).setTree(De(e),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Me(this.value,o)}}fold(e){return this.fold_(Te(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ke(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Te(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(ce(e))return null;{const s=ue(e),o=this.children.get(s);return o?o.findOnPath_(De(e),Ke(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Te(),n)}foreachOnPath_(e,n,r){if(ce(e))return this;{this.value&&r(n,this.value);const i=ue(e),s=this.children.get(i);return s?s.foreachOnPath_(De(e),Ke(n,i),r):new Me(null)}}foreach(e){this.foreach_(Te(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Ke(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.writeTree_=e}static empty(){return new Pr(new Me(null))}}function Sc(t,e,n){if(ce(e))return new Pr(new Me(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=mn(i,e);return s=s.updateChild(o,n),new Pr(t.writeTree_.set(i,s))}else{const i=new Me(n),s=t.writeTree_.setTree(e,i);return new Pr(s)}}}function aw(t,e,n){let r=t;return Vt(n,(i,s)=>{r=Sc(r,Ke(e,i),s)}),r}function CC(t,e){if(ce(e))return Pr.empty();{const n=t.writeTree_.setTree(e,new Me(null));return new Pr(n)}}function lw(t,e){return ya(t,e)!=null}function ya(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(mn(n.path,e)):null}function PC(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Fe,(r,i)=>{e.push(new fe(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new fe(r,i.value))}),e}function Ss(t,e){if(ce(e))return t;{const n=ya(t,e);return n!=null?new Pr(new Me(n)):new Pr(t.writeTree_.subtree(e))}}function uw(t){return t.writeTree_.isEmpty()}function Ul(t,e){return IL(Te(),t.writeTree_,e)}function IL(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(L(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=IL(Ke(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ke(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t,e){return AL(e,t)}function dK(t,e,n,r,i){L(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Sc(t.visibleWrites,e,n)),t.lastWriteId=r}function fK(t,e,n,r){L(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=aw(t.visibleWrites,e,n),t.lastWriteId=r}function pK(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function mK(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);L(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&gK(a,r.path)?i=!1:ar(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return _K(t),!0;if(r.snap)t.visibleWrites=CC(t.visibleWrites,r.path);else{const a=r.children;Vt(a,l=>{t.visibleWrites=CC(t.visibleWrites,Ke(r.path,l))})}return!0}else return!1}function gK(t,e){if(t.snap)return ar(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ar(Ke(t.path,n),e))return!0;return!1}function _K(t){t.visibleWrites=TL(t.allWrites,yK,Te()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function yK(t){return t.visible}function TL(t,e,n){let r=Pr.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)ar(n,o)?(a=mn(n,o),r=Sc(r,a,s.snap)):ar(o,n)&&(a=mn(o,n),r=Sc(r,Te(),s.snap.getChild(a)));else if(s.children){if(ar(n,o))a=mn(n,o),r=aw(r,a,s.children);else if(ar(o,n))if(a=mn(o,n),ce(a))r=aw(r,Te(),s.children);else{const l=zo(s.children,ue(a));if(l){const u=l.getChild(De(a));r=Sc(r,Te(),u)}}}else throw Gl("WriteRecord should have .snap or .children")}}return r}function SL(t,e,n,r,i){if(!r&&!i){const s=ya(t.visibleWrites,e);if(s!=null)return s;{const o=Ss(t.visibleWrites,e);if(uw(o))return n;if(n==null&&!lw(o,Te()))return null;{const a=n||X.EMPTY_NODE;return Ul(o,a)}}}else{const s=Ss(t.visibleWrites,e);if(!i&&uw(s))return n;if(!i&&n==null&&!lw(s,Te()))return null;{const o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(ar(u.path,e)||ar(e,u.path))},a=TL(t.allWrites,o,e),l=n||X.EMPTY_NODE;return Ul(a,l)}}}function vK(t,e,n){let r=X.EMPTY_NODE;const i=ya(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Fe,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=Ss(t.visibleWrites,e);return n.forEachChild(Fe,(o,a)=>{const l=Ul(Ss(s,new Ae(o)),a);r=r.updateImmediateChild(o,l)}),PC(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Ss(t.visibleWrites,e);return PC(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function wK(t,e,n,r,i){L(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Ke(e,n);if(lw(t.visibleWrites,s))return null;{const o=Ss(t.visibleWrites,s);return uw(o)?i.getChild(n):Ul(o,i.getChild(n))}}function EK(t,e,n,r){const i=Ke(e,n),s=ya(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=Ss(t.visibleWrites,i);return Ul(o,r.getNode().getImmediateChild(n))}else return null}function IK(t,e){return ya(t.visibleWrites,e)}function TK(t,e,n,r,i,s,o){let a;const l=Ss(t.visibleWrites,e),u=ya(l,Te());if(u!=null)a=u;else if(n!=null)a=Ul(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const c=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let f=d.getNext();for(;f&&c.length<i;)h(f,r)!==0&&c.push(f),f=d.getNext();return c}else return[]}function SK(){return{visibleWrites:Pr.empty(),allWrites:[],lastWriteId:-1}}function Qp(t,e,n,r){return SL(t.writeTree,t.treePath,e,n,r)}function zT(t,e){return vK(t.writeTree,t.treePath,e)}function bC(t,e,n,r){return wK(t.writeTree,t.treePath,e,n,r)}function Yp(t,e){return IK(t.writeTree,Ke(t.treePath,e))}function RK(t,e,n,r,i,s){return TK(t.writeTree,t.treePath,e,n,r,i,s)}function jT(t,e,n){return EK(t.writeTree,t.treePath,e,n)}function RL(t,e){return AL(Ke(t.treePath,e),t.writeTree)}function AL(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AK{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;L(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),L(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Ph(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Ch(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Vl(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Ph(r,e.snapshotNode,i.oldSnap));else throw Gl("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CK{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const CL=new CK;class qT{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new zs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return jT(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ra(this.viewCache_),s=RK(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PK(t){return{filter:t}}function bK(t,e){L(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),L(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function kK(t,e,n,r,i){const s=new AK;let o,a;if(n.type===Rr.OVERWRITE){const u=n;u.source.fromUser?o=cw(t,e,u.path,u.snap,r,i,s):(L(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ce(u.path),o=Jp(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Rr.MERGE){const u=n;u.source.fromUser?o=xK(t,e,u.path,u.children,r,i,s):(L(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=hw(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Rr.ACK_USER_WRITE){const u=n;u.revert?o=LK(t,e,u.path,r,i,s):o=DK(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Rr.LISTEN_COMPLETE)o=OK(t,e,n.path,r,s);else throw Gl("Unknown operation type: "+n.type);const l=s.getChanges();return NK(e,o,l),{viewCache:o,changes:l}}function NK(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Kp(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(wL(Kp(e)))}}function PL(t,e,n,r,i,s){const o=e.eventCache;if(Yp(r,n)!=null)return e;{let a,l;if(ce(n))if(L(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=ra(e),c=u instanceof X?u:X.EMPTY_NODE,h=zT(r,c);a=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const u=Qp(r,ra(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=ue(n);if(u===".priority"){L($s(n)===1,"Can't have a priority with additional path components");const c=o.getNode();l=e.serverCache.getNode();const h=bC(r,n,c,l);h!=null?a=t.filter.updatePriority(c,h):a=o.getNode()}else{const c=De(n);let h;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const d=bC(r,n,o.getNode(),l);d!=null?h=o.getNode().getImmediateChild(u).updateChild(c,d):h=o.getNode().getImmediateChild(u)}else h=jT(r,u,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),u,h,c,i,s):a=o.getNode()}}return Tc(e,a,o.isFullyInitialized()||ce(n),t.filter.filtersNodes())}}function Jp(t,e,n,r,i,s,o,a){const l=e.serverCache;let u;const c=o?t.filter:t.filter.getIndexedFilter();if(ce(n))u=c.updateFullNode(l.getNode(),r,null);else if(c.filtersNodes()&&!l.isFiltered()){const f=l.getNode().updateChild(n,r);u=c.updateFullNode(l.getNode(),f,null)}else{const f=ue(n);if(!l.isCompleteForPath(n)&&$s(n)>1)return e;const p=De(n),v=l.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?u=c.updatePriority(l.getNode(),v):u=c.updateChild(l.getNode(),f,v,p,CL,null)}const h=EL(e,u,l.isFullyInitialized()||ce(n),c.filtersNodes()),d=new qT(i,h,s);return PL(t,h,n,i,d,a)}function cw(t,e,n,r,i,s,o){const a=e.eventCache;let l,u;const c=new qT(i,e,s);if(ce(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Tc(e,u,!0,t.filter.filtersNodes());else{const h=ue(n);if(h===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),l=Tc(e,u,a.isFullyInitialized(),a.isFiltered());else{const d=De(n),f=a.getNode().getImmediateChild(h);let p;if(ce(d))p=r;else{const m=c.getCompleteChild(h);m!=null?xT(d)===".priority"&&m.getChild(fL(d)).isEmpty()?p=m:p=m.updateChild(d,r):p=X.EMPTY_NODE}if(f.equals(p))l=e;else{const m=t.filter.updateChild(a.getNode(),h,p,d,c,o);l=Tc(e,m,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function kC(t,e){return t.eventCache.isCompleteForChild(e)}function xK(t,e,n,r,i,s,o){let a=e;return r.foreach((l,u)=>{const c=Ke(n,l);kC(e,ue(c))&&(a=cw(t,a,c,u,i,s,o))}),r.foreach((l,u)=>{const c=Ke(n,l);kC(e,ue(c))||(a=cw(t,a,c,u,i,s,o))}),a}function NC(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function hw(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;ce(n)?u=r:u=new Me(null).setTree(n,r);const c=e.serverCache.getNode();return u.children.inorderTraversal((h,d)=>{if(c.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=NC(t,f,d);l=Jp(t,l,new Ae(h),p,i,s,o,a)}}),u.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!c.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),m=NC(t,p,d);l=Jp(t,l,new Ae(h),m,i,s,o,a)}}),l}function DK(t,e,n,r,i,s,o){if(Yp(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ce(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Jp(t,e,n,l.getNode().getChild(n),i,s,a,o);if(ce(n)){let u=new Me(null);return l.getNode().forEachChild(ei,(c,h)=>{u=u.set(new Ae(c),h)}),hw(t,e,n,u,i,s,a,o)}else return e}else{let u=new Me(null);return r.foreach((c,h)=>{const d=Ke(n,c);l.isCompleteForPath(d)&&(u=u.set(c,l.getNode().getChild(d)))}),hw(t,e,n,u,i,s,a,o)}}function OK(t,e,n,r,i){const s=e.serverCache,o=EL(e,s.getNode(),s.isFullyInitialized()||ce(n),s.isFiltered());return PL(t,o,n,r,CL,i)}function LK(t,e,n,r,i,s){let o;if(Yp(r,n)!=null)return e;{const a=new qT(r,e,i),l=e.eventCache.getNode();let u;if(ce(n)||ue(n)===".priority"){let c;if(e.serverCache.isFullyInitialized())c=Qp(r,ra(e));else{const h=e.serverCache.getNode();L(h instanceof X,"serverChildren would be complete if leaf node"),c=zT(r,h)}c=c,u=t.filter.updateFullNode(l,c,s)}else{const c=ue(n);let h=jT(r,c,e.serverCache);h==null&&e.serverCache.isCompleteForChild(c)&&(h=l.getImmediateChild(c)),h!=null?u=t.filter.updateChild(l,c,h,De(n),a,s):e.eventCache.getNode().hasChild(c)?u=t.filter.updateChild(l,c,X.EMPTY_NODE,De(n),a,s):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Qp(r,ra(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||Yp(r,Te())!=null,Tc(e,u,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MK{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new FT(r.getIndex()),s=YG(r);this.processor_=PK(s);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(X.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(X.EMPTY_NODE,a.getNode(),null),c=new zs(l,o.isFullyInitialized(),i.filtersNodes()),h=new zs(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Ig(h,c),this.eventGenerator_=new aK(this.query_)}get query(){return this.query_}}function VK(t){return t.viewCache_.serverCache.getNode()}function FK(t){return Kp(t.viewCache_)}function UK(t,e){const n=ra(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ce(e)&&!n.getImmediateChild(ue(e)).isEmpty())?n.getChild(e):null}function xC(t){return t.eventRegistrations_.length===0}function BK(t,e){t.eventRegistrations_.push(e)}function DC(t,e,n){const r=[];if(n){L(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function OC(t,e,n,r){e.type===Rr.MERGE&&e.source.queryId!==null&&(L(ra(t.viewCache_),"We should always have a full cache before handling merges"),L(Kp(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=kK(t.processor_,i,e,n,r);return bK(t.processor_,s.viewCache),L(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,bL(t,s.changes,s.viewCache.eventCache.getNode(),null)}function $K(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Fe,(s,o)=>{r.push(Vl(s,o))}),n.isFullyInitialized()&&r.push(wL(n.getNode())),bL(t,r,n.getNode(),e)}function bL(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return lK(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xp;class kL{constructor(){this.views=new Map}}function zK(t){L(!Xp,"__referenceConstructor has already been defined"),Xp=t}function jK(){return L(Xp,"Reference.ts has not been loaded"),Xp}function qK(t){return t.views.size===0}function WT(t,e,n,r){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return L(s!=null,"SyncTree gave us an op for an invalid query."),OC(s,e,n,r)}else{let s=[];for(const o of t.views.values())s=s.concat(OC(o,e,n,r));return s}}function NL(t,e,n,r,i){const s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Qp(n,i?r:null),l=!1;a?l=!0:r instanceof X?(a=zT(n,r),l=!1):(a=X.EMPTY_NODE,l=!1);const u=Ig(new zs(a,l,!1),new zs(r,i,!1));return new MK(e,u)}return o}function WK(t,e,n,r,i,s){const o=NL(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),BK(o,n),$K(o,n)}function HK(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=js(t);if(i==="default")for(const[l,u]of t.views.entries())o=o.concat(DC(u,n,r)),xC(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||s.push(u.query));else{const l=t.views.get(i);l&&(o=o.concat(DC(l,n,r)),xC(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!js(t)&&s.push(new(jK())(e._repo,e._path)),{removed:s,events:o}}function xL(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Rs(t,e){let n=null;for(const r of t.views.values())n=n||UK(r,e);return n}function DL(t,e){if(e._queryParams.loadsAllData())return Sg(t);{const r=e._queryIdentifier;return t.views.get(r)}}function OL(t,e){return DL(t,e)!=null}function js(t){return Sg(t)!=null}function Sg(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zp;function GK(t){L(!Zp,"__referenceConstructor has already been defined"),Zp=t}function KK(){return L(Zp,"Reference.ts has not been loaded"),Zp}let QK=1;class LC{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Me(null),this.pendingWriteTree_=SK(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function HT(t,e,n,r,i){return dK(t.pendingWriteTree_,e,n,r,i),i?hu(t,new na(UT(),e,n)):[]}function YK(t,e,n,r){fK(t.pendingWriteTree_,e,n,r);const i=Me.fromObject(n);return hu(t,new Fl(UT(),e,i))}function hs(t,e,n=!1){const r=pK(t.pendingWriteTree_,e);if(mK(t.pendingWriteTree_,e)){let s=new Me(null);return r.snap!=null?s=s.set(Te(),!0):Vt(r.children,o=>{s=s.set(new Ae(o),!0)}),hu(t,new Gp(r.path,s,n))}else return[]}function Td(t,e,n){return hu(t,new na(BT(),e,n))}function JK(t,e,n){const r=Me.fromObject(n);return hu(t,new Fl(BT(),e,r))}function XK(t,e){return hu(t,new kh(BT(),e))}function ZK(t,e,n){const r=GT(t,n);if(r){const i=KT(r),s=i.path,o=i.queryId,a=mn(s,e),l=new kh($T(o),a);return QT(t,s,l)}else return[]}function em(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&(e._queryIdentifier==="default"||OL(o,e))){const l=HK(o,e,n,r);qK(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const u=l.removed;if(a=l.events,!i){const c=u.findIndex(d=>d._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(s,(d,f)=>js(f));if(c&&!h){const d=t.syncPointTree_.subtree(s);if(!d.isEmpty()){const f=n8(d);for(let p=0;p<f.length;++p){const m=f[p],v=m.query,g=FL(t,m);t.listenProvider_.startListening(Rc(v),Nh(t,v),g.hashFn,g.onComplete)}}}!h&&u.length>0&&!r&&(c?t.listenProvider_.stopListening(Rc(e),null):u.forEach(d=>{const f=t.queryToTagMap.get(Ag(d));t.listenProvider_.stopListening(Rc(d),f)}))}r8(t,u)}return a}function LL(t,e,n,r){const i=GT(t,r);if(i!=null){const s=KT(i),o=s.path,a=s.queryId,l=mn(o,e),u=new na($T(a),l,n);return QT(t,o,u)}else return[]}function e8(t,e,n,r){const i=GT(t,r);if(i){const s=KT(i),o=s.path,a=s.queryId,l=mn(o,e),u=Me.fromObject(n),c=new Fl($T(a),l,u);return QT(t,o,c)}else return[]}function dw(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(d,f)=>{const p=mn(d,i);s=s||Rs(f,p),o=o||js(f)});let a=t.syncPointTree_.get(i);a?(o=o||js(a),s=s||Rs(a,Te())):(a=new kL,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;s!=null?l=!0:(l=!1,s=X.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{const m=Rs(p,Te());m&&(s=s.updateImmediateChild(f,m))}));const u=OL(a,e);if(!u&&!e._queryParams.loadsAllData()){const d=Ag(e);L(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const f=i8();t.queryToTagMap.set(d,f),t.tagToQueryMap.set(f,d)}const c=Tg(t.pendingWriteTree_,i);let h=WK(a,e,n,c,s,l);if(!u&&!o&&!r){const d=DL(a,e);h=h.concat(s8(t,e,d))}return h}function Rg(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=mn(o,e),u=Rs(a,l);if(u)return u});return SL(i,e,s,n,!0)}function t8(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,c)=>{const h=mn(u,n);r=r||Rs(c,h)});let i=t.syncPointTree_.get(n);i?r=r||Rs(i,Te()):(i=new kL,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=r!=null,o=s?new zs(r,!0,!1):null,a=Tg(t.pendingWriteTree_,e._path),l=NL(i,e,a,s?o.getNode():X.EMPTY_NODE,s);return FK(l)}function hu(t,e){return ML(e,t.syncPointTree_,null,Tg(t.pendingWriteTree_,Te()))}function ML(t,e,n,r){if(ce(t.path))return VL(t,e,n,r);{const i=e.get(Te());n==null&&i!=null&&(n=Rs(i,Te()));let s=[];const o=ue(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const u=n?n.getImmediateChild(o):null,c=RL(r,o);s=s.concat(ML(a,l,u,c))}return i&&(s=s.concat(WT(i,t,r,n))),s}}function VL(t,e,n,r){const i=e.get(Te());n==null&&i!=null&&(n=Rs(i,Te()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,u=RL(r,o),c=t.operationForChild(o);c&&(s=s.concat(VL(c,a,l,u)))}),i&&(s=s.concat(WT(i,t,r,n))),s}function FL(t,e){const n=e.query,r=Nh(t,n);return{hashFn:()=>(VK(e)||X.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?ZK(t,n._path,r):XK(t,n._path);{const s=YH(i,n);return em(t,n,null,s)}}}}function Nh(t,e){const n=Ag(e);return t.queryToTagMap.get(n)}function Ag(t){return t._path.toString()+"$"+t._queryIdentifier}function GT(t,e){return t.tagToQueryMap.get(e)}function KT(t){const e=t.indexOf("$");return L(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ae(t.substr(0,e))}}function QT(t,e,n){const r=t.syncPointTree_.get(e);L(r,"Missing sync point for query tag that we're tracking");const i=Tg(t.pendingWriteTree_,e);return WT(r,n,i,null)}function n8(t){return t.fold((e,n,r)=>{if(n&&js(n))return[Sg(n)];{let i=[];return n&&(i=xL(n)),Vt(r,(s,o)=>{i=i.concat(o)}),i}})}function Rc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(KK())(t._repo,t._path):t}function r8(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=Ag(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function i8(){return QK++}function s8(t,e,n){const r=e._path,i=Nh(t,e),s=FL(t,n),o=t.listenProvider_.startListening(Rc(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)L(!js(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,c,h)=>{if(!ce(u)&&c&&js(c))return[Sg(c).query];{let d=[];return c&&(d=d.concat(xL(c).map(f=>f.query))),Vt(h,(f,p)=>{d=d.concat(p)}),d}});for(let u=0;u<l.length;++u){const c=l[u];t.listenProvider_.stopListening(Rc(c),Nh(t,c))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new YT(n)}node(){return this.node_}}class JT{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ke(this.path_,e);return new JT(this.syncTree_,n)}node(){return Rg(this.syncTree_,this.path_)}}const o8=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},MC=function(t,e,n){if(!t||typeof t!="object")return t;if(L(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return a8(t[".sv"],e,n);if(typeof t[".sv"]=="object")return l8(t[".sv"],e);L(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},a8=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:L(!1,"Unexpected server value: "+t)}},l8=function(t,e,n){t.hasOwnProperty("increment")||L(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&L(!1,"Unexpected increment value: "+r);const i=e.node();if(L(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},UL=function(t,e,n,r){return ZT(e,new JT(n,t),r)},XT=function(t,e,n){return ZT(t,new YT(e),n)};function ZT(t,e,n){const r=t.getPriority().val(),i=MC(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=MC(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Ct(a,Je(i)):t}else{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Ct(i))),o.forEachChild(Fe,(a,l)=>{const u=ZT(l,e.getImmediateChild(a),n);u!==l&&(s=s.updateImmediateChild(a,u))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Cg(t,e){let n=e instanceof Ae?e:new Ae(e),r=t,i=ue(n);for(;i!==null;){const s=zo(r.node.children,i)||{children:{},childCount:0};r=new e0(i,r,s),n=De(n),i=ue(n)}return r}function va(t){return t.node.value}function t0(t,e){t.node.value=e,fw(t)}function BL(t){return t.node.childCount>0}function u8(t){return va(t)===void 0&&!BL(t)}function Pg(t,e){Vt(t.node.children,(n,r)=>{e(new e0(n,t,r))})}function $L(t,e,n,r){n&&!r&&e(t),Pg(t,i=>{$L(i,e,!0,r)}),n&&r&&e(t)}function c8(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Sd(t){return new Ae(t.parent===null?t.name:Sd(t.parent)+"/"+t.name)}function fw(t){t.parent!==null&&h8(t.parent,t.name,t)}function h8(t,e,n){const r=u8(n),i=Gn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,fw(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,fw(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d8=/[\[\].#$\/\u0000-\u001F\u007F]/,f8=/[\[\].#$\u0000-\u001F\u007F]/,X_=10*1024*1024,bg=function(t){return typeof t=="string"&&t.length!==0&&!d8.test(t)},zL=function(t){return typeof t=="string"&&t.length!==0&&!f8.test(t)},p8=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),zL(t)},xh=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!yg(t)||t&&typeof t=="object"&&Gn(t,".sv")},si=function(t,e,n,r){r&&e===void 0||Rd(Mn(t,"value"),e,n)},Rd=function(t,e,n){const r=n instanceof Ae?new kG(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+co(r));if(typeof e=="function")throw new Error(t+"contains a function "+co(r)+" with contents = "+e.toString());if(yg(e))throw new Error(t+"contains "+e.toString()+" "+co(r));if(typeof e=="string"&&e.length>X_/3&&Am(e)>X_)throw new Error(t+"contains a string greater than "+X_+" utf8 bytes "+co(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Vt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!bg(o)))throw new Error(t+" contains an invalid key ("+o+") "+co(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);NG(r,o),Rd(t,a,r),xG(r)}),i&&s)throw new Error(t+' contains ".value" child '+co(r)+" in addition to actual children.")}},m8=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=Ah(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!bg(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(bG);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&ar(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},jL=function(t,e,n,r){if(r&&e===void 0)return;const i=Mn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Vt(e,(o,a)=>{const l=new Ae(o);if(Rd(i,a,Ke(n,l)),xT(l)===".priority"&&!xh(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),m8(i,s)},n0=function(t,e,n){if(!(n&&e===void 0)){if(yg(e))throw new Error(Mn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!xh(e))throw new Error(Mn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ad=function(t,e,n,r){if(!(r&&n===void 0)&&!bg(n))throw new Error(Mn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Dh=function(t,e,n,r){if(!(r&&n===void 0)&&!zL(n))throw new Error(Mn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},g8=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Dh(t,e,n,r)},lr=function(t,e){if(ue(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},qL=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!bg(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!p8(n))throw new Error(Mn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _8{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function kg(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();n!==null&&!DT(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function WL(t,e,n){kg(t,n),HL(t,r=>DT(r,e))}function Yn(t,e,n){kg(t,n),HL(t,r=>ar(r,e)||ar(e,r))}function HL(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const s=i.path;e(s)?(y8(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function y8(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Lo&&Dt("event: "+n.toString()),uu(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GL="repo_interrupt",v8=25;class w8{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new _8,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Hp(),this.transactionQueueTree_=new e0,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function E8(t,e,n){if(t.stats_=kT(t.repoInfo_),t.forceRestClient_||eG())t.server_=new Wp(t.repoInfo_,(r,i,s,o)=>{VC(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>FC(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Et(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Ti(t.repoInfo_,e,(r,i,s,o)=>{VC(t,r,i,s,o)},r=>{FC(t,r)},r=>{I8(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=sG(t.repoInfo_,()=>new oK(t.stats_,t.server_)),t.infoData_=new tK,t.infoSyncTree_=new LC({startListening:(r,i,s,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Td(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),r0(t,"connected",!1),t.serverSyncTree_=new LC({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,l)=>{const u=o(a,l);Yn(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function KL(t){const n=t.infoData_.getNode(new Ae(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Cd(t){return o8({timestamp:KL(t)})}function VC(t,e,n,r,i){t.dataUpdateCount++;const s=new Ae(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const l=gp(n,u=>Je(u));o=e8(t.serverSyncTree_,s,l,i)}else{const l=Je(n);o=LL(t.serverSyncTree_,s,l,i)}else if(r){const l=gp(n,u=>Je(u));o=JK(t.serverSyncTree_,s,l)}else{const l=Je(n);o=Td(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Bl(t,s)),Yn(t.eventQueue_,a,o)}function FC(t,e){r0(t,"connected",e),e===!1&&R8(t)}function I8(t,e){Vt(e,(n,r)=>{r0(t,n,r)})}function r0(t,e,n){const r=new Ae("/.info/"+e),i=Je(n);t.infoData_.updateSnapshot(r,i);const s=Td(t.infoSyncTree_,r,i);Yn(t.eventQueue_,r,s)}function Ng(t){return t.nextWriteId_++}function T8(t,e,n){const r=t8(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{const s=Je(i).withIndex(e._queryParams.getIndex());dw(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Td(t.serverSyncTree_,e._path,s);else{const a=Nh(t.serverSyncTree_,e);o=LL(t.serverSyncTree_,e._path,s,a)}return Yn(t.eventQueue_,e._path,o),em(t.serverSyncTree_,e,n,null,!0),s},i=>(du(t,"get for query "+Et(e)+" failed: "+i),Promise.reject(new Error(i))))}function i0(t,e,n,r,i){du(t,"set",{path:e.toString(),value:n,priority:r});const s=Cd(t),o=Je(n,r),a=Rg(t.serverSyncTree_,e),l=XT(o,a,s),u=Ng(t),c=HT(t.serverSyncTree_,e,l,u,!0);kg(t.eventQueue_,c),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const p=d==="ok";p||ln("set at "+e+" failed: "+d);const m=hs(t.serverSyncTree_,u,!p);Yn(t.eventQueue_,e,m),qs(t,i,d,f)});const h=o0(t,e);Bl(t,h),Yn(t.eventQueue_,h,[])}function S8(t,e,n,r){du(t,"update",{path:e.toString(),value:n});let i=!0;const s=Cd(t),o={};if(Vt(n,(a,l)=>{i=!1,o[a]=UL(Ke(e,a),Je(l),t.serverSyncTree_,s)}),i)Dt("update() called with empty data.  Don't do anything."),qs(t,r,"ok",void 0);else{const a=Ng(t),l=YK(t.serverSyncTree_,e,o,a);kg(t.eventQueue_,l),t.server_.merge(e.toString(),n,(u,c)=>{const h=u==="ok";h||ln("update at "+e+" failed: "+u);const d=hs(t.serverSyncTree_,a,!h),f=d.length>0?Bl(t,e):e;Yn(t.eventQueue_,f,d),qs(t,r,u,c)}),Vt(n,u=>{const c=o0(t,Ke(e,u));Bl(t,c)}),Yn(t.eventQueue_,e,[])}}function R8(t){du(t,"onDisconnectEvents");const e=Cd(t),n=Hp();ow(t.onDisconnect_,Te(),(i,s)=>{const o=UL(i,s,t.serverSyncTree_,e);cu(n,i,o)});let r=[];ow(n,Te(),(i,s)=>{r=r.concat(Td(t.serverSyncTree_,i,s));const o=o0(t,i);Bl(t,o)}),t.onDisconnect_=Hp(),Yn(t.eventQueue_,Te(),r)}function A8(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&sw(t.onDisconnect_,e),qs(t,n,r,i)})}function UC(t,e,n,r){const i=Je(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&cu(t.onDisconnect_,e,i),qs(t,r,s,o)})}function C8(t,e,n,r,i){const s=Je(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&cu(t.onDisconnect_,e,s),qs(t,i,o,a)})}function P8(t,e,n,r){if(mp(n)){Dt("onDisconnect().update() called with empty data.  Don't do anything."),qs(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&Vt(n,(o,a)=>{const l=Je(a);cu(t.onDisconnect_,Ke(e,o),l)}),qs(t,r,i,s)})}function b8(t,e,n){let r;ue(e._path)===".info"?r=dw(t.infoSyncTree_,e,n):r=dw(t.serverSyncTree_,e,n),WL(t.eventQueue_,e._path,r)}function pw(t,e,n){let r;ue(e._path)===".info"?r=em(t.infoSyncTree_,e,n):r=em(t.serverSyncTree_,e,n),WL(t.eventQueue_,e._path,r)}function QL(t){t.persistentConnection_&&t.persistentConnection_.interrupt(GL)}function k8(t){t.persistentConnection_&&t.persistentConnection_.resume(GL)}function du(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Dt(n,...e)}function qs(t,e,n,r){e&&uu(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function N8(t,e,n,r,i,s){du(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:qO(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=s0(t,e,void 0);o.currentInputSnapshot=a;const l=o.update(a.val());if(l===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Rd("transaction failed: Data returned ",l,o.path),o.status=0;const u=Cg(t.transactionQueueTree_,e),c=va(u)||[];c.push(o),t0(u,c);let h;typeof l=="object"&&l!==null&&Gn(l,".priority")?(h=zo(l,".priority"),L(xh(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Rg(t.serverSyncTree_,e)||X.EMPTY_NODE).getPriority().val();const d=Cd(t),f=Je(l,h),p=XT(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Ng(t);const m=HT(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);Yn(t.eventQueue_,e,m),xg(t,t.transactionQueueTree_)}}function s0(t,e,n){return Rg(t.serverSyncTree_,e,n)||X.EMPTY_NODE}function xg(t,e=t.transactionQueueTree_){if(e||Dg(t,e),va(e)){const n=JL(t,e);L(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&x8(t,Sd(e),n)}else BL(e)&&Pg(e,n=>{xg(t,n)})}function x8(t,e,n){const r=n.map(u=>u.currentWriteId),i=s0(t,e,r);let s=i;const o=i.hash();for(let u=0;u<n.length;u++){const c=n[u];L(c.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;const h=mn(e,c.path);s=s.updateChild(h,c.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;t.server_.put(l.toString(),a,u=>{du(t,"transaction put response",{path:l.toString(),status:u});let c=[];if(u==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,c=c.concat(hs(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();Dg(t,Cg(t.transactionQueueTree_,e)),xg(t,t.transactionQueueTree_),Yn(t.eventQueue_,e,c);for(let d=0;d<h.length;d++)uu(h[d])}else{if(u==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{ln("transaction at "+l.toString()+" failed: "+u);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=u}Bl(t,e)}},o)}function Bl(t,e){const n=YL(t,e),r=Sd(n),i=JL(t,n);return D8(t,i,r),r}function D8(t,e,n){if(e.length===0)return;const r=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=mn(n,l.path);let c=!1,h;if(L(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)c=!0,h=l.abortReason,i=i.concat(hs(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=v8)c=!0,h="maxretry",i=i.concat(hs(t.serverSyncTree_,l.currentWriteId,!0));else{const d=s0(t,l.path,o);l.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){Rd("transaction failed: Data returned ",f,l.path);let p=Je(f);typeof f=="object"&&f!=null&&Gn(f,".priority")||(p=p.updatePriority(d.getPriority()));const v=l.currentWriteId,g=Cd(t),_=XT(p,d,g);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=_,l.currentWriteId=Ng(t),o.splice(o.indexOf(v),1),i=i.concat(HT(t.serverSyncTree_,l.path,_,l.currentWriteId,l.applyLocally)),i=i.concat(hs(t.serverSyncTree_,v,!0))}else c=!0,h="nodata",i=i.concat(hs(t.serverSyncTree_,l.currentWriteId,!0))}Yn(t.eventQueue_,n,i),i=[],c&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}Dg(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)uu(r[a]);xg(t,t.transactionQueueTree_)}function YL(t,e){let n,r=t.transactionQueueTree_;for(n=ue(e);n!==null&&va(r)===void 0;)r=Cg(r,n),e=De(e),n=ue(e);return r}function JL(t,e){const n=[];return XL(t,e,n),n.sort((r,i)=>r.order-i.order),n}function XL(t,e,n){const r=va(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Pg(e,i=>{XL(t,i,n)})}function Dg(t,e){const n=va(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,t0(e,n.length>0?n:void 0)}Pg(e,r=>{Dg(t,r)})}function o0(t,e){const n=Sd(YL(t,e)),r=Cg(t.transactionQueueTree_,e);return c8(r,i=>{Z_(t,i)}),Z_(t,r),$L(r,i=>{Z_(t,i)}),n}function Z_(t,e){const n=va(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(L(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(L(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(hs(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?t0(e,void 0):n.length=s+1,Yn(t.eventQueue_,Sd(e),i);for(let o=0;o<r.length;o++)uu(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O8(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function L8(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ln(`Invalid query segment '${n}' in query '${t}'`)}return e}const mw=function(t,e){const n=M8(t),r=n.namespace;n.domain==="firebase.com"&&ii(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&ii("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||WH();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new iL(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Ae(n.pathString)}},M8=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let c=t.indexOf("/");c===-1&&(c=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(c,h)),c<h&&(i=O8(t.substring(c,h)));const d=L8(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const f=e.slice(0,u);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in d&&(s=d.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",V8=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let i;const s=new Array(8);for(i=7;i>=0;i--)s[i]=BC.charAt(n%64),n=Math.floor(n/64);L(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=BC.charAt(e[i]);return L(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Et(this.snapshot.exportVal())}}class eM{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return L(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F8=class{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Cn;return A8(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){lr("OnDisconnect.remove",this._path);const e=new Cn;return UC(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){lr("OnDisconnect.set",this._path),si("OnDisconnect.set",e,this._path,!1);const n=new Cn;return UC(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){lr("OnDisconnect.setWithPriority",this._path),si("OnDisconnect.setWithPriority",e,this._path,!1),n0("OnDisconnect.setWithPriority",n,!1);const r=new Cn;return C8(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){lr("OnDisconnect.update",this._path),jL("OnDisconnect.update",e,this._path,!1);const n=new Cn;return P8(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ce(this._path)?null:xT(this._path)}get ref(){return new mr(this._repo,this._path)}get _queryIdentifier(){const e=RC(this._queryParams),n=PT(e);return n==="{}"?"default":n}get _queryObject(){return RC(this._queryParams)}isEqual(e){if(e=H(e),!(e instanceof Fn))return!1;const n=this._repo===e._repo,r=DT(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+PG(this._path)}}function Og(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function no(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===ei){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Bs)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==xi)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Fe){if(e!=null&&!xh(e)||n!=null&&!xh(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(L(t.getIndex()instanceof MT||t.getIndex()===VT,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Lg(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class mr extends Fn{constructor(e,n){super(e,n,new wg,!1)}get parent(){const e=fL(this._path);return e===null?null:new mr(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let Mg=class gw{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ae(e),r=ia(this.ref,e);return new gw(this._node.getChild(n),r,Fe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new gw(i,ia(this.ref,r),Fe)))}hasChild(e){const n=new Ae(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function tM(t,e){return t=H(t),t._checkNotDeleted("ref"),e!==void 0?ia(t._root,e):t._root}function $C(t,e){t=H(t),t._checkNotDeleted("refFromURL");const n=mw(e,t._repo.repoInfo_.nodeAdmin);qL("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&ii("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),tM(t,n.path.toString())}function ia(t,e){return t=H(t),ue(t._path)===null?g8("child","path",e,!1):Dh("child","path",e,!1),new mr(t._repo,Ke(t._path,e))}function U8(t,e){t=H(t),lr("push",t._path),si("push",e,t._path,!0);const n=KL(t._repo),r=V8(n),i=ia(t,r),s=ia(t,r);let o;return e!=null?o=l0(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function B8(t){return lr("remove",t._path),l0(t,null)}function l0(t,e){t=H(t),lr("set",t._path),si("set",e,t._path,!1);const n=new Cn;return i0(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function $8(t,e){t=H(t),lr("setPriority",t._path),n0("setPriority",e,!1);const n=new Cn;return i0(t._repo,Ke(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function z8(t,e,n){if(lr("setWithPriority",t._path),si("setWithPriority",e,t._path,!1),n0("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new Cn;return i0(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function j8(t,e){jL("update",e,t._path,!1);const n=new Cn;return S8(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function q8(t){t=H(t);const e=new a0(()=>{}),n=new Pd(e);return T8(t._repo,t,n).then(r=>new Mg(r,new mr(t._repo,t._path),t._queryParams.getIndex()))}class Pd{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new ZL("value",this,new Mg(e.snapshotNode,new mr(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new eM(this,e,n):null}matches(e){return e instanceof Pd?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Vg{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new eM(this,e,n):null}createEvent(e,n){L(e.childName!=null,"Child events should have a childName.");const r=ia(new mr(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new ZL(e.type,this,new Mg(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Vg?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function bd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const l=n,u=(c,h)=>{pw(t._repo,t,a),l(c,h)};u.userCallback=n.userCallback,u.context=n.context,n=u}const o=new a0(n,s||void 0),a=e==="value"?new Pd(o):new Vg(e,o);return b8(t._repo,t,a),()=>pw(t._repo,t,a)}function _w(t,e,n,r){return bd(t,"value",e,n,r)}function zC(t,e,n,r){return bd(t,"child_added",e,n,r)}function jC(t,e,n,r){return bd(t,"child_changed",e,n,r)}function qC(t,e,n,r){return bd(t,"child_moved",e,n,r)}function WC(t,e,n,r){return bd(t,"child_removed",e,n,r)}function HC(t,e,n){let r=null;const i=n?new a0(n):null;e==="value"?r=new Pd(i):e&&(r=new Vg(e,i)),pw(t._repo,t,r)}class Dr{}class nM extends Dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){si("endAt",this._value,e._path,!0);const n=iw(e._queryParams,this._value,this._key);if(Lg(n),no(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Fn(e._repo,e._path,n,e._orderByCalled)}}function W8(t,e){return Ad("endAt","key",e,!0),new nM(t,e)}class H8 extends Dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){si("endBefore",this._value,e._path,!1);const n=eK(e._queryParams,this._value,this._key);if(Lg(n),no(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Fn(e._repo,e._path,n,e._orderByCalled)}}function G8(t,e){return Ad("endBefore","key",e,!0),new H8(t,e)}class rM extends Dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){si("startAt",this._value,e._path,!0);const n=rw(e._queryParams,this._value,this._key);if(Lg(n),no(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Fn(e._repo,e._path,n,e._orderByCalled)}}function K8(t=null,e){return Ad("startAt","key",e,!0),new rM(t,e)}class Q8 extends Dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){si("startAfter",this._value,e._path,!1);const n=ZG(e._queryParams,this._value,this._key);if(Lg(n),no(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Fn(e._repo,e._path,n,e._orderByCalled)}}function Y8(t,e){return Ad("startAfter","key",e,!0),new Q8(t,e)}class J8 extends Dr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Fn(e._repo,e._path,JG(e._queryParams,this._limit),e._orderByCalled)}}function X8(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new J8(t)}class Z8 extends Dr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Fn(e._repo,e._path,XG(e._queryParams,this._limit),e._orderByCalled)}}function eQ(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Z8(t)}class tQ extends Dr{constructor(e){super(),this._path=e}_apply(e){Og(e,"orderByChild");const n=new Ae(this._path);if(ce(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new MT(n),i=Eg(e._queryParams,r);return no(i),new Fn(e._repo,e._path,i,!0)}}function nQ(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Dh("orderByChild","path",t,!1),new tQ(t)}class rQ extends Dr{_apply(e){Og(e,"orderByKey");const n=Eg(e._queryParams,ei);return no(n),new Fn(e._repo,e._path,n,!0)}}function iQ(){return new rQ}class sQ extends Dr{_apply(e){Og(e,"orderByPriority");const n=Eg(e._queryParams,Fe);return no(n),new Fn(e._repo,e._path,n,!0)}}function oQ(){return new sQ}class aQ extends Dr{_apply(e){Og(e,"orderByValue");const n=Eg(e._queryParams,VT);return no(n),new Fn(e._repo,e._path,n,!0)}}function lQ(){return new aQ}class uQ extends Dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(si("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new nM(this._value,this._key)._apply(new rM(this._value,this._key)._apply(e))}}function cQ(t,e){return Ad("equalTo","key",e,!0),new uQ(t,e)}function vr(t,...e){let n=H(t);for(const r of e)n=r._apply(n);return n}zK(mr);GK(mr);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hQ="FIREBASE_DATABASE_EMULATOR_HOST",yw={};let dQ=!1;function fQ(t,e,n,r){t.repoInfo_=new iL(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function iM(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||ii("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Dt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=mw(s,i),a=o.repoInfo,l,u;typeof process<"u"&&aC&&(u=aC[hQ]),u?(l=!0,s=`http://${u}?ns=${a.namespace}`,o=mw(s,i),a=o.repoInfo):l=!o.repoInfo.secure;const c=i&&l?new dl(dl.OWNER):new nG(t.name,t.options,e);qL("Invalid Firebase Database URL",o),ce(o.path)||ii("Database URL must point to the root of a Firebase Database (not including a child path).");const h=mQ(a,t,c,new tG(t.name,n));return new gQ(h,t)}function pQ(t,e){const n=yw[e];(!n||n[t.key]!==t)&&ii(`Database ${e}(${t.repoInfo_}) has already been deleted.`),QL(t),delete n[t.key]}function mQ(t,e,n,r){let i=yw[e.name];i||(i={},yw[e.name]=i);let s=i[t.toURLString()];return s&&ii("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new w8(t,dQ,n,r),i[t.toURLString()]=s,s}let gQ=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(E8(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new mr(this._repo,Te())),this._rootInternal}_delete(){return this._rootInternal!==null&&(pQ(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ii("Cannot call "+e+" on a deleted database.")}};function sM(){Ml.IS_TRANSPORT_INITIALIZED&&ln("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function _Q(){sM(),cs.forceDisallow()}function yQ(){sM(),ir.forceDisallow(),cs.forceAllow()}function vQ(t,e,n,r={}){t=H(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&ii("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ii('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new dl(dl.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:r1(r.mockUserToken,t.app.options.projectId);s=new dl(o)}fQ(i,e,n,s)}function wQ(t){t=H(t),t._checkNotDeleted("goOffline"),QL(t._repo)}function EQ(t){t=H(t),t._checkNotDeleted("goOnline"),k8(t._repo)}function IQ(t,e){HO(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TQ(t){zO(Li),Pi(new Vn("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return iM(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),hr(lC,uC,t),hr(lC,uC,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SQ={".sv":"timestamp"};function RQ(){return SQ}function AQ(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CQ=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function PQ(t,e,n){var r;if(t=H(t),lr("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(r=n==null?void 0:n.applyLocally)!==null&&r!==void 0?r:!0,s=new Cn,o=(l,u,c)=>{let h=null;l?s.reject(l):(h=new Mg(c,new mr(t._repo,t._path),Fe),s.resolve(new CQ(u,h)))},a=_w(t,()=>{});return N8(t._repo,t._path,e,o,a,i),s.promise}Ti.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Ti.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};TQ();const bQ="@firebase/database-compat",kQ="1.0.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NQ=new Kl("@firebase/database-compat"),oM=function(t){const e="FIREBASE WARNING: "+t;NQ.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xQ=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Mn(t,e)+"must be a boolean.")},DQ=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Mn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OQ{constructor(e){this._delegate=e}cancel(e){ee("OnDisconnect.cancel",0,1,arguments.length),kt("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){ee("OnDisconnect.remove",0,1,arguments.length),kt("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){ee("OnDisconnect.set",1,2,arguments.length),kt("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){ee("OnDisconnect.setWithPriority",2,3,arguments.length),kt("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(ee("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,oM("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}kt("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LQ{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return ee("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,n){this._database=e,this._delegate=n}val(){return ee("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ee("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ee("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ee("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ee("DataSnapshot.child",0,1,arguments.length),e=String(e),Dh("DataSnapshot.child","path",e,!1),new As(this._database,this._delegate.child(e))}hasChild(e){return ee("DataSnapshot.hasChild",1,1,arguments.length),Dh("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ee("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ee("DataSnapshot.forEach",1,1,arguments.length),kt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new As(this._database,n)))}hasChildren(){return ee("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ee("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ee("DataSnapshot.ref",0,0,arguments.length),new zn(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class qt{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;ee("Query.on",2,4,arguments.length),kt("Query.on","callback",n,!1);const o=qt.getCancelAndContextArgs_("Query.on",r,i),a=(u,c)=>{n.call(o.context,new As(this.database,u),c)};a.userCallback=n,a.context=o.context;const l=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return _w(this._delegate,a,l),n;case"child_added":return zC(this._delegate,a,l),n;case"child_removed":return WC(this._delegate,a,l),n;case"child_changed":return jC(this._delegate,a,l),n;case"child_moved":return qC(this._delegate,a,l),n;default:throw new Error(Mn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(ee("Query.off",0,3,arguments.length),DQ("Query.off",e,!0),kt("Query.off","callback",n,!0),uR("Query.off","context",r,!0),n){const i=()=>{};i.userCallback=n,i.context=r,HC(this._delegate,e,i)}else HC(this._delegate,e)}get(){return q8(this._delegate).then(e=>new As(this.database,e))}once(e,n,r,i){ee("Query.once",1,4,arguments.length),kt("Query.once","callback",n,!0);const s=qt.getCancelAndContextArgs_("Query.once",r,i),o=new Cn,a=(u,c)=>{const h=new As(this.database,u);n&&n.call(s.context,h,c),o.resolve(h)};a.userCallback=n,a.context=s.context;const l=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":_w(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":zC(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":WC(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":jC(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":qC(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(Mn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ee("Query.limitToFirst",1,1,arguments.length),new qt(this.database,vr(this._delegate,X8(e)))}limitToLast(e){return ee("Query.limitToLast",1,1,arguments.length),new qt(this.database,vr(this._delegate,eQ(e)))}orderByChild(e){return ee("Query.orderByChild",1,1,arguments.length),new qt(this.database,vr(this._delegate,nQ(e)))}orderByKey(){return ee("Query.orderByKey",0,0,arguments.length),new qt(this.database,vr(this._delegate,iQ()))}orderByPriority(){return ee("Query.orderByPriority",0,0,arguments.length),new qt(this.database,vr(this._delegate,oQ()))}orderByValue(){return ee("Query.orderByValue",0,0,arguments.length),new qt(this.database,vr(this._delegate,lQ()))}startAt(e=null,n){return ee("Query.startAt",0,2,arguments.length),new qt(this.database,vr(this._delegate,K8(e,n)))}startAfter(e=null,n){return ee("Query.startAfter",0,2,arguments.length),new qt(this.database,vr(this._delegate,Y8(e,n)))}endAt(e=null,n){return ee("Query.endAt",0,2,arguments.length),new qt(this.database,vr(this._delegate,W8(e,n)))}endBefore(e=null,n){return ee("Query.endBefore",0,2,arguments.length),new qt(this.database,vr(this._delegate,G8(e,n)))}equalTo(e,n){return ee("Query.equalTo",1,2,arguments.length),new qt(this.database,vr(this._delegate,cQ(e,n)))}toString(){return ee("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ee("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ee("Query.isEqual",1,1,arguments.length),!(e instanceof qt)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,kt(e,"cancel",i.cancel,!0),i.context=r,uR(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Mn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new zn(this.database,new mr(this._delegate._repo,this._delegate._path))}}class zn extends qt{constructor(e,n){super(e,new Fn(n._repo,n._path,new wg,!1)),this.database=e,this._delegate=n}getKey(){return ee("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ee("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new zn(this.database,ia(this._delegate,e))}getParent(){ee("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new zn(this.database,e):null}getRoot(){return ee("Reference.root",0,0,arguments.length),new zn(this.database,this._delegate.root)}set(e,n){ee("Reference.set",1,2,arguments.length),kt("Reference.set","onComplete",n,!0);const r=l0(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(ee("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,oM("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}lr("Reference.update",this._delegate._path),kt("Reference.update","onComplete",n,!0);const r=j8(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){ee("Reference.setWithPriority",2,3,arguments.length),kt("Reference.setWithPriority","onComplete",r,!0);const i=z8(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ee("Reference.remove",0,1,arguments.length),kt("Reference.remove","onComplete",e,!0);const n=B8(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){ee("Reference.transaction",1,3,arguments.length),kt("Reference.transaction","transactionUpdate",e,!1),kt("Reference.transaction","onComplete",n,!0),xQ("Reference.transaction","applyLocally",r,!0);const i=PQ(this._delegate,e,{applyLocally:r}).then(s=>new LQ(s.committed,new As(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){ee("Reference.setPriority",1,2,arguments.length),kt("Reference.setPriority","onComplete",n,!0);const r=$8(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){ee("Reference.push",0,2,arguments.length),kt("Reference.push","onComplete",n,!0);const r=U8(this._delegate,e),i=r.then(o=>new zn(this.database,o));n&&i.then(()=>n(null),o=>n(o));const s=new zn(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return lr("Reference.onDisconnect",this._delegate._path),new OQ(new F8(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:_Q,forceLongPolling:yQ}}useEmulator(e,n,r={}){vQ(this._delegate,e,n,r)}ref(e){if(ee("database.ref",0,1,arguments.length),e instanceof zn){const n=$C(this._delegate,e.toString());return new zn(this,n)}else{const n=tM(this._delegate,e);return new zn(this,n)}}refFromURL(e){ee("database.refFromURL",1,1,arguments.length);const r=$C(this._delegate,e);return new zn(this,r)}goOffline(){return ee("database.goOffline",0,0,arguments.length),wQ(this._delegate)}goOnline(){return ee("database.goOnline",0,0,arguments.length),EQ(this._delegate)}}Oh.ServerValue={TIMESTAMP:RQ(),increment:t=>AQ(t)};function MQ({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){zO(n);const a=new u1("database-standalone"),l=new sv("auth-internal",a);l.setComponent(new Vn("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new sv("app-check-internal",a),u.setComponent(new Vn("app-check-internal",()=>i,"PRIVATE"))),{instance:new Oh(iM(t,l,u,e,o),t),namespace:s}}var VQ=Object.freeze({__proto__:null,initStandalone:MQ});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FQ=Oh.ServerValue;function UQ(t){t.INTERNAL.registerComponent(new Vn("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Oh(i,r)},"PUBLIC").setServiceProps({Reference:zn,Query:qt,Database:Oh,DataSnapshot:As,enableLogging:IQ,INTERNAL:VQ,ServerValue:FQ}).setMultipleInstances(!0)),t.registerVersion(bQ,kQ)}UQ(Ks);const BQ={apiKey:"AIzaSyBr0ZoQKhQhYPcbevN8uuBc680-3WFRsKg",authDomain:"netflix-clonee-13.firebaseapp.com",projectId:"netflix-clonee-13",storageBucket:"netflix-clonee-13.appspot.com",messagingSenderId:"10552875258",appId:"1:10552875258:web:2fb5c9ff034fc59bc91143"},$Q=Ks.initializeApp(BQ);$Q.firestore();const GC=Ks.auth();function zQ(t){let e=M.useRef(),n=M.useRef();const r=d2(),i=()=>{GC.signInWithEmailAndPassword(e.current.value,n.current.value).then(a=>{console.log(a),r("/home")}).catch(a=>{alert(a.message),e="",n=""})},s=()=>{GC.createUserWithEmailAndPassword(e.current.value,n.current.value).then(a=>{console.log(a)}).catch(a=>{alert(a.message),e="",n=""})},o=()=>{t.ontoggle()};return j.createElement("div",null,j.createElement("div",{className:"flex justify-center pb-[10%] items-center flex-col min-h-screen  text-xl text-white"},j.createElement("div",{className:"h-1/2  mx-auto text-center p-10 w-1/2 max-md:w-[90%] shadow-lg bg-black bg-opacity-90 rounded-xl"},j.createElement("button",{onClick:o,className:"flex float-end -mt-5"},j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},j.createElement("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"}))),j.createElement("h1",{className:"text-xl font-bold"},"Sign Up"),j.createElement("div",{className:"flex justify-center space-x-5 py-4"},j.createElement("input",{ref:e,placeholder:"Email",className:"  text-black  focus:outline-none px-2 font-mono text-sm py-1",type:"email",required:!0})),j.createElement("div",{className:"flex justify-center  py-1"},j.createElement("input",{ref:n,placeholder:"Password",className:"  text-black focus:outline-none px-2 font-mono text-sm py-1",type:"password",required:!0})),j.createElement("button",{onClick:i,className:"bg-red-500 text-base font-bold   text-white px-5 my-3 hover:bg-black rounded-sm   transition-all ease-in py-1"},"Login"),j.createElement("p",{className:"text-slate-500"},"new to netflix ?",j.createElement("button",{onClick:s,className:"text-white hover:red-400 pl-2"},"Sign up here")))))}const aM="/assets/netflix-logo-Nav-ovwyqI0T.png";function jQ(){const[t,e]=M.useState(!1),n=()=>{e(!t)};return j.createElement("div",{style:{backgroundImage:'url("https://user-images.githubusercontent.com/33485020/108069438-5ee79d80-7089-11eb-8264-08fdda7e0d11.jpg") '}},j.createElement("section",{className:""},j.createElement("nav",{className:"flex justify-between px-10 py-5"},j.createElement("img",{className:"h-[30px] w-[120px]",src:aM}),j.createElement("button",{onClick:n,className:"bg-red-500 text-base text-white px-4 rounded-md hover:bg-white hover:text-red-500 transition-all ease-in py-2"},"Login")),!t&&j.createElement("div",{className:"flex flex-col min-h-screen justify-center items-center text-center pb-[10%] "},j.createElement("h1",{className:" max-md:text-4xl  text-6xl py-7 max-md:py-2 text-white font-bold "},"Welcome to Netflix "),j.createElement("p",{className:"text-white  max-md:text-xl font-semibold  text-3xl py-5 "},"Find  your  all  series  and  movies  in  one  app "),j.createElement("div",null," ",j.createElement("input",{className:"h-8 focus:outline-none px-2",type:"email"}),j.createElement("button",{onClick:n,className:"bg-red-500 text-base text-white px-3 hover:bg-black  transition-all ease-in py-1"},"Get Started.")))),t&&j.createElement(zQ,{ontoggle:n}))}var lM={exports:{}},Gt=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},hn={searchParams:"URLSearchParams"in Gt,iterable:"Symbol"in Gt&&"iterator"in Symbol,blob:"FileReader"in Gt&&"Blob"in Gt&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Gt,arrayBuffer:"ArrayBuffer"in Gt};function qQ(t){return t&&DataView.prototype.isPrototypeOf(t)}if(hn.arrayBuffer)var WQ=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],HQ=ArrayBuffer.isView||function(t){return t&&WQ.indexOf(Object.prototype.toString.call(t))>-1};function fu(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function u0(t){return typeof t!="string"&&(t=String(t)),t}function c0(t){var e={next:function(){var n=t.shift();return{done:n===void 0,value:n}}};return hn.iterable&&(e[Symbol.iterator]=function(){return e}),e}function St(t){this.map={},t instanceof St?t.forEach(function(e,n){this.append(n,e)},this):Array.isArray(t)?t.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}St.prototype.append=function(t,e){t=fu(t),e=u0(e);var n=this.map[t];this.map[t]=n?n+", "+e:e};St.prototype.delete=function(t){delete this.map[fu(t)]};St.prototype.get=function(t){return t=fu(t),this.has(t)?this.map[t]:null};St.prototype.has=function(t){return this.map.hasOwnProperty(fu(t))};St.prototype.set=function(t,e){this.map[fu(t)]=u0(e)};St.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)};St.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),c0(t)};St.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),c0(t)};St.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),c0(t)};hn.iterable&&(St.prototype[Symbol.iterator]=St.prototype.entries);function ey(t){if(!t._noBody){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}}function uM(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function GQ(t){var e=new FileReader,n=uM(e);return e.readAsArrayBuffer(t),n}function KQ(t){var e=new FileReader,n=uM(e),r=/charset=([A-Za-z0-9_-]+)/.exec(t.type),i=r?r[1]:"utf-8";return e.readAsText(t,i),n}function QQ(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function KC(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function cM(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:hn.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:hn.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:hn.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():hn.arrayBuffer&&hn.blob&&qQ(t)?(this._bodyArrayBuffer=KC(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):hn.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||HQ(t))?this._bodyArrayBuffer=KC(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):hn.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},hn.blob&&(this.blob=function(){var t=ey(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=ey(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(hn.blob)return this.blob().then(GQ);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var t=ey(this);if(t)return t;if(this._bodyBlob)return KQ(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(QQ(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},hn.formData&&(this.formData=function(){return this.text().then(XQ)}),this.json=function(){return this.text().then(JSON.parse)},this}var YQ=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function JQ(t){var e=t.toUpperCase();return YQ.indexOf(e)>-1?e:t}function sa(t,e){if(!(this instanceof sa))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var n=e.body;if(t instanceof sa){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new St(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!n&&t._bodyInit!=null&&(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new St(e.headers)),this.method=JQ(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in Gt){var s=new AbortController;return s.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var i=/\?/;this.url+=(i.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}sa.prototype.clone=function(){return new sa(this,{body:this._bodyInit})};function XQ(t){var e=new FormData;return t.trim().split("&").forEach(function(n){if(n){var r=n.split("="),i=r.shift().replace(/\+/g," "),s=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(s))}}),e}function ZQ(t){var e=new St,n=t.replace(/\r?\n[\t ]+/g," ");return n.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var i=r.split(":"),s=i.shift().trim();if(s){var o=i.join(":").trim();try{e.append(s,o)}catch(a){console.warn("Response "+a.message)}}}),e}cM.call(sa.prototype);function oi(t,e){if(!(this instanceof oi))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new St(e.headers),this.url=e.url||"",this._initBody(t)}cM.call(oi.prototype);oi.prototype.clone=function(){return new oi(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new St(this.headers),url:this.url})};oi.error=function(){var t=new oi(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var e7=[301,302,303,307,308];oi.redirect=function(t,e){if(e7.indexOf(e)===-1)throw new RangeError("Invalid status code");return new oi(null,{status:e,headers:{location:t}})};var _o=Gt.DOMException;try{new _o}catch{_o=function(e,n){this.message=e,this.name=n;var r=Error(e);this.stack=r.stack},_o.prototype=Object.create(Error.prototype),_o.prototype.constructor=_o}function hM(t,e){return new Promise(function(n,r){var i=new sa(t,e);if(i.signal&&i.signal.aborted)return r(new _o("Aborted","AbortError"));var s=new XMLHttpRequest;function o(){s.abort()}s.onload=function(){var u={statusText:s.statusText,headers:ZQ(s.getAllResponseHeaders()||"")};i.url.indexOf("file://")===0&&(s.status<200||s.status>599)?u.status=200:u.status=s.status,u.url="responseURL"in s?s.responseURL:u.headers.get("X-Request-URL");var c="response"in s?s.response:s.responseText;setTimeout(function(){n(new oi(c,u))},0)},s.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},s.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},s.onabort=function(){setTimeout(function(){r(new _o("Aborted","AbortError"))},0)};function a(u){try{return u===""&&Gt.location.href?Gt.location.href:u}catch{return u}}if(s.open(i.method,a(i.url),!0),i.credentials==="include"?s.withCredentials=!0:i.credentials==="omit"&&(s.withCredentials=!1),"responseType"in s&&(hn.blob?s.responseType="blob":hn.arrayBuffer&&(s.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof St||Gt.Headers&&e.headers instanceof Gt.Headers)){var l=[];Object.getOwnPropertyNames(e.headers).forEach(function(u){l.push(fu(u)),s.setRequestHeader(u,u0(e.headers[u]))}),i.headers.forEach(function(u,c){l.indexOf(c)===-1&&s.setRequestHeader(c,u)})}else i.headers.forEach(function(u,c){s.setRequestHeader(c,u)});i.signal&&(i.signal.addEventListener("abort",o),s.onreadystatechange=function(){s.readyState===4&&i.signal.removeEventListener("abort",o)}),s.send(typeof i._bodyInit>"u"?null:i._bodyInit)})}hM.polyfill=!0;Gt.fetch||(Gt.fetch=hM,Gt.Headers=St,Gt.Request=sa,Gt.Response=oi);var ty,QC;function t7(){return QC||(QC=1,ty=self.fetch.bind(self)),ty}(function(t,e){(function(n,r){t.exports=r(t7())})(NM,n=>{function r(u){const c=u&&u.message?u.message:u;console.warn(`movie-trailer: ${c}`)}function i(u){if(!u.ok)throw new Error(u.statusText);return u}function s(u){return encodeURI("https://www.youtube.com/watch?v="+u)}function o(u,c){const h=c&&c.videoType==="tv"?"/3/search/tv?api_key=":"/3/search/movie?api_key=",d="https://api.themoviedb.org"+encodeURI(h+c.apiKey+"&query="+u+(c.year===null?"":"&year="+c.year)+(c.language===null?"":"&language="+c.language));return n(d,{method:"GET"}).then(i).then(p=>p.json()).then(p=>{if(typeof p.status_message<"u")throw new TypeError(p.status_message);if(p.results.length===0){if(c.year!==null){const{year:m,...v}=c;return o(u,v)}throw new Error(`No TMDB Movie found with that search query, try searching https://www.themoviedb.org/search?query=${encodeURIComponent(u)} to verify one exists`)}else return p.results[0].id}).catch(p=>(r(p),null))}function a(u,c){const h=c&&c.videoType==="tv"?"/3/tv/":"/3/movie/",d="https://api.themoviedb.org"+encodeURI(h+u+"/videos?api_key="+c.apiKey+(c.language===null?"":"&language="+c.language));return n(d,{method:"GET"}).then(i).then(p=>p.json()).then(p=>{if(typeof p.status_message<"u")throw new TypeError(`movie-trailer: ${p.status_message}`);if(p.results.length===0)throw new Error("No trailers found for that TMDB ID");let{results:m}=p;return m=m.map(v=>v.key),c.id||(m=m.map(v=>s(v))),c.multi?[...new Set(m)]:m[0]}).catch(p=>(r(p),null))}async function l(u,c,h,d){let f={multi:!1,id:!1,year:null,language:null,videoType:"movie",apiKey:"9d2bff12ed955c7f1f74b83187f188ae"};if(c||(c={}),typeof u!="string"&&!c.tmdbId)throw new Error("Expected first parameter to be a movie or TMDB ID (string)");typeof c=="function"?(h=c,c=null):typeof c=="boolean"||c==="true"?f.multi=c:typeof c=="string"||typeof c=="number"?(f.year=c,typeof d=="function"&&(typeof h=="boolean"||typeof h=="string"&&h==="true")&&(f.multi=h,h=d)):typeof c=="object"&&(f=Object.assign(f,c)),typeof h!="function"&&(h=null);const p=f.tmdbId?f.tmdbId:await o(u,f).catch(v=>(r(v),null));if(!p)return null;const m=a(p,f);return m?h?m.then(v=>h(null,v)).catch(v=>h(v,null)):m:null}return l})})(lM);var n7=lM.exports;const r7=$l(n7);var dM={exports:{}},i7="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",s7=i7,o7=s7;function fM(){}function pM(){}pM.resetWarningCache=fM;var a7=function(){function t(r,i,s,o,a,l){if(l!==o7){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:pM,resetWarningCache:fM};return n.PropTypes=n,n};dM.exports=a7();var l7=dM.exports;const jt=$l(l7);var u7=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n};const c7=$l(u7);var vw={exports:{}},mM;/**
* @link https://github.com/gajus/sister for the canonical source repository
* @license https://github.com/gajus/sister/blob/master/LICENSE BSD 3-Clause
*/mM=function(){var t={},e={};return t.on=function(n,r){var i={name:n,handler:r};return e[n]=e[n]||[],e[n].unshift(i),i},t.off=function(n){var r=e[n.name].indexOf(n);r!==-1&&e[n.name].splice(r,1)},t.trigger=function(n,r){var i=e[n],s;if(i)for(s=i.length;s--;)i[s].handler(r)},t};var h7=mM,ww={exports:{}},d7=function(e,n,r){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("script");typeof n=="function"&&(r=n,n={}),n=n||{},r=r||function(){},s.type=n.type||"text/javascript",s.charset=n.charset||"utf8",s.async="async"in n?!!n.async:!0,s.src=e,n.attrs&&f7(s,n.attrs),n.text&&(s.text=""+n.text);var o="onload"in s?YC:p7;o(s,r),s.onload||YC(s,r),i.appendChild(s)};function f7(t,e){for(var n in e)t.setAttribute(n,e[n])}function YC(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function p7(t,e){t.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,e(null,t))}}(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=d7,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}e.default=function(s){var o=new Promise(function(a){if(window.YT&&window.YT.Player&&window.YT.Player instanceof Function){a(window.YT);return}else{var l=window.location.protocol==="http:"?"http:":"https:";(0,r.default)(l+"//www.youtube.com/iframe_api",function(c){c&&s.trigger("error",c)})}var u=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){u&&u(),a(window.YT)}});return o},t.exports=e.default})(ww,ww.exports);var m7=ww.exports,Ew={exports:{}},Iw={exports:{}},Tw={exports:{}},Lh=1e3,Mh=Lh*60,Vh=Mh*60,Fh=Vh*24,g7=Fh*365.25,_7=function(t,e){e=e||{};var n=typeof t;if(n==="string"&&t.length>0)return y7(t);if(n==="number"&&isNaN(t)===!1)return e.long?w7(t):v7(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function y7(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*g7;case"days":case"day":case"d":return n*Fh;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Vh;case"minutes":case"minute":case"mins":case"min":case"m":return n*Mh;case"seconds":case"second":case"secs":case"sec":case"s":return n*Lh;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function v7(t){return t>=Fh?Math.round(t/Fh)+"d":t>=Vh?Math.round(t/Vh)+"h":t>=Mh?Math.round(t/Mh)+"m":t>=Lh?Math.round(t/Lh)+"s":t+"ms"}function w7(t){return hf(t,Fh,"day")||hf(t,Vh,"hour")||hf(t,Mh,"minute")||hf(t,Lh,"second")||t+" ms"}function hf(t,e,n){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}(function(t,e){e=t.exports=i.debug=i.default=i,e.coerce=l,e.disable=o,e.enable=s,e.enabled=a,e.humanize=_7,e.names=[],e.skips=[],e.formatters={};var n;function r(u){var c=0,h;for(h in u)c=(c<<5)-c+u.charCodeAt(h),c|=0;return e.colors[Math.abs(c)%e.colors.length]}function i(u){function c(){if(c.enabled){var h=c,d=+new Date,f=d-(n||d);h.diff=f,h.prev=n,h.curr=d,n=d;for(var p=new Array(arguments.length),m=0;m<p.length;m++)p[m]=arguments[m];p[0]=e.coerce(p[0]),typeof p[0]!="string"&&p.unshift("%O");var v=0;p[0]=p[0].replace(/%([a-zA-Z%])/g,function(_,y){if(_==="%%")return _;v++;var T=e.formatters[y];if(typeof T=="function"){var b=p[v];_=T.call(h,b),p.splice(v,1),v--}return _}),e.formatArgs.call(h,p);var g=c.log||e.log||console.log.bind(console);g.apply(h,p)}}return c.namespace=u,c.enabled=e.enabled(u),c.useColors=e.useColors(),c.color=r(u),typeof e.init=="function"&&e.init(c),c}function s(u){e.save(u),e.names=[],e.skips=[];for(var c=(typeof u=="string"?u:"").split(/[\s,]+/),h=c.length,d=0;d<h;d++)c[d]&&(u=c[d].replace(/\*/g,".*?"),u[0]==="-"?e.skips.push(new RegExp("^"+u.substr(1)+"$")):e.names.push(new RegExp("^"+u+"$")))}function o(){e.enable("")}function a(u){var c,h;for(c=0,h=e.skips.length;c<h;c++)if(e.skips[c].test(u))return!1;for(c=0,h=e.names.length;c<h;c++)if(e.names[c].test(u))return!0;return!1}function l(u){return u instanceof Error?u.stack||u.message:u}})(Tw,Tw.exports);var E7=Tw.exports;(function(t,e){var n={};e=t.exports=E7,e.log=s,e.formatArgs=i,e.save=o,e.load=a,e.useColors=r,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:l(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function r(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}e.formatters.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}};function i(u){var c=this.useColors;if(u[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+u[0]+(c?"%c ":" ")+"+"+e.humanize(this.diff),!!c){var h="color: "+this.color;u.splice(1,0,h,"color: inherit");var d=0,f=0;u[0].replace(/%[a-zA-Z%]/g,function(p){p!=="%%"&&(d++,p==="%c"&&(f=d))}),u.splice(f,0,h)}}function s(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(u){try{u==null?e.storage.removeItem("debug"):e.storage.debug=u}catch{}}function a(){var u;try{u=e.storage.debug}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=n.DEBUG),u}e.enable(a());function l(){try{return window.localStorage}catch{}}})(Iw,Iw.exports);var I7=Iw.exports,Sw={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=["cueVideoById","loadVideoById","cueVideoByUrl","loadVideoByUrl","playVideo","pauseVideo","stopVideo","getVideoLoadedFraction","cuePlaylist","loadPlaylist","nextVideo","previousVideo","playVideoAt","setShuffle","setLoop","getPlaylist","getPlaylistIndex","setOption","mute","unMute","isMuted","setVolume","getVolume","seekTo","getPlayerState","getPlaybackRate","setPlaybackRate","getAvailablePlaybackRates","getPlaybackQuality","setPlaybackQuality","getAvailableQualityLevels","getCurrentTime","getDuration","removeEventListener","getVideoUrl","getVideoEmbedCode","getOptions","getOption","addEventListener","destroy","setSize","getIframe"],t.exports=e.default})(Sw,Sw.exports);var T7=Sw.exports,Rw={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=["ready","stateChange","playbackQualityChange","playbackRateChange","error","apiChange","volumeChange"],t.exports=e.default})(Rw,Rw.exports);var S7=Rw.exports,Aw={exports:{}},Cw={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default={BUFFERING:3,ENDED:0,PAUSED:2,PLAYING:1,UNSTARTED:-1,VIDEO_CUED:5},t.exports=e.default})(Cw,Cw.exports);var R7=Cw.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=R7,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}e.default={pauseVideo:{acceptableStates:[r.default.ENDED,r.default.PAUSED],stateChangeRequired:!1},playVideo:{acceptableStates:[r.default.ENDED,r.default.PLAYING],stateChangeRequired:!1},seekTo:{acceptableStates:[r.default.ENDED,r.default.PLAYING,r.default.PAUSED],stateChangeRequired:!0,timeout:3e3}},t.exports=e.default})(Aw,Aw.exports);var A7=Aw.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=I7,r=c(n),i=T7,s=c(i),o=S7,a=c(o),l=A7,u=c(l);function c(f){return f&&f.__esModule?f:{default:f}}var h=(0,r.default)("youtube-player"),d={};d.proxyEvents=function(f){var p={},m=function(A){var x="on"+A.slice(0,1).toUpperCase()+A.slice(1);p[x]=function($){h('event "%s"',x,$),f.trigger(A,$)}},v=!0,g=!1,_=void 0;try{for(var y=a.default[Symbol.iterator](),T;!(v=(T=y.next()).done);v=!0){var b=T.value;m(b)}}catch(w){g=!0,_=w}finally{try{!v&&y.return&&y.return()}finally{if(g)throw _}}return p},d.promisifyPlayer=function(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m={},v=function(x){p&&u.default[x]?m[x]=function(){for(var $=arguments.length,G=Array($),oe=0;oe<$;oe++)G[oe]=arguments[oe];return f.then(function(Re){var ke=u.default[x],Tn=Re.getPlayerState(),li=Re[x].apply(Re,G);return ke.stateChangeRequired||Array.isArray(ke.acceptableStates)&&ke.acceptableStates.indexOf(Tn)===-1?new Promise(function(gr){var Oe=function z(){var Z=Re.getPlayerState(),te=void 0;typeof ke.timeout=="number"&&(te=setTimeout(function(){Re.removeEventListener("onStateChange",z),gr()},ke.timeout)),Array.isArray(ke.acceptableStates)&&ke.acceptableStates.indexOf(Z)!==-1&&(Re.removeEventListener("onStateChange",z),clearTimeout(te),gr())};Re.addEventListener("onStateChange",Oe)}).then(function(){return li}):li})}:m[x]=function(){for(var $=arguments.length,G=Array($),oe=0;oe<$;oe++)G[oe]=arguments[oe];return f.then(function(Re){return Re[x].apply(Re,G)})}},g=!0,_=!1,y=void 0;try{for(var T=s.default[Symbol.iterator](),b;!(g=(b=T.next()).done);g=!0){var w=b.value;v(w)}}catch(A){_=!0,y=A}finally{try{!g&&T.return&&T.return()}finally{if(_)throw y}}return m},e.default=d,t.exports=e.default})(Ew,Ew.exports);var C7=Ew.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},r=h7,i=u(r),s=m7,o=u(s),a=C7,l=u(a);function u(h){return h&&h.__esModule?h:{default:h}}var c=void 0;e.default=function(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,p=(0,i.default)();if(c||(c=(0,o.default)(p)),d.events)throw new Error("Event handlers cannot be overwritten.");if(typeof h=="string"&&!document.getElementById(h))throw new Error('Element "'+h+'" does not exist.');d.events=l.default.proxyEvents(p);var m=new Promise(function(g){if((typeof h>"u"?"undefined":n(h))==="object"&&h.playVideo instanceof Function){var _=h;g(_)}else c.then(function(y){var T=new y.Player(h,d);return p.on("ready",function(){g(T)}),null})}),v=l.default.promisifyPlayer(m,f);return v.on=p.on,v.off=p.off,v},t.exports=e.default})(vw,vw.exports);var P7=vw.exports;const b7=$l(P7);var k7=Object.defineProperty,N7=Object.defineProperties,x7=Object.getOwnPropertyDescriptors,JC=Object.getOwnPropertySymbols,D7=Object.prototype.hasOwnProperty,O7=Object.prototype.propertyIsEnumerable,XC=(t,e,n)=>e in t?k7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pw=(t,e)=>{for(var n in e||(e={}))D7.call(e,n)&&XC(t,n,e[n]);if(JC)for(var n of JC(e))O7.call(e,n)&&XC(t,n,e[n]);return t},bw=(t,e)=>N7(t,x7(e)),L7=(t,e,n)=>new Promise((r,i)=>{var s=l=>{try{a(n.next(l))}catch(u){i(u)}},o=l=>{try{a(n.throw(l))}catch(u){i(u)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,o);a((n=n.apply(t,e)).next())});function M7(t,e){var n,r;if(t.videoId!==e.videoId)return!0;const i=((n=t.opts)==null?void 0:n.playerVars)||{},s=((r=e.opts)==null?void 0:r.playerVars)||{};return i.start!==s.start||i.end!==s.end}function ZC(t={}){return bw(Pw({},t),{height:0,width:0,playerVars:bw(Pw({},t.playerVars),{autoplay:0,start:0,end:0})})}function V7(t,e){return t.videoId!==e.videoId||!c7(ZC(t.opts),ZC(e.opts))}function F7(t,e){var n,r,i,s;return t.id!==e.id||t.className!==e.className||((n=t.opts)==null?void 0:n.width)!==((r=e.opts)==null?void 0:r.width)||((i=t.opts)==null?void 0:i.height)!==((s=e.opts)==null?void 0:s.height)||t.iframeClassName!==e.iframeClassName||t.title!==e.title}var U7={videoId:"",id:"",className:"",iframeClassName:"",style:{},title:"",loading:void 0,opts:{},onReady:()=>{},onError:()=>{},onPlay:()=>{},onPause:()=>{},onEnd:()=>{},onStateChange:()=>{},onPlaybackRateChange:()=>{},onPlaybackQualityChange:()=>{}},B7={videoId:jt.string,id:jt.string,className:jt.string,iframeClassName:jt.string,style:jt.object,title:jt.string,loading:jt.oneOf(["lazy","eager"]),opts:jt.objectOf(jt.any),onReady:jt.func,onError:jt.func,onPlay:jt.func,onPause:jt.func,onEnd:jt.func,onStateChange:jt.func,onPlaybackRateChange:jt.func,onPlaybackQualityChange:jt.func},Uf=class extends j.Component{constructor(t){super(t),this.destroyPlayerPromise=void 0,this.onPlayerReady=e=>{var n,r;return(r=(n=this.props).onReady)==null?void 0:r.call(n,e)},this.onPlayerError=e=>{var n,r;return(r=(n=this.props).onError)==null?void 0:r.call(n,e)},this.onPlayerStateChange=e=>{var n,r,i,s,o,a,l,u;switch((r=(n=this.props).onStateChange)==null||r.call(n,e),e.data){case Uf.PlayerState.ENDED:(s=(i=this.props).onEnd)==null||s.call(i,e);break;case Uf.PlayerState.PLAYING:(a=(o=this.props).onPlay)==null||a.call(o,e);break;case Uf.PlayerState.PAUSED:(u=(l=this.props).onPause)==null||u.call(l,e);break}},this.onPlayerPlaybackRateChange=e=>{var n,r;return(r=(n=this.props).onPlaybackRateChange)==null?void 0:r.call(n,e)},this.onPlayerPlaybackQualityChange=e=>{var n,r;return(r=(n=this.props).onPlaybackQualityChange)==null?void 0:r.call(n,e)},this.destroyPlayer=()=>this.internalPlayer?(this.destroyPlayerPromise=this.internalPlayer.destroy().then(()=>this.destroyPlayerPromise=void 0),this.destroyPlayerPromise):Promise.resolve(),this.createPlayer=()=>{if(typeof document>"u")return;if(this.destroyPlayerPromise){this.destroyPlayerPromise.then(this.createPlayer);return}const e=bw(Pw({},this.props.opts),{videoId:this.props.videoId});this.internalPlayer=b7(this.container,e),this.internalPlayer.on("ready",this.onPlayerReady),this.internalPlayer.on("error",this.onPlayerError),this.internalPlayer.on("stateChange",this.onPlayerStateChange),this.internalPlayer.on("playbackRateChange",this.onPlayerPlaybackRateChange),this.internalPlayer.on("playbackQualityChange",this.onPlayerPlaybackQualityChange),(this.props.title||this.props.loading)&&this.internalPlayer.getIframe().then(n=>{this.props.title&&n.setAttribute("title",this.props.title),this.props.loading&&n.setAttribute("loading",this.props.loading)})},this.resetPlayer=()=>this.destroyPlayer().then(this.createPlayer),this.updatePlayer=()=>{var e;(e=this.internalPlayer)==null||e.getIframe().then(n=>{this.props.id?n.setAttribute("id",this.props.id):n.removeAttribute("id"),this.props.iframeClassName?n.setAttribute("class",this.props.iframeClassName):n.removeAttribute("class"),this.props.opts&&this.props.opts.width?n.setAttribute("width",this.props.opts.width.toString()):n.removeAttribute("width"),this.props.opts&&this.props.opts.height?n.setAttribute("height",this.props.opts.height.toString()):n.removeAttribute("height"),this.props.title?n.setAttribute("title",this.props.title):n.setAttribute("title","YouTube video player"),this.props.loading?n.setAttribute("loading",this.props.loading):n.removeAttribute("loading")})},this.getInternalPlayer=()=>this.internalPlayer,this.updateVideo=()=>{var e,n,r,i;if(typeof this.props.videoId>"u"||this.props.videoId===null){(e=this.internalPlayer)==null||e.stopVideo();return}let s=!1;const o={videoId:this.props.videoId};if((n=this.props.opts)!=null&&n.playerVars&&(s=this.props.opts.playerVars.autoplay===1,"start"in this.props.opts.playerVars&&(o.startSeconds=this.props.opts.playerVars.start),"end"in this.props.opts.playerVars&&(o.endSeconds=this.props.opts.playerVars.end)),s){(r=this.internalPlayer)==null||r.loadVideoById(o);return}(i=this.internalPlayer)==null||i.cueVideoById(o)},this.refContainer=e=>{this.container=e},this.container=null,this.internalPlayer=null}componentDidMount(){this.createPlayer()}componentDidUpdate(t){return L7(this,null,function*(){F7(t,this.props)&&this.updatePlayer(),V7(t,this.props)&&(yield this.resetPlayer()),M7(t,this.props)&&this.updateVideo()})}componentWillUnmount(){this.destroyPlayer()}render(){return j.createElement("div",{className:this.props.className,style:this.props.style},j.createElement("div",{id:this.props.id,className:this.props.iframeClassName,ref:this.refContainer}))}},Fg=Uf;Fg.propTypes=B7;Fg.defaultProps=U7;Fg.PlayerState={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5};var $7=Fg;const z7="https://image.tmdb.org/t/p/original/",Xi=({title:t,fetchURL:e,isLarge:n})=>{const[r,i]=M.useState([]),[s,o]=M.useState("");M.useEffect(()=>{(async()=>{const h=(await Ok.get(e)).data;i(h.results)})()},[e]);const a={height:"390",width:"100%",playerVars:{autoplay:1}},l=u=>{s?o(""):r7(u==null?void 0:u.name).then(c=>{window.alert(c);const h=new URLSearchParams(new URL(c).search);o(h.get("v"))}).catch(c=>{alert(c)})};return j.createElement("div",{className:" pl-10 max-sm:pl-2 bg-black "},j.createElement("div",{className:"text-white text-xl font-bold pb-2 pt-2"},j.createElement("h1",null,t)),j.createElement("div",{className:"flex overflow-y-hidden overflow-x-scroll scrollbar-hide "},r.map(u=>j.createElement("div",{key:u.id,className:"  "},j.createElement("img",{className:`${n?" max-sm:h-[150px]  h-[200px] p-[5px] max-sm:p-[3px] ":" max-sm:h-[70px]  h-[100px] p-[3px]"}
                   text-black  object-contain hover:scale-110 ease-in transition-all`,onClick:()=>{l(u)},key:u.id,src:`${z7}${n?u.poster_path:u.backdrop_path}`,alt:u==null?void 0:u.name})))),s&&j.createElement("div",null,j.createElement($7,{videoId:s,opts:a})))},j7="/assets/accountNav-n-3DzrXv.jpg",q7=()=>{const[t,e]=M.useState(!1),n=()=>{window.scrollY>200?e(!0):e(!1)};return M.useEffect(()=>(window.addEventListener("scroll",n),()=>window.removeEventListener("scroll",n)),[]),j.createElement("section",{className:` fixed w-full  ${t&&"bg-black "}  `},j.createElement("div",{className:"flex justify-between"},j.createElement("img",{className:"h-[50px] p-3",src:aM}),j.createElement("img",{className:"h-[50px] p-3",src:j7})))};function W7(){M.useState(0);const t=P2([{path:"/",element:j.createElement(jQ,null)},{path:"/home",element:j.createElement(j.Fragment,null,j.createElement(q7,null),j.createElement(wB,null),j.createElement(Xi,{title:"NETFLIX ORIGINALS",fetchURL:rn.fetchNetflixOriginals,isLarge:!0}),j.createElement(Xi,{title:"Trending Now",fetchURL:rn.fetchTrending}),j.createElement(Xi,{title:"Top Rated",fetchURL:rn.fetchTopRated}),j.createElement(Xi,{title:"Action Movies",fetchURL:rn.fetchActionMovies}),j.createElement(Xi,{title:"Comedy Movies",fetchURL:rn.fetchComedyMovies}),j.createElement(Xi,{title:"Horror Movies",fetchURL:rn.fetchHorrorMovies}),j.createElement(Xi,{title:"Romance Movies",fetchURL:rn.fetchRomanceMovies}),j.createElement(Xi,{title:"Documentaries",fetchURL:rn.fetchDocumentaries}))}]);return j.createElement("div",null,j.createElement(V2,{router:t}))}ny.createRoot(document.getElementById("root")).render(j.createElement(j.StrictMode,null,j.createElement(W7,null)));
